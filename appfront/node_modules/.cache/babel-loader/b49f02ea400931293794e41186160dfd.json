{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { defineComponent, h, ref, resolveComponent, createCommentVNode, provide, computed, reactive, watch, nextTick, onMounted } from 'vue';\nimport XEUtils from 'xe-utils';\nimport GlobalConfig from '../../v-x-e-table/src/conf';\nimport { VXETable } from '../../v-x-e-table';\nimport { getFuncText, isEnableConf, eqEmptyValue } from '../../tools/utils';\nimport { errLog } from '../../tools/log';\nimport { scrollToView } from '../../tools/dom';\nimport { createItem, handleFieldOrItem } from './util';\nimport { renderTitle } from './render';\nimport { useSize } from '../../hooks/size';\n\nvar Rule =\n/** @class */\nfunction () {\n  function Rule(rule) {\n    Object.assign(this, {\n      $options: rule,\n      required: rule.required,\n      min: rule.min,\n      max: rule.min,\n      type: rule.type,\n      pattern: rule.pattern,\n      validator: rule.validator,\n      trigger: rule.trigger,\n      maxWidth: rule.maxWidth\n    });\n  }\n\n  Object.defineProperty(Rule.prototype, \"content\", {\n    get: function () {\n      return getFuncText(this.$options.content || this.$options.message);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Rule.prototype, \"message\", {\n    get: function () {\n      return this.content;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return Rule;\n}();\n\nvar validErrorRuleValue = function (rule, val) {\n  var type = rule.type,\n      min = rule.min,\n      max = rule.max,\n      pattern = rule.pattern;\n  var isNumType = type === 'number';\n  var numVal = isNumType ? XEUtils.toNumber(val) : XEUtils.getSize(val); // 判断数值\n\n  if (isNumType && isNaN(val)) {\n    return true;\n  } // 如果存在 min，判断最小值\n\n\n  if (!XEUtils.eqNull(min) && numVal < XEUtils.toNumber(min)) {\n    return true;\n  } // 如果存在 max，判断最大值\n\n\n  if (!XEUtils.eqNull(max) && numVal > XEUtils.toNumber(max)) {\n    return true;\n  } // 如果存在 pattern，正则校验\n\n\n  if (pattern && !(XEUtils.isRegExp(pattern) ? pattern : new RegExp(pattern)).test(val)) {\n    return true;\n  }\n\n  return false;\n};\n\nfunction getResetValue(value, resetValue) {\n  if (XEUtils.isArray(value)) {\n    resetValue = [];\n  }\n\n  return resetValue;\n}\n\nexport default defineComponent({\n  name: 'VxeForm',\n  props: {\n    collapseStatus: {\n      type: Boolean,\n      default: true\n    },\n    loading: Boolean,\n    data: Object,\n    size: {\n      type: String,\n      default: function () {\n        return GlobalConfig.form.size || GlobalConfig.size;\n      }\n    },\n    span: {\n      type: [String, Number],\n      default: function () {\n        return GlobalConfig.form.span;\n      }\n    },\n    align: {\n      type: String,\n      default: function () {\n        return GlobalConfig.form.align;\n      }\n    },\n    titleAlign: {\n      type: String,\n      default: function () {\n        return GlobalConfig.form.titleAlign;\n      }\n    },\n    titleWidth: {\n      type: [String, Number],\n      default: function () {\n        return GlobalConfig.form.titleWidth;\n      }\n    },\n    titleColon: {\n      type: Boolean,\n      default: function () {\n        return GlobalConfig.form.titleColon;\n      }\n    },\n    titleAsterisk: {\n      type: Boolean,\n      default: function () {\n        return GlobalConfig.form.titleAsterisk;\n      }\n    },\n    titleOverflow: {\n      type: [Boolean, String],\n      default: null\n    },\n    className: [String, Function],\n    items: Array,\n    rules: Object,\n    preventSubmit: {\n      type: Boolean,\n      default: function () {\n        return GlobalConfig.form.preventSubmit;\n      }\n    },\n    validConfig: Object,\n    tooltipConfig: Object,\n    customLayout: {\n      type: Boolean,\n      default: function () {\n        return GlobalConfig.form.customLayout;\n      }\n    }\n  },\n  emits: ['update:collapseStatus', 'collapse', 'toggle-collapse', 'submit', 'submit-invalid', 'reset'],\n  setup: function (props, context) {\n    var hasUseTooltip = VXETable.tooltip;\n    var slots = context.slots,\n        emit = context.emit;\n    var xID = XEUtils.uniqueId();\n    var computeSize = useSize(props);\n    var reactData = reactive({\n      collapseAll: props.collapseStatus,\n      staticItems: [],\n      formItems: []\n    });\n    var internalData = reactive({\n      tooltipTimeout: null,\n      tooltipStore: {\n        item: null,\n        visible: false\n      }\n    });\n    var refElem = ref();\n    var refTooltip = ref();\n    var formMethods = {};\n    var computeValidOpts = computed(function () {\n      return Object.assign({}, GlobalConfig.form.validConfig, props.validConfig);\n    });\n    var computeTooltipOpts = computed(function () {\n      return Object.assign({}, GlobalConfig.tooltip, GlobalConfig.form.tooltipConfig, props.tooltipConfig);\n    });\n    var refMaps = {\n      refElem: refElem\n    };\n    var computeMaps = {\n      computeSize: computeSize,\n      computeValidOpts: computeValidOpts,\n      computeTooltipOpts: computeTooltipOpts\n    };\n    var $xeform = {\n      xID: xID,\n      props: props,\n      context: context,\n      reactData: reactData,\n      getRefMaps: function () {\n        return refMaps;\n      },\n      getComputeMaps: function () {\n        return computeMaps;\n      }\n    };\n\n    var callSlot = function (slotFunc, params) {\n      if (slotFunc) {\n        if (XEUtils.isString(slotFunc)) {\n          slotFunc = slots[slotFunc] || null;\n        }\n\n        if (XEUtils.isFunction(slotFunc)) {\n          return slotFunc(params);\n        }\n      }\n\n      return [];\n    };\n\n    var loadItem = function (list) {\n      if (list.length) {\n        if (process.env.NODE_ENV === 'development') {\n          list.forEach(function (item) {\n            if (item.slots) {\n              XEUtils.each(item.slots, function (func) {\n                if (!XEUtils.isFunction(func)) {\n                  if (!slots[func]) {\n                    errLog('vxe.error.notSlot', [func]);\n                  }\n                }\n              });\n            }\n          });\n        }\n\n        reactData.staticItems = XEUtils.mapTree(list, function (item) {\n          return createItem($xeform, item);\n        }, {\n          children: 'children'\n        });\n      }\n\n      return nextTick();\n    };\n\n    var getItems = function () {\n      var itemList = [];\n      XEUtils.eachTree(reactData.formItems, function (item) {\n        itemList.push(item);\n      }, {\n        children: 'children'\n      });\n      return itemList;\n    };\n\n    var getItemByField = function (field) {\n      var rest = XEUtils.findTree(reactData.formItems, function (item) {\n        return item.field === field;\n      }, {\n        children: 'children'\n      });\n      return rest ? rest.item : null;\n    };\n\n    var getCollapseStatus = function () {\n      return reactData.collapseAll;\n    };\n\n    var toggleCollapse = function () {\n      var status = !getCollapseStatus();\n      reactData.collapseAll = status;\n      emit('update:collapseStatus', status);\n      return nextTick();\n    };\n\n    var toggleCollapseEvent = function (evnt) {\n      toggleCollapse();\n      var status = getCollapseStatus();\n      formMethods.dispatchEvent('toggle-collapse', {\n        status: status,\n        collapse: status,\n        data: props.data\n      }, evnt);\n      formMethods.dispatchEvent('collapse', {\n        status: status,\n        collapse: status,\n        data: props.data\n      }, evnt);\n    };\n\n    var clearValidate = function (fieldOrItem) {\n      if (fieldOrItem) {\n        var item = handleFieldOrItem($xeform, fieldOrItem);\n\n        if (item) {\n          item.showError = false;\n        }\n      } else {\n        getItems().forEach(function (item) {\n          item.showError = false;\n        });\n      }\n\n      return nextTick();\n    };\n\n    var reset = function () {\n      var data = props.data;\n      var itemList = getItems();\n\n      if (data) {\n        itemList.forEach(function (item) {\n          var field = item.field,\n              resetValue = item.resetValue,\n              itemRender = item.itemRender;\n\n          if (isEnableConf(itemRender)) {\n            var compConf = VXETable.renderer.get(itemRender.name);\n\n            if (compConf && compConf.itemResetMethod) {\n              compConf.itemResetMethod({\n                data: data,\n                field: field,\n                property: field,\n                item: item,\n                $form: $xeform\n              });\n            } else if (field) {\n              XEUtils.set(data, field, resetValue === null ? getResetValue(XEUtils.get(data, field), undefined) : resetValue);\n            }\n          }\n        });\n      }\n\n      return clearValidate();\n    };\n\n    var resetEvent = function (evnt) {\n      evnt.preventDefault();\n      reset();\n      formMethods.dispatchEvent('reset', {\n        data: props.data\n      }, evnt);\n    };\n\n    var handleFocus = function (fields) {\n      var el = refElem.value;\n      fields.some(function (property, index) {\n        var item = getItemByField(property);\n\n        if (item && isEnableConf(item.itemRender)) {\n          var itemRender = item.itemRender;\n          var compConf = VXETable.renderer.get(itemRender.name);\n          var inputElem = null; // 定位到第一个\n\n          if (!index) {\n            scrollToView(el.querySelector(\".\" + item.id));\n          } // 如果指定了聚焦 class\n\n\n          if (itemRender.autofocus) {\n            inputElem = el.querySelector(\".\" + item.id + \" \" + itemRender.autofocus);\n          } // 渲染器的聚焦处理\n\n\n          if (!inputElem && compConf && compConf.autofocus) {\n            inputElem = el.querySelector(\".\" + item.id + \" \" + compConf.autofocus);\n          }\n\n          if (inputElem) {\n            inputElem.focus();\n            return true;\n          }\n        }\n      });\n    };\n    /**\n     * 校验数据\n     * 按表格行、列顺序依次校验（同步或异步）\n     * 校验规则根据索引顺序依次校验，如果是异步则会等待校验完成才会继续校验下一列\n     * 如果校验失败则，触发回调或者 Promise<(ErrMap 校验不通过列的信息)>\n     * 如果是传回调方式这返回一个 (ErrMap 校验不通过列的信息)\n     *\n     * rule 配置：\n     *  required=Boolean 是否必填\n     *  min=Number 最小长度\n     *  max=Number 最大长度\n     *  validator=Function({ itemValue, rule, rules, data, property }) 自定义校验，接收一个 Promise\n     *  trigger=change 触发方式\n     */\n\n\n    var validItemRules = function (validType, property, val) {\n      var data = props.data,\n          formRules = props.rules;\n      var errorRules = [];\n      var syncVailds = [];\n\n      if (property && formRules) {\n        var rules_1 = XEUtils.get(formRules, property);\n\n        if (rules_1) {\n          var itemValue_1 = XEUtils.isUndefined(val) ? XEUtils.get(data, property) : val;\n          rules_1.forEach(function (rule) {\n            var type = rule.type,\n                trigger = rule.trigger,\n                required = rule.required;\n\n            if (validType === 'all' || !trigger || validType === trigger) {\n              if (XEUtils.isFunction(rule.validator)) {\n                var customValid = rule.validator({\n                  itemValue: itemValue_1,\n                  rule: rule,\n                  rules: rules_1,\n                  data: data,\n                  field: property,\n                  property: property,\n                  $form: $xeform\n                });\n\n                if (customValid) {\n                  if (XEUtils.isError(customValid)) {\n                    errorRules.push(new Rule({\n                      type: 'custom',\n                      trigger: trigger,\n                      content: customValid.message,\n                      rule: new Rule(rule)\n                    }));\n                  } else if (customValid.catch) {\n                    // 如果为异步校验（注：异步校验是并发无序的）\n                    syncVailds.push(customValid.catch(function (e) {\n                      errorRules.push(new Rule({\n                        type: 'custom',\n                        trigger: trigger,\n                        content: e ? e.message : rule.content || rule.message,\n                        rule: new Rule(rule)\n                      }));\n                    }));\n                  }\n                }\n              } else {\n                var isArrType = type === 'array';\n                var hasEmpty = isArrType ? !XEUtils.isArray(itemValue_1) || !itemValue_1.length : eqEmptyValue(itemValue_1);\n\n                if (required ? hasEmpty || validErrorRuleValue(rule, itemValue_1) : !hasEmpty && validErrorRuleValue(rule, itemValue_1)) {\n                  errorRules.push(new Rule(rule));\n                }\n              }\n            }\n          });\n        }\n      }\n\n      return Promise.all(syncVailds).then(function () {\n        if (errorRules.length) {\n          var rest = {\n            rules: errorRules,\n            rule: errorRules[0]\n          };\n          return Promise.reject(rest);\n        }\n      });\n    };\n\n    var showErrTime;\n\n    var beginValidate = function (itemList, type, callback) {\n      var data = props.data,\n          formRules = props.rules;\n      var validOpts = computeValidOpts.value;\n      var validRest = {};\n      var validFields = [];\n      var itemValids = [];\n      clearTimeout(showErrTime);\n\n      if (data && formRules) {\n        itemList.forEach(function (item) {\n          var field = item.field;\n\n          if (field) {\n            itemValids.push(validItemRules(type || 'all', field).then(function () {\n              item.errRule = null;\n            }).catch(function (_a) {\n              var rule = _a.rule,\n                  rules = _a.rules;\n              var rest = {\n                rule: rule,\n                rules: rules,\n                data: data,\n                field: field,\n                property: field,\n                $form: $xeform\n              };\n\n              if (!validRest[field]) {\n                validRest[field] = [];\n              }\n\n              validRest[field].push(rest);\n              validFields.push(field);\n              item.errRule = rule;\n              return Promise.reject(rest);\n            }));\n          }\n        });\n        return Promise.all(itemValids).then(function () {\n          if (callback) {\n            callback();\n          }\n        }).catch(function () {\n          return new Promise(function (resolve) {\n            showErrTime = window.setTimeout(function () {\n              itemList.forEach(function (item) {\n                if (item.errRule) {\n                  item.showError = true;\n                }\n              });\n            }, 20);\n\n            if (validOpts.autoPos !== false) {\n              nextTick(function () {\n                handleFocus(validFields);\n              });\n            }\n\n            if (callback) {\n              callback(validRest);\n              resolve();\n            } else {\n              resolve(validRest);\n            }\n          });\n        });\n      }\n\n      if (callback) {\n        callback();\n      }\n\n      return Promise.resolve();\n    };\n\n    var validate = function (callback) {\n      clearValidate();\n      return beginValidate(getItems(), '', callback);\n    };\n\n    var validateField = function (fieldOrItem, callback) {\n      var item = handleFieldOrItem($xeform, fieldOrItem);\n      return beginValidate(item ? [item] : [], '', callback);\n    };\n\n    var submitEvent = function (evnt) {\n      evnt.preventDefault();\n\n      if (!props.preventSubmit) {\n        clearValidate();\n        beginValidate(getItems()).then(function () {\n          formMethods.dispatchEvent('submit', {\n            data: props.data\n          }, evnt);\n        }).catch(function (errMap) {\n          formMethods.dispatchEvent('submit-invalid', {\n            data: props.data,\n            errMap: errMap\n          }, evnt);\n        });\n      }\n    };\n\n    var closeTooltip = function () {\n      var tooltipStore = internalData.tooltipStore;\n      var $tooltip = refTooltip.value;\n\n      if (tooltipStore.visible) {\n        Object.assign(tooltipStore, {\n          item: null,\n          visible: false\n        });\n\n        if ($tooltip) {\n          $tooltip.close();\n        }\n      }\n\n      return nextTick();\n    };\n\n    var triggerTitleTipEvent = function (evnt, params) {\n      var item = params.item;\n      var tooltipStore = internalData.tooltipStore;\n      var $tooltip = refTooltip.value;\n      var overflowElem = evnt.currentTarget.children[0];\n      var content = (overflowElem.textContent || '').trim();\n      var isCellOverflow = overflowElem.scrollWidth > overflowElem.clientWidth;\n      clearTimeout(internalData.tooltipTimeout);\n\n      if (tooltipStore.item !== item) {\n        closeTooltip();\n      }\n\n      if (content && isCellOverflow) {\n        Object.assign(tooltipStore, {\n          item: item,\n          visible: true\n        });\n\n        if ($tooltip) {\n          $tooltip.open(overflowElem, content);\n        }\n      }\n    };\n\n    var handleTitleTipLeaveEvent = function () {\n      var tooltipOpts = computeTooltipOpts.value;\n      var $tooltip = refTooltip.value;\n\n      if ($tooltip) {\n        $tooltip.setActived(false);\n      }\n\n      if (tooltipOpts.enterable) {\n        internalData.tooltipTimeout = setTimeout(function () {\n          $tooltip = refTooltip.value;\n\n          if ($tooltip && !$tooltip.isActived()) {\n            closeTooltip();\n          }\n        }, tooltipOpts.leaveDelay);\n      } else {\n        closeTooltip();\n      }\n    };\n    /**\n     * 更新项状态\n     * 如果组件值 v-model 发生 change 时，调用改函数用于更新某一项编辑状态\n     * 如果单元格配置了校验规则，则会进行校验\n     */\n\n\n    var updateStatus = function (scope, itemValue) {\n      var property = scope.property;\n\n      if (property) {\n        validItemRules('change', property, itemValue).then(function () {\n          clearValidate(property);\n        }).catch(function (_a) {\n          var rule = _a.rule;\n          var item = getItemByField(property);\n\n          if (item) {\n            item.showError = true;\n            item.errRule = rule;\n          }\n        });\n      }\n    };\n\n    var renderItems = function (itemList) {\n      var data = props.data,\n          rules = props.rules,\n          allTitleOverflow = props.titleOverflow;\n      var collapseAll = reactData.collapseAll;\n      var validOpts = computeValidOpts.value;\n      return itemList.map(function (item) {\n        var slots = item.slots,\n            title = item.title,\n            visible = item.visible,\n            folding = item.folding,\n            visibleMethod = item.visibleMethod,\n            field = item.field,\n            collapseNode = item.collapseNode,\n            itemRender = item.itemRender,\n            showError = item.showError,\n            errRule = item.errRule,\n            className = item.className,\n            titleOverflow = item.titleOverflow,\n            children = item.children;\n        var compConf = isEnableConf(itemRender) ? VXETable.renderer.get(itemRender.name) : null;\n        var defaultSlot = slots ? slots.default : null;\n        var titleSlot = slots ? slots.title : null;\n        var span = item.span || props.span;\n        var align = item.align || props.align;\n        var titleAlign = item.titleAlign || props.titleAlign;\n        var titleWidth = item.titleWidth || props.titleWidth;\n        var itemOverflow = XEUtils.isUndefined(titleOverflow) || XEUtils.isNull(titleOverflow) ? allTitleOverflow : titleOverflow;\n        var showEllipsis = itemOverflow === 'ellipsis';\n        var showTitle = itemOverflow === 'title';\n        var showTooltip = itemOverflow === true || itemOverflow === 'tooltip';\n        var hasEllipsis = showTitle || showTooltip || showEllipsis;\n        var itemVisibleMethod = visibleMethod;\n        var params = {\n          data: data,\n          field: field,\n          property: field,\n          item: item,\n          $form: $xeform\n        };\n\n        if (visible === false) {\n          return createCommentVNode();\n        }\n\n        var isRequired = false;\n\n        if (rules) {\n          var itemRules = rules[field];\n\n          if (itemRules) {\n            isRequired = itemRules.some(function (rule) {\n              return rule.required;\n            });\n          }\n        } // 如果为项集合\n\n\n        var isGather = children && children.length > 0;\n\n        if (isGather) {\n          var childVNs = renderItems(item.children);\n          return childVNs.length ? h('div', {\n            class: ['vxe-form--gather vxe-row', item.id, span ? \"vxe-col--\" + span + \" is--span\" : '', className ? XEUtils.isFunction(className) ? className(params) : className : '']\n          }, childVNs) : createCommentVNode();\n        }\n\n        if (!itemVisibleMethod && compConf && compConf.itemVisibleMethod) {\n          itemVisibleMethod = compConf.itemVisibleMethod;\n        }\n\n        var contentVNs = [];\n\n        if (defaultSlot) {\n          contentVNs = callSlot(defaultSlot, params);\n        } else if (compConf && compConf.renderItemContent) {\n          contentVNs = compConf.renderItemContent(itemRender, params);\n        } else if (field) {\n          contentVNs = [\"\" + XEUtils.get(data, field)];\n        }\n\n        if (collapseNode) {\n          contentVNs.push(h('div', {\n            class: 'vxe-form--item-trigger-node',\n            onClick: toggleCollapseEvent\n          }, [h('span', {\n            class: 'vxe-form--item-trigger-text'\n          }, collapseAll ? GlobalConfig.i18n('vxe.form.unfolding') : GlobalConfig.i18n('vxe.form.folding')), h('i', {\n            class: ['vxe-form--item-trigger-icon', collapseAll ? GlobalConfig.icon.FORM_FOLDING : GlobalConfig.icon.FORM_UNFOLDING]\n          })]));\n        }\n\n        if (errRule && validOpts.showMessage) {\n          contentVNs.push(h('div', {\n            class: 'vxe-form--item-valid',\n            style: errRule.maxWidth ? {\n              width: errRule.maxWidth + \"px\"\n            } : null\n          }, errRule.content));\n        }\n\n        var ons = showTooltip ? {\n          onMouseenter: function (evnt) {\n            triggerTitleTipEvent(evnt, params);\n          },\n          onMouseleave: handleTitleTipLeaveEvent\n        } : {};\n        return h('div', {\n          class: ['vxe-form--item', item.id, span ? \"vxe-col--\" + span + \" is--span\" : '', className ? XEUtils.isFunction(className) ? className(params) : className : '', {\n            'is--title': title,\n            'is--required': isRequired,\n            'is--hidden': folding && collapseAll,\n            'is--active': !itemVisibleMethod || itemVisibleMethod(params),\n            'is--error': showError\n          }],\n          key: item.id\n        }, [h('div', {\n          class: 'vxe-form--item-inner'\n        }, [title || titleSlot ? h('div', __assign({\n          class: ['vxe-form--item-title', titleAlign ? \"align--\" + titleAlign : null, {\n            'is--ellipsis': hasEllipsis\n          }],\n          style: titleWidth ? {\n            width: isNaN(titleWidth) ? titleWidth : titleWidth + \"px\"\n          } : null,\n          title: showTitle ? getFuncText(title) : null\n        }, ons), renderTitle($xeform, item)) : null, h('div', {\n          class: ['vxe-form--item-content', align ? \"align--\" + align : null]\n        }, contentVNs)])]);\n      });\n    };\n\n    formMethods = {\n      dispatchEvent: function (type, params, evnt) {\n        emit(type, Object.assign({\n          $form: $xeform,\n          $event: evnt\n        }, params));\n      },\n      reset: reset,\n      validate: validate,\n      validateField: validateField,\n      clearValidate: clearValidate,\n      updateStatus: updateStatus,\n      toggleCollapse: toggleCollapse,\n      getItems: getItems,\n      getItemByField: getItemByField,\n      closeTooltip: closeTooltip\n    };\n    var formPrivateMethods = {\n      callSlot: callSlot,\n      toggleCollapseEvent: toggleCollapseEvent,\n      triggerTitleTipEvent: triggerTitleTipEvent,\n      handleTitleTipLeaveEvent: handleTitleTipLeaveEvent\n    };\n    Object.assign($xeform, formMethods, formPrivateMethods);\n    watch(function () {\n      return reactData.staticItems;\n    }, function (value) {\n      reactData.formItems = value;\n    });\n    watch(function () {\n      return props.items;\n    }, function (value) {\n      loadItem(value || []);\n    });\n    watch(function () {\n      return props.collapseStatus;\n    }, function (value) {\n      reactData.collapseAll = !!value;\n    });\n    onMounted(function () {\n      nextTick(function () {\n        if (process.env.NODE_ENV === 'development') {\n          if (props.customLayout && props.items) {\n            errLog('vxe.error.errConflicts', ['custom-layout', 'items']);\n          }\n        }\n\n        loadItem(props.items || []);\n      });\n    });\n\n    var renderVN = function () {\n      var _a;\n\n      var loading = props.loading,\n          className = props.className,\n          data = props.data,\n          titleColon = props.titleColon,\n          titleAsterisk = props.titleAsterisk,\n          customLayout = props.customLayout;\n      var formItems = reactData.formItems; // const formItems: any[] = []\n\n      var vSize = computeSize.value;\n      var tooltipOpts = computeTooltipOpts.value;\n      var defaultSlot = slots.default;\n      return h('form', {\n        ref: refElem,\n        class: ['vxe-form', className ? XEUtils.isFunction(className) ? className({\n          items: formItems,\n          data: data,\n          $form: $xeform\n        }) : className : '', (_a = {}, _a[\"size--\" + vSize] = vSize, _a['is--colon'] = titleColon, _a['is--asterisk'] = titleAsterisk, _a['is--loading'] = loading, _a)],\n        onSubmit: submitEvent,\n        onReset: resetEvent\n      }, [h('div', {\n        class: 'vxe-form--wrapper vxe-row'\n      }, customLayout ? defaultSlot ? defaultSlot({}) : [] : renderItems(formItems)), h('div', {\n        class: 'vxe-form-slots',\n        ref: 'hideItem'\n      }, customLayout ? [] : defaultSlot ? defaultSlot({}) : []), h('div', {\n        class: ['vxe-loading', {\n          'is--visible': loading\n        }]\n      }, [h('div', {\n        class: 'vxe-loading--spinner'\n      })]),\n      /**\n       * 工具提示\n       */\n      hasUseTooltip ? h(resolveComponent('vxe-tooltip'), __assign({\n        ref: refTooltip\n      }, tooltipOpts)) : createCommentVNode()]);\n    };\n\n    $xeform.renderVN = renderVN;\n    provide('$xeform', $xeform);\n    return $xeform;\n  },\n  render: function () {\n    return this.renderVN();\n  }\n});","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/vxe-table/es/form/src/form.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defineComponent","h","ref","resolveComponent","createCommentVNode","provide","computed","reactive","watch","nextTick","onMounted","XEUtils","GlobalConfig","VXETable","getFuncText","isEnableConf","eqEmptyValue","errLog","scrollToView","createItem","handleFieldOrItem","renderTitle","useSize","Rule","rule","$options","required","min","max","type","pattern","validator","trigger","maxWidth","defineProperty","get","content","message","enumerable","configurable","validErrorRuleValue","val","isNumType","numVal","toNumber","getSize","isNaN","eqNull","isRegExp","RegExp","test","getResetValue","value","resetValue","isArray","name","props","collapseStatus","Boolean","default","loading","data","size","String","form","span","Number","align","titleAlign","titleWidth","titleColon","titleAsterisk","titleOverflow","className","Function","items","Array","rules","preventSubmit","validConfig","tooltipConfig","customLayout","emits","setup","context","hasUseTooltip","tooltip","slots","emit","xID","uniqueId","computeSize","reactData","collapseAll","staticItems","formItems","internalData","tooltipTimeout","tooltipStore","item","visible","refElem","refTooltip","formMethods","computeValidOpts","computeTooltipOpts","refMaps","computeMaps","$xeform","getRefMaps","getComputeMaps","callSlot","slotFunc","params","isString","isFunction","loadItem","list","process","env","NODE_ENV","forEach","each","func","mapTree","children","getItems","itemList","eachTree","push","getItemByField","field","rest","findTree","getCollapseStatus","toggleCollapse","status","toggleCollapseEvent","evnt","dispatchEvent","collapse","clearValidate","fieldOrItem","showError","reset","itemRender","compConf","renderer","itemResetMethod","property","$form","set","undefined","resetEvent","preventDefault","handleFocus","fields","el","some","index","inputElem","querySelector","id","autofocus","focus","validItemRules","validType","formRules","errorRules","syncVailds","rules_1","itemValue_1","isUndefined","customValid","itemValue","isError","catch","e","isArrType","hasEmpty","Promise","all","then","reject","showErrTime","beginValidate","callback","validOpts","validRest","validFields","itemValids","clearTimeout","errRule","_a","resolve","window","setTimeout","autoPos","validate","validateField","submitEvent","errMap","closeTooltip","$tooltip","close","triggerTitleTipEvent","overflowElem","currentTarget","textContent","trim","isCellOverflow","scrollWidth","clientWidth","open","handleTitleTipLeaveEvent","tooltipOpts","setActived","enterable","isActived","leaveDelay","updateStatus","scope","renderItems","allTitleOverflow","map","title","folding","visibleMethod","collapseNode","defaultSlot","titleSlot","itemOverflow","isNull","showEllipsis","showTitle","showTooltip","hasEllipsis","itemVisibleMethod","isRequired","itemRules","isGather","childVNs","class","contentVNs","renderItemContent","onClick","i18n","icon","FORM_FOLDING","FORM_UNFOLDING","showMessage","style","width","ons","onMouseenter","onMouseleave","key","$event","formPrivateMethods","renderVN","vSize","onSubmit","onReset","render"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { defineComponent, h, ref, resolveComponent, createCommentVNode, provide, computed, reactive, watch, nextTick, onMounted } from 'vue';\nimport XEUtils from 'xe-utils';\nimport GlobalConfig from '../../v-x-e-table/src/conf';\nimport { VXETable } from '../../v-x-e-table';\nimport { getFuncText, isEnableConf, eqEmptyValue } from '../../tools/utils';\nimport { errLog } from '../../tools/log';\nimport { scrollToView } from '../../tools/dom';\nimport { createItem, handleFieldOrItem } from './util';\nimport { renderTitle } from './render';\nimport { useSize } from '../../hooks/size';\nvar Rule = /** @class */ (function () {\n    function Rule(rule) {\n        Object.assign(this, {\n            $options: rule,\n            required: rule.required,\n            min: rule.min,\n            max: rule.min,\n            type: rule.type,\n            pattern: rule.pattern,\n            validator: rule.validator,\n            trigger: rule.trigger,\n            maxWidth: rule.maxWidth\n        });\n    }\n    Object.defineProperty(Rule.prototype, \"content\", {\n        get: function () {\n            return getFuncText(this.$options.content || this.$options.message);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Rule.prototype, \"message\", {\n        get: function () {\n            return this.content;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return Rule;\n}());\nvar validErrorRuleValue = function (rule, val) {\n    var type = rule.type, min = rule.min, max = rule.max, pattern = rule.pattern;\n    var isNumType = type === 'number';\n    var numVal = isNumType ? XEUtils.toNumber(val) : XEUtils.getSize(val);\n    // 判断数值\n    if (isNumType && isNaN(val)) {\n        return true;\n    }\n    // 如果存在 min，判断最小值\n    if (!XEUtils.eqNull(min) && numVal < XEUtils.toNumber(min)) {\n        return true;\n    }\n    // 如果存在 max，判断最大值\n    if (!XEUtils.eqNull(max) && numVal > XEUtils.toNumber(max)) {\n        return true;\n    }\n    // 如果存在 pattern，正则校验\n    if (pattern && !(XEUtils.isRegExp(pattern) ? pattern : new RegExp(pattern)).test(val)) {\n        return true;\n    }\n    return false;\n};\nfunction getResetValue(value, resetValue) {\n    if (XEUtils.isArray(value)) {\n        resetValue = [];\n    }\n    return resetValue;\n}\nexport default defineComponent({\n    name: 'VxeForm',\n    props: {\n        collapseStatus: { type: Boolean, default: true },\n        loading: Boolean,\n        data: Object,\n        size: { type: String, default: function () { return GlobalConfig.form.size || GlobalConfig.size; } },\n        span: { type: [String, Number], default: function () { return GlobalConfig.form.span; } },\n        align: { type: String, default: function () { return GlobalConfig.form.align; } },\n        titleAlign: { type: String, default: function () { return GlobalConfig.form.titleAlign; } },\n        titleWidth: { type: [String, Number], default: function () { return GlobalConfig.form.titleWidth; } },\n        titleColon: { type: Boolean, default: function () { return GlobalConfig.form.titleColon; } },\n        titleAsterisk: { type: Boolean, default: function () { return GlobalConfig.form.titleAsterisk; } },\n        titleOverflow: { type: [Boolean, String], default: null },\n        className: [String, Function],\n        items: Array,\n        rules: Object,\n        preventSubmit: { type: Boolean, default: function () { return GlobalConfig.form.preventSubmit; } },\n        validConfig: Object,\n        tooltipConfig: Object,\n        customLayout: { type: Boolean, default: function () { return GlobalConfig.form.customLayout; } }\n    },\n    emits: [\n        'update:collapseStatus',\n        'collapse',\n        'toggle-collapse',\n        'submit',\n        'submit-invalid',\n        'reset'\n    ],\n    setup: function (props, context) {\n        var hasUseTooltip = VXETable.tooltip;\n        var slots = context.slots, emit = context.emit;\n        var xID = XEUtils.uniqueId();\n        var computeSize = useSize(props);\n        var reactData = reactive({\n            collapseAll: props.collapseStatus,\n            staticItems: [],\n            formItems: []\n        });\n        var internalData = reactive({\n            tooltipTimeout: null,\n            tooltipStore: {\n                item: null,\n                visible: false\n            }\n        });\n        var refElem = ref();\n        var refTooltip = ref();\n        var formMethods = {};\n        var computeValidOpts = computed(function () {\n            return Object.assign({}, GlobalConfig.form.validConfig, props.validConfig);\n        });\n        var computeTooltipOpts = computed(function () {\n            return Object.assign({}, GlobalConfig.tooltip, GlobalConfig.form.tooltipConfig, props.tooltipConfig);\n        });\n        var refMaps = {\n            refElem: refElem\n        };\n        var computeMaps = {\n            computeSize: computeSize,\n            computeValidOpts: computeValidOpts,\n            computeTooltipOpts: computeTooltipOpts\n        };\n        var $xeform = {\n            xID: xID,\n            props: props,\n            context: context,\n            reactData: reactData,\n            getRefMaps: function () { return refMaps; },\n            getComputeMaps: function () { return computeMaps; }\n        };\n        var callSlot = function (slotFunc, params) {\n            if (slotFunc) {\n                if (XEUtils.isString(slotFunc)) {\n                    slotFunc = slots[slotFunc] || null;\n                }\n                if (XEUtils.isFunction(slotFunc)) {\n                    return slotFunc(params);\n                }\n            }\n            return [];\n        };\n        var loadItem = function (list) {\n            if (list.length) {\n                if (process.env.NODE_ENV === 'development') {\n                    list.forEach(function (item) {\n                        if (item.slots) {\n                            XEUtils.each(item.slots, function (func) {\n                                if (!XEUtils.isFunction(func)) {\n                                    if (!slots[func]) {\n                                        errLog('vxe.error.notSlot', [func]);\n                                    }\n                                }\n                            });\n                        }\n                    });\n                }\n                reactData.staticItems = XEUtils.mapTree(list, function (item) { return createItem($xeform, item); }, { children: 'children' });\n            }\n            return nextTick();\n        };\n        var getItems = function () {\n            var itemList = [];\n            XEUtils.eachTree(reactData.formItems, function (item) {\n                itemList.push(item);\n            }, { children: 'children' });\n            return itemList;\n        };\n        var getItemByField = function (field) {\n            var rest = XEUtils.findTree(reactData.formItems, function (item) { return item.field === field; }, { children: 'children' });\n            return rest ? rest.item : null;\n        };\n        var getCollapseStatus = function () {\n            return reactData.collapseAll;\n        };\n        var toggleCollapse = function () {\n            var status = !getCollapseStatus();\n            reactData.collapseAll = status;\n            emit('update:collapseStatus', status);\n            return nextTick();\n        };\n        var toggleCollapseEvent = function (evnt) {\n            toggleCollapse();\n            var status = getCollapseStatus();\n            formMethods.dispatchEvent('toggle-collapse', { status: status, collapse: status, data: props.data }, evnt);\n            formMethods.dispatchEvent('collapse', { status: status, collapse: status, data: props.data }, evnt);\n        };\n        var clearValidate = function (fieldOrItem) {\n            if (fieldOrItem) {\n                var item = handleFieldOrItem($xeform, fieldOrItem);\n                if (item) {\n                    item.showError = false;\n                }\n            }\n            else {\n                getItems().forEach(function (item) {\n                    item.showError = false;\n                });\n            }\n            return nextTick();\n        };\n        var reset = function () {\n            var data = props.data;\n            var itemList = getItems();\n            if (data) {\n                itemList.forEach(function (item) {\n                    var field = item.field, resetValue = item.resetValue, itemRender = item.itemRender;\n                    if (isEnableConf(itemRender)) {\n                        var compConf = VXETable.renderer.get(itemRender.name);\n                        if (compConf && compConf.itemResetMethod) {\n                            compConf.itemResetMethod({ data: data, field: field, property: field, item: item, $form: $xeform });\n                        }\n                        else if (field) {\n                            XEUtils.set(data, field, resetValue === null ? getResetValue(XEUtils.get(data, field), undefined) : resetValue);\n                        }\n                    }\n                });\n            }\n            return clearValidate();\n        };\n        var resetEvent = function (evnt) {\n            evnt.preventDefault();\n            reset();\n            formMethods.dispatchEvent('reset', { data: props.data }, evnt);\n        };\n        var handleFocus = function (fields) {\n            var el = refElem.value;\n            fields.some(function (property, index) {\n                var item = getItemByField(property);\n                if (item && isEnableConf(item.itemRender)) {\n                    var itemRender = item.itemRender;\n                    var compConf = VXETable.renderer.get(itemRender.name);\n                    var inputElem = null;\n                    // 定位到第一个\n                    if (!index) {\n                        scrollToView(el.querySelector(\".\" + item.id));\n                    }\n                    // 如果指定了聚焦 class\n                    if (itemRender.autofocus) {\n                        inputElem = el.querySelector(\".\" + item.id + \" \" + itemRender.autofocus);\n                    }\n                    // 渲染器的聚焦处理\n                    if (!inputElem && compConf && compConf.autofocus) {\n                        inputElem = el.querySelector(\".\" + item.id + \" \" + compConf.autofocus);\n                    }\n                    if (inputElem) {\n                        inputElem.focus();\n                        return true;\n                    }\n                }\n            });\n        };\n        /**\n         * 校验数据\n         * 按表格行、列顺序依次校验（同步或异步）\n         * 校验规则根据索引顺序依次校验，如果是异步则会等待校验完成才会继续校验下一列\n         * 如果校验失败则，触发回调或者 Promise<(ErrMap 校验不通过列的信息)>\n         * 如果是传回调方式这返回一个 (ErrMap 校验不通过列的信息)\n         *\n         * rule 配置：\n         *  required=Boolean 是否必填\n         *  min=Number 最小长度\n         *  max=Number 最大长度\n         *  validator=Function({ itemValue, rule, rules, data, property }) 自定义校验，接收一个 Promise\n         *  trigger=change 触发方式\n         */\n        var validItemRules = function (validType, property, val) {\n            var data = props.data, formRules = props.rules;\n            var errorRules = [];\n            var syncVailds = [];\n            if (property && formRules) {\n                var rules_1 = XEUtils.get(formRules, property);\n                if (rules_1) {\n                    var itemValue_1 = XEUtils.isUndefined(val) ? XEUtils.get(data, property) : val;\n                    rules_1.forEach(function (rule) {\n                        var type = rule.type, trigger = rule.trigger, required = rule.required;\n                        if (validType === 'all' || !trigger || validType === trigger) {\n                            if (XEUtils.isFunction(rule.validator)) {\n                                var customValid = rule.validator({\n                                    itemValue: itemValue_1,\n                                    rule: rule,\n                                    rules: rules_1,\n                                    data: data,\n                                    field: property,\n                                    property: property,\n                                    $form: $xeform\n                                });\n                                if (customValid) {\n                                    if (XEUtils.isError(customValid)) {\n                                        errorRules.push(new Rule({ type: 'custom', trigger: trigger, content: customValid.message, rule: new Rule(rule) }));\n                                    }\n                                    else if (customValid.catch) {\n                                        // 如果为异步校验（注：异步校验是并发无序的）\n                                        syncVailds.push(customValid.catch(function (e) {\n                                            errorRules.push(new Rule({ type: 'custom', trigger: trigger, content: e ? e.message : (rule.content || rule.message), rule: new Rule(rule) }));\n                                        }));\n                                    }\n                                }\n                            }\n                            else {\n                                var isArrType = type === 'array';\n                                var hasEmpty = isArrType ? (!XEUtils.isArray(itemValue_1) || !itemValue_1.length) : eqEmptyValue(itemValue_1);\n                                if (required ? (hasEmpty || validErrorRuleValue(rule, itemValue_1)) : (!hasEmpty && validErrorRuleValue(rule, itemValue_1))) {\n                                    errorRules.push(new Rule(rule));\n                                }\n                            }\n                        }\n                    });\n                }\n            }\n            return Promise.all(syncVailds).then(function () {\n                if (errorRules.length) {\n                    var rest = { rules: errorRules, rule: errorRules[0] };\n                    return Promise.reject(rest);\n                }\n            });\n        };\n        var showErrTime;\n        var beginValidate = function (itemList, type, callback) {\n            var data = props.data, formRules = props.rules;\n            var validOpts = computeValidOpts.value;\n            var validRest = {};\n            var validFields = [];\n            var itemValids = [];\n            clearTimeout(showErrTime);\n            if (data && formRules) {\n                itemList.forEach(function (item) {\n                    var field = item.field;\n                    if (field) {\n                        itemValids.push(validItemRules(type || 'all', field).then(function () {\n                            item.errRule = null;\n                        }).catch(function (_a) {\n                            var rule = _a.rule, rules = _a.rules;\n                            var rest = { rule: rule, rules: rules, data: data, field: field, property: field, $form: $xeform };\n                            if (!validRest[field]) {\n                                validRest[field] = [];\n                            }\n                            validRest[field].push(rest);\n                            validFields.push(field);\n                            item.errRule = rule;\n                            return Promise.reject(rest);\n                        }));\n                    }\n                });\n                return Promise.all(itemValids).then(function () {\n                    if (callback) {\n                        callback();\n                    }\n                }).catch(function () {\n                    return new Promise(function (resolve) {\n                        showErrTime = window.setTimeout(function () {\n                            itemList.forEach(function (item) {\n                                if (item.errRule) {\n                                    item.showError = true;\n                                }\n                            });\n                        }, 20);\n                        if (validOpts.autoPos !== false) {\n                            nextTick(function () {\n                                handleFocus(validFields);\n                            });\n                        }\n                        if (callback) {\n                            callback(validRest);\n                            resolve();\n                        }\n                        else {\n                            resolve(validRest);\n                        }\n                    });\n                });\n            }\n            if (callback) {\n                callback();\n            }\n            return Promise.resolve();\n        };\n        var validate = function (callback) {\n            clearValidate();\n            return beginValidate(getItems(), '', callback);\n        };\n        var validateField = function (fieldOrItem, callback) {\n            var item = handleFieldOrItem($xeform, fieldOrItem);\n            return beginValidate(item ? [item] : [], '', callback);\n        };\n        var submitEvent = function (evnt) {\n            evnt.preventDefault();\n            if (!props.preventSubmit) {\n                clearValidate();\n                beginValidate(getItems()).then(function () {\n                    formMethods.dispatchEvent('submit', { data: props.data }, evnt);\n                }).catch(function (errMap) {\n                    formMethods.dispatchEvent('submit-invalid', { data: props.data, errMap: errMap }, evnt);\n                });\n            }\n        };\n        var closeTooltip = function () {\n            var tooltipStore = internalData.tooltipStore;\n            var $tooltip = refTooltip.value;\n            if (tooltipStore.visible) {\n                Object.assign(tooltipStore, {\n                    item: null,\n                    visible: false\n                });\n                if ($tooltip) {\n                    $tooltip.close();\n                }\n            }\n            return nextTick();\n        };\n        var triggerTitleTipEvent = function (evnt, params) {\n            var item = params.item;\n            var tooltipStore = internalData.tooltipStore;\n            var $tooltip = refTooltip.value;\n            var overflowElem = evnt.currentTarget.children[0];\n            var content = (overflowElem.textContent || '').trim();\n            var isCellOverflow = overflowElem.scrollWidth > overflowElem.clientWidth;\n            clearTimeout(internalData.tooltipTimeout);\n            if (tooltipStore.item !== item) {\n                closeTooltip();\n            }\n            if (content && isCellOverflow) {\n                Object.assign(tooltipStore, {\n                    item: item,\n                    visible: true\n                });\n                if ($tooltip) {\n                    $tooltip.open(overflowElem, content);\n                }\n            }\n        };\n        var handleTitleTipLeaveEvent = function () {\n            var tooltipOpts = computeTooltipOpts.value;\n            var $tooltip = refTooltip.value;\n            if ($tooltip) {\n                $tooltip.setActived(false);\n            }\n            if (tooltipOpts.enterable) {\n                internalData.tooltipTimeout = setTimeout(function () {\n                    $tooltip = refTooltip.value;\n                    if ($tooltip && !$tooltip.isActived()) {\n                        closeTooltip();\n                    }\n                }, tooltipOpts.leaveDelay);\n            }\n            else {\n                closeTooltip();\n            }\n        };\n        /**\n         * 更新项状态\n         * 如果组件值 v-model 发生 change 时，调用改函数用于更新某一项编辑状态\n         * 如果单元格配置了校验规则，则会进行校验\n         */\n        var updateStatus = function (scope, itemValue) {\n            var property = scope.property;\n            if (property) {\n                validItemRules('change', property, itemValue)\n                    .then(function () {\n                    clearValidate(property);\n                })\n                    .catch(function (_a) {\n                    var rule = _a.rule;\n                    var item = getItemByField(property);\n                    if (item) {\n                        item.showError = true;\n                        item.errRule = rule;\n                    }\n                });\n            }\n        };\n        var renderItems = function (itemList) {\n            var data = props.data, rules = props.rules, allTitleOverflow = props.titleOverflow;\n            var collapseAll = reactData.collapseAll;\n            var validOpts = computeValidOpts.value;\n            return itemList.map(function (item) {\n                var slots = item.slots, title = item.title, visible = item.visible, folding = item.folding, visibleMethod = item.visibleMethod, field = item.field, collapseNode = item.collapseNode, itemRender = item.itemRender, showError = item.showError, errRule = item.errRule, className = item.className, titleOverflow = item.titleOverflow, children = item.children;\n                var compConf = isEnableConf(itemRender) ? VXETable.renderer.get(itemRender.name) : null;\n                var defaultSlot = slots ? slots.default : null;\n                var titleSlot = slots ? slots.title : null;\n                var span = item.span || props.span;\n                var align = item.align || props.align;\n                var titleAlign = item.titleAlign || props.titleAlign;\n                var titleWidth = item.titleWidth || props.titleWidth;\n                var itemOverflow = (XEUtils.isUndefined(titleOverflow) || XEUtils.isNull(titleOverflow)) ? allTitleOverflow : titleOverflow;\n                var showEllipsis = itemOverflow === 'ellipsis';\n                var showTitle = itemOverflow === 'title';\n                var showTooltip = itemOverflow === true || itemOverflow === 'tooltip';\n                var hasEllipsis = showTitle || showTooltip || showEllipsis;\n                var itemVisibleMethod = visibleMethod;\n                var params = { data: data, field: field, property: field, item: item, $form: $xeform };\n                if (visible === false) {\n                    return createCommentVNode();\n                }\n                var isRequired = false;\n                if (rules) {\n                    var itemRules = rules[field];\n                    if (itemRules) {\n                        isRequired = itemRules.some(function (rule) { return rule.required; });\n                    }\n                }\n                // 如果为项集合\n                var isGather = children && children.length > 0;\n                if (isGather) {\n                    var childVNs = renderItems(item.children);\n                    return childVNs.length ? h('div', {\n                        class: ['vxe-form--gather vxe-row', item.id, span ? \"vxe-col--\" + span + \" is--span\" : '', className ? (XEUtils.isFunction(className) ? className(params) : className) : '']\n                    }, childVNs) : createCommentVNode();\n                }\n                if (!itemVisibleMethod && compConf && compConf.itemVisibleMethod) {\n                    itemVisibleMethod = compConf.itemVisibleMethod;\n                }\n                var contentVNs = [];\n                if (defaultSlot) {\n                    contentVNs = callSlot(defaultSlot, params);\n                }\n                else if (compConf && compConf.renderItemContent) {\n                    contentVNs = compConf.renderItemContent(itemRender, params);\n                }\n                else if (field) {\n                    contentVNs = [\"\" + XEUtils.get(data, field)];\n                }\n                if (collapseNode) {\n                    contentVNs.push(h('div', {\n                        class: 'vxe-form--item-trigger-node',\n                        onClick: toggleCollapseEvent\n                    }, [\n                        h('span', {\n                            class: 'vxe-form--item-trigger-text'\n                        }, collapseAll ? GlobalConfig.i18n('vxe.form.unfolding') : GlobalConfig.i18n('vxe.form.folding')),\n                        h('i', {\n                            class: ['vxe-form--item-trigger-icon', collapseAll ? GlobalConfig.icon.FORM_FOLDING : GlobalConfig.icon.FORM_UNFOLDING]\n                        })\n                    ]));\n                }\n                if (errRule && validOpts.showMessage) {\n                    contentVNs.push(h('div', {\n                        class: 'vxe-form--item-valid',\n                        style: errRule.maxWidth ? {\n                            width: errRule.maxWidth + \"px\"\n                        } : null\n                    }, errRule.content));\n                }\n                var ons = showTooltip ? {\n                    onMouseenter: function (evnt) {\n                        triggerTitleTipEvent(evnt, params);\n                    },\n                    onMouseleave: handleTitleTipLeaveEvent\n                } : {};\n                return h('div', {\n                    class: ['vxe-form--item', item.id, span ? \"vxe-col--\" + span + \" is--span\" : '', className ? (XEUtils.isFunction(className) ? className(params) : className) : '', {\n                            'is--title': title,\n                            'is--required': isRequired,\n                            'is--hidden': folding && collapseAll,\n                            'is--active': !itemVisibleMethod || itemVisibleMethod(params),\n                            'is--error': showError\n                        }],\n                    key: item.id\n                }, [\n                    h('div', {\n                        class: 'vxe-form--item-inner'\n                    }, [\n                        title || titleSlot ? h('div', __assign({ class: ['vxe-form--item-title', titleAlign ? \"align--\" + titleAlign : null, {\n                                    'is--ellipsis': hasEllipsis\n                                }], style: titleWidth ? {\n                                width: isNaN(titleWidth) ? titleWidth : titleWidth + \"px\"\n                            } : null, title: showTitle ? getFuncText(title) : null }, ons), renderTitle($xeform, item)) : null,\n                        h('div', {\n                            class: ['vxe-form--item-content', align ? \"align--\" + align : null]\n                        }, contentVNs)\n                    ])\n                ]);\n            });\n        };\n        formMethods = {\n            dispatchEvent: function (type, params, evnt) {\n                emit(type, Object.assign({ $form: $xeform, $event: evnt }, params));\n            },\n            reset: reset,\n            validate: validate,\n            validateField: validateField,\n            clearValidate: clearValidate,\n            updateStatus: updateStatus,\n            toggleCollapse: toggleCollapse,\n            getItems: getItems,\n            getItemByField: getItemByField,\n            closeTooltip: closeTooltip\n        };\n        var formPrivateMethods = {\n            callSlot: callSlot,\n            toggleCollapseEvent: toggleCollapseEvent,\n            triggerTitleTipEvent: triggerTitleTipEvent,\n            handleTitleTipLeaveEvent: handleTitleTipLeaveEvent\n        };\n        Object.assign($xeform, formMethods, formPrivateMethods);\n        watch(function () { return reactData.staticItems; }, function (value) {\n            reactData.formItems = value;\n        });\n        watch(function () { return props.items; }, function (value) {\n            loadItem(value || []);\n        });\n        watch(function () { return props.collapseStatus; }, function (value) {\n            reactData.collapseAll = !!value;\n        });\n        onMounted(function () {\n            nextTick(function () {\n                if (process.env.NODE_ENV === 'development') {\n                    if (props.customLayout && props.items) {\n                        errLog('vxe.error.errConflicts', ['custom-layout', 'items']);\n                    }\n                }\n                loadItem(props.items || []);\n            });\n        });\n        var renderVN = function () {\n            var _a;\n            var loading = props.loading, className = props.className, data = props.data, titleColon = props.titleColon, titleAsterisk = props.titleAsterisk, customLayout = props.customLayout;\n            var formItems = reactData.formItems;\n            // const formItems: any[] = []\n            var vSize = computeSize.value;\n            var tooltipOpts = computeTooltipOpts.value;\n            var defaultSlot = slots.default;\n            return h('form', {\n                ref: refElem,\n                class: ['vxe-form', className ? (XEUtils.isFunction(className) ? className({ items: formItems, data: data, $form: $xeform }) : className) : '', (_a = {},\n                        _a[\"size--\" + vSize] = vSize,\n                        _a['is--colon'] = titleColon,\n                        _a['is--asterisk'] = titleAsterisk,\n                        _a['is--loading'] = loading,\n                        _a)],\n                onSubmit: submitEvent,\n                onReset: resetEvent\n            }, [\n                h('div', {\n                    class: 'vxe-form--wrapper vxe-row'\n                }, customLayout ? (defaultSlot ? defaultSlot({}) : []) : renderItems(formItems)),\n                h('div', {\n                    class: 'vxe-form-slots',\n                    ref: 'hideItem'\n                }, customLayout ? [] : (defaultSlot ? defaultSlot({}) : [])),\n                h('div', {\n                    class: ['vxe-loading', {\n                            'is--visible': loading\n                        }]\n                }, [\n                    h('div', {\n                        class: 'vxe-loading--spinner'\n                    })\n                ]),\n                /**\n                 * 工具提示\n                 */\n                hasUseTooltip ? h(resolveComponent('vxe-tooltip'), __assign({ ref: refTooltip }, tooltipOpts)) : createCommentVNode()\n            ]);\n        };\n        $xeform.renderVN = renderVN;\n        provide('$xeform', $xeform);\n        return $xeform;\n    },\n    render: function () {\n        return this.renderVN();\n    }\n});\n"]},"metadata":{},"sourceType":"module"}