{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport XEUtils from 'xe-utils';\nimport GlobalConfig from '../../v-x-e-table/src/conf';\nimport { VXETable } from '../../v-x-e-table';\nimport { browse } from '../../tools/dom';\nimport { parseFile } from '../../tools/utils';\nimport { errLog, getLog } from '../../tools/log'; // 导入\n\nvar fileForm;\nvar fileInput; // 打印\n\nvar printFrame; // 默认导出或打印的 HTML 样式\n\nvar defaultHtmlStyle = 'body{margin:0;color:#333333;font-size:14px;font-family:\"Microsoft YaHei\",微软雅黑,\"MicrosoftJhengHei\",华文细黑,STHeiti,MingLiu}body *{-webkit-box-sizing:border-box;box-sizing:border-box}.vxe-table{border-collapse:collapse;text-align:left;border-spacing:0}.vxe-table:not(.is--print){table-layout:fixed}.vxe-table,.vxe-table th,.vxe-table td,.vxe-table td{border-color:#D0D0D0;border-style:solid;border-width:0}.vxe-table.is--print{width:100%}.border--default,.border--full,.border--outer{border-top-width:1px}.border--default,.border--full,.border--outer{border-left-width:1px}.border--outer,.border--default th,.border--default td,.border--full th,.border--full td,.border--outer th,.border--inner th,.border--inner td{border-bottom-width:1px}.border--default,.border--outer,.border--full th,.border--full td{border-right-width:1px}.border--default th,.border--full th,.border--outer th{background-color:#f8f8f9}.vxe-table td>div,.vxe-table th>div{padding:.5em .4em}.col--center{text-align:center}.col--right{text-align:right}.vxe-table:not(.is--print) .col--ellipsis>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-break:break-all}.vxe-table--tree-node{text-align:left}.vxe-table--tree-node-wrapper{position:relative}.vxe-table--tree-icon-wrapper{position:absolute;top:50%;width:1em;height:1em;text-align:center;-webkit-transform:translateY(-50%);transform:translateY(-50%);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}.vxe-table--tree-unfold-icon,.vxe-table--tree-fold-icon{position:absolute;width:0;height:0;border-style:solid;border-width:.5em;border-right-color:transparent;border-bottom-color:transparent}.vxe-table--tree-unfold-icon{left:.3em;top:0;border-left-color:#939599;border-top-color:transparent}.vxe-table--tree-fold-icon{left:0;top:.3em;border-left-color:transparent;border-top-color:#939599}.vxe-table--tree-cell{display:block;padding-left:1.5em}.vxe-table input[type=\"checkbox\"]{margin:0}.vxe-table input[type=\"checkbox\"],.vxe-table input[type=\"radio\"],.vxe-table input[type=\"checkbox\"]+span,.vxe-table input[type=\"radio\"]+span{vertical-align:middle;padding-left:0.4em}';\nexport function createFrame() {\n  var frame = document.createElement('iframe');\n  frame.className = 'vxe-table--print-frame';\n  return frame;\n}\nexport function getExportBlobByContent(content, options) {\n  return new Blob([content], {\n    type: \"text/\" + options.type + \";charset=utf-8;\"\n  });\n}\nexport function createHtmlPage(opts, content) {\n  var style = opts.style;\n  return ['<!DOCTYPE html><html>', '<head>', '<meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui\">', \"<title>\" + opts.sheetName + \"</title>\", \"<style>\" + defaultHtmlStyle + \"</style>\", style ? \"<style>\" + style + \"</style>\" : '', '</head>', \"<body>\" + content + \"</body>\", '</html>'].join('');\n}\n/**\n * 读取本地文件\n * @param {*} options 参数\n */\n\nexport var readLocalFile = function (options) {\n  var opts = Object.assign({}, options);\n\n  if (!fileForm) {\n    fileForm = document.createElement('form');\n    fileInput = document.createElement('input');\n    fileForm.className = 'vxe-table--file-form';\n    fileInput.name = 'file';\n    fileInput.type = 'file';\n    fileForm.appendChild(fileInput);\n    document.body.appendChild(fileForm);\n  }\n\n  return new Promise(function (resolve, reject) {\n    var types = opts.types || [];\n    var isAllType = !types.length || types.some(function (type) {\n      return type === '*';\n    });\n    fileInput.multiple = !!opts.multiple;\n    fileInput.accept = isAllType ? '' : \".\" + types.join(', .');\n\n    fileInput.onchange = function (evnt) {\n      var files = evnt.target.files;\n      var file = files[0];\n      var errType = ''; // 校验类型\n\n      if (!isAllType) {\n        for (var fIndex = 0; fIndex < files.length; fIndex++) {\n          var type = parseFile(files[fIndex]).type;\n\n          if (!XEUtils.includes(types, type)) {\n            errType = type;\n            break;\n          }\n        }\n      }\n\n      if (!errType) {\n        resolve({\n          status: true,\n          files: files,\n          file: file\n        });\n      } else {\n        if (opts.message !== false) {\n          // 检测弹窗模块\n          if (process.env.NODE_ENV === 'development') {\n            if (!VXETable.modal) {\n              errLog('vxe.error.reqModule', ['Modal']);\n            }\n          }\n\n          VXETable.modal.message({\n            content: GlobalConfig.i18n('vxe.error.notType', [errType]),\n            status: 'error'\n          });\n        }\n\n        var params = {\n          status: false,\n          files: files,\n          file: file\n        };\n        reject(params);\n      }\n    };\n\n    fileForm.reset();\n    fileInput.click();\n  });\n};\n\nfunction removePrintFrame() {\n  if (printFrame) {\n    if (printFrame.parentNode) {\n      try {\n        printFrame.contentDocument.write('');\n      } catch (e) {}\n\n      printFrame.parentNode.removeChild(printFrame);\n    }\n\n    printFrame = null;\n  }\n}\n\nfunction appendPrintFrame() {\n  if (!printFrame.parentNode) {\n    document.body.appendChild(printFrame);\n  }\n}\n\nfunction afterPrintEvent() {\n  requestAnimationFrame(removePrintFrame);\n}\n\nexport function handlePrint($xetable, opts, content) {\n  if (content === void 0) {\n    content = '';\n  }\n\n  var beforePrintMethod = opts.beforePrintMethod;\n\n  if (beforePrintMethod) {\n    content = beforePrintMethod({\n      content: content,\n      options: opts,\n      $table: $xetable\n    }) || '';\n  }\n\n  content = createHtmlPage(opts, content);\n  var blob = getExportBlobByContent(content, opts);\n\n  if (browse.msie) {\n    removePrintFrame();\n    printFrame = createFrame();\n    appendPrintFrame();\n    printFrame.contentDocument.write(content);\n    printFrame.contentDocument.execCommand('print');\n  } else {\n    if (!printFrame) {\n      printFrame = createFrame();\n\n      printFrame.onload = function (evnt) {\n        if (evnt.target.src) {\n          evnt.target.contentWindow.onafterprint = afterPrintEvent;\n          evnt.target.contentWindow.print();\n        }\n      };\n    }\n\n    appendPrintFrame();\n    printFrame.src = URL.createObjectURL(blob);\n  }\n}\n/**\n * 保存文件到本地\n * @param {*} options 参数\n */\n\nexport var saveLocalFile = function (options) {\n  var filename = options.filename,\n      type = options.type,\n      content = options.content;\n  var name = filename + \".\" + type;\n\n  if (window.Blob) {\n    var blob = content instanceof Blob ? content : getExportBlobByContent(XEUtils.toValueString(content), options);\n\n    if (navigator.msSaveBlob) {\n      navigator.msSaveBlob(blob, name);\n    } else {\n      var url_1 = URL.createObjectURL(blob);\n      var linkElem_1 = document.createElement('a');\n      linkElem_1.target = '_blank';\n      linkElem_1.download = name;\n      linkElem_1.href = url_1;\n      document.body.appendChild(linkElem_1);\n      linkElem_1.click();\n      requestAnimationFrame(function () {\n        if (linkElem_1.parentNode) {\n          linkElem_1.parentNode.removeChild(linkElem_1);\n        }\n\n        URL.revokeObjectURL(url_1);\n      });\n    }\n\n    return Promise.resolve();\n  }\n\n  return Promise.reject(new Error(getLog('vxe.error.notExp')));\n};","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/vxe-table/es/export/src/util.js"],"names":["XEUtils","GlobalConfig","VXETable","browse","parseFile","errLog","getLog","fileForm","fileInput","printFrame","defaultHtmlStyle","createFrame","frame","document","createElement","className","getExportBlobByContent","content","options","Blob","type","createHtmlPage","opts","style","sheetName","join","readLocalFile","Object","assign","name","appendChild","body","Promise","resolve","reject","types","isAllType","length","some","multiple","accept","onchange","evnt","files","target","file","errType","fIndex","includes","status","message","process","env","NODE_ENV","modal","i18n","params","reset","click","removePrintFrame","parentNode","contentDocument","write","e","removeChild","appendPrintFrame","afterPrintEvent","requestAnimationFrame","handlePrint","$xetable","beforePrintMethod","$table","blob","msie","execCommand","onload","src","contentWindow","onafterprint","print","URL","createObjectURL","saveLocalFile","filename","window","toValueString","navigator","msSaveBlob","url_1","linkElem_1","download","href","revokeObjectURL","Error"],"mappings":";AAAA,OAAOA,OAAP,MAAoB,UAApB;AACA,OAAOC,YAAP,MAAyB,4BAAzB;AACA,SAASC,QAAT,QAAyB,mBAAzB;AACA,SAASC,MAAT,QAAuB,iBAAvB;AACA,SAASC,SAAT,QAA0B,mBAA1B;AACA,SAASC,MAAT,EAAiBC,MAAjB,QAA+B,iBAA/B,C,CACA;;AACA,IAAIC,QAAJ;AACA,IAAIC,SAAJ,C,CACA;;AACA,IAAIC,UAAJ,C,CACA;;AACA,IAAIC,gBAAgB,GAAG,4mEAAvB;AACA,OAAO,SAASC,WAAT,GAAuB;AAC1B,MAAIC,KAAK,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAZ;AACAF,EAAAA,KAAK,CAACG,SAAN,GAAkB,wBAAlB;AACA,SAAOH,KAAP;AACH;AACD,OAAO,SAASI,sBAAT,CAAgCC,OAAhC,EAAyCC,OAAzC,EAAkD;AACrD,SAAO,IAAIC,IAAJ,CAAS,CAACF,OAAD,CAAT,EAAoB;AAAEG,IAAAA,IAAI,EAAE,UAAUF,OAAO,CAACE,IAAlB,GAAyB;AAAjC,GAApB,CAAP;AACH;AACD,OAAO,SAASC,cAAT,CAAwBC,IAAxB,EAA8BL,OAA9B,EAAuC;AAC1C,MAAIM,KAAK,GAAGD,IAAI,CAACC,KAAjB;AACA,SAAO,CACH,uBADG,EAEH,QAFG,EAGH,uJAHG,EAIH,YAAYD,IAAI,CAACE,SAAjB,GAA6B,UAJ1B,EAKH,YAAYd,gBAAZ,GAA+B,UAL5B,EAMHa,KAAK,GAAG,YAAYA,KAAZ,GAAoB,UAAvB,GAAoC,EANtC,EAOH,SAPG,EAQH,WAAWN,OAAX,GAAqB,SARlB,EASH,SATG,EAULQ,IAVK,CAUA,EAVA,CAAP;AAWH;AACD;AACA;AACA;AACA;;AACA,OAAO,IAAIC,aAAa,GAAG,UAAUR,OAAV,EAAmB;AAC1C,MAAII,IAAI,GAAGK,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBV,OAAlB,CAAX;;AACA,MAAI,CAACX,QAAL,EAAe;AACXA,IAAAA,QAAQ,GAAGM,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAX;AACAN,IAAAA,SAAS,GAAGK,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAZ;AACAP,IAAAA,QAAQ,CAACQ,SAAT,GAAqB,sBAArB;AACAP,IAAAA,SAAS,CAACqB,IAAV,GAAiB,MAAjB;AACArB,IAAAA,SAAS,CAACY,IAAV,GAAiB,MAAjB;AACAb,IAAAA,QAAQ,CAACuB,WAAT,CAAqBtB,SAArB;AACAK,IAAAA,QAAQ,CAACkB,IAAT,CAAcD,WAAd,CAA0BvB,QAA1B;AACH;;AACD,SAAO,IAAIyB,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC1C,QAAIC,KAAK,GAAGb,IAAI,CAACa,KAAL,IAAc,EAA1B;AACA,QAAIC,SAAS,GAAG,CAACD,KAAK,CAACE,MAAP,IAAiBF,KAAK,CAACG,IAAN,CAAW,UAAUlB,IAAV,EAAgB;AAAE,aAAOA,IAAI,KAAK,GAAhB;AAAsB,KAAnD,CAAjC;AACAZ,IAAAA,SAAS,CAAC+B,QAAV,GAAqB,CAAC,CAACjB,IAAI,CAACiB,QAA5B;AACA/B,IAAAA,SAAS,CAACgC,MAAV,GAAmBJ,SAAS,GAAG,EAAH,GAAQ,MAAMD,KAAK,CAACV,IAAN,CAAW,KAAX,CAA1C;;AACAjB,IAAAA,SAAS,CAACiC,QAAV,GAAqB,UAAUC,IAAV,EAAgB;AACjC,UAAIC,KAAK,GAAGD,IAAI,CAACE,MAAL,CAAYD,KAAxB;AACA,UAAIE,IAAI,GAAGF,KAAK,CAAC,CAAD,CAAhB;AACA,UAAIG,OAAO,GAAG,EAAd,CAHiC,CAIjC;;AACA,UAAI,CAACV,SAAL,EAAgB;AACZ,aAAK,IAAIW,MAAM,GAAG,CAAlB,EAAqBA,MAAM,GAAGJ,KAAK,CAACN,MAApC,EAA4CU,MAAM,EAAlD,EAAsD;AAClD,cAAI3B,IAAI,GAAGhB,SAAS,CAACuC,KAAK,CAACI,MAAD,CAAN,CAAT,CAAyB3B,IAApC;;AACA,cAAI,CAACpB,OAAO,CAACgD,QAAR,CAAiBb,KAAjB,EAAwBf,IAAxB,CAAL,EAAoC;AAChC0B,YAAAA,OAAO,GAAG1B,IAAV;AACA;AACH;AACJ;AACJ;;AACD,UAAI,CAAC0B,OAAL,EAAc;AACVb,QAAAA,OAAO,CAAC;AAAEgB,UAAAA,MAAM,EAAE,IAAV;AAAgBN,UAAAA,KAAK,EAAEA,KAAvB;AAA8BE,UAAAA,IAAI,EAAEA;AAApC,SAAD,CAAP;AACH,OAFD,MAGK;AACD,YAAIvB,IAAI,CAAC4B,OAAL,KAAiB,KAArB,EAA4B;AACxB;AACA,cAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,aAA7B,EAA4C;AACxC,gBAAI,CAACnD,QAAQ,CAACoD,KAAd,EAAqB;AACjBjD,cAAAA,MAAM,CAAC,qBAAD,EAAwB,CAAC,OAAD,CAAxB,CAAN;AACH;AACJ;;AACDH,UAAAA,QAAQ,CAACoD,KAAT,CAAeJ,OAAf,CAAuB;AAAEjC,YAAAA,OAAO,EAAEhB,YAAY,CAACsD,IAAb,CAAkB,mBAAlB,EAAuC,CAACT,OAAD,CAAvC,CAAX;AAA8DG,YAAAA,MAAM,EAAE;AAAtE,WAAvB;AACH;;AACD,YAAIO,MAAM,GAAG;AAAEP,UAAAA,MAAM,EAAE,KAAV;AAAiBN,UAAAA,KAAK,EAAEA,KAAxB;AAA+BE,UAAAA,IAAI,EAAEA;AAArC,SAAb;AACAX,QAAAA,MAAM,CAACsB,MAAD,CAAN;AACH;AACJ,KA9BD;;AA+BAjD,IAAAA,QAAQ,CAACkD,KAAT;AACAjD,IAAAA,SAAS,CAACkD,KAAV;AACH,GAtCM,CAAP;AAuCH,CAlDM;;AAmDP,SAASC,gBAAT,GAA4B;AACxB,MAAIlD,UAAJ,EAAgB;AACZ,QAAIA,UAAU,CAACmD,UAAf,EAA2B;AACvB,UAAI;AACAnD,QAAAA,UAAU,CAACoD,eAAX,CAA2BC,KAA3B,CAAiC,EAAjC;AACH,OAFD,CAGA,OAAOC,CAAP,EAAU,CAAG;;AACbtD,MAAAA,UAAU,CAACmD,UAAX,CAAsBI,WAAtB,CAAkCvD,UAAlC;AACH;;AACDA,IAAAA,UAAU,GAAG,IAAb;AACH;AACJ;;AACD,SAASwD,gBAAT,GAA4B;AACxB,MAAI,CAACxD,UAAU,CAACmD,UAAhB,EAA4B;AACxB/C,IAAAA,QAAQ,CAACkB,IAAT,CAAcD,WAAd,CAA0BrB,UAA1B;AACH;AACJ;;AACD,SAASyD,eAAT,GAA2B;AACvBC,EAAAA,qBAAqB,CAACR,gBAAD,CAArB;AACH;;AACD,OAAO,SAASS,WAAT,CAAqBC,QAArB,EAA+B/C,IAA/B,EAAqCL,OAArC,EAA8C;AACjD,MAAIA,OAAO,KAAK,KAAK,CAArB,EAAwB;AAAEA,IAAAA,OAAO,GAAG,EAAV;AAAe;;AACzC,MAAIqD,iBAAiB,GAAGhD,IAAI,CAACgD,iBAA7B;;AACA,MAAIA,iBAAJ,EAAuB;AACnBrD,IAAAA,OAAO,GAAGqD,iBAAiB,CAAC;AAAErD,MAAAA,OAAO,EAAEA,OAAX;AAAoBC,MAAAA,OAAO,EAAEI,IAA7B;AAAmCiD,MAAAA,MAAM,EAAEF;AAA3C,KAAD,CAAjB,IAA4E,EAAtF;AACH;;AACDpD,EAAAA,OAAO,GAAGI,cAAc,CAACC,IAAD,EAAOL,OAAP,CAAxB;AACA,MAAIuD,IAAI,GAAGxD,sBAAsB,CAACC,OAAD,EAAUK,IAAV,CAAjC;;AACA,MAAInB,MAAM,CAACsE,IAAX,EAAiB;AACbd,IAAAA,gBAAgB;AAChBlD,IAAAA,UAAU,GAAGE,WAAW,EAAxB;AACAsD,IAAAA,gBAAgB;AAChBxD,IAAAA,UAAU,CAACoD,eAAX,CAA2BC,KAA3B,CAAiC7C,OAAjC;AACAR,IAAAA,UAAU,CAACoD,eAAX,CAA2Ba,WAA3B,CAAuC,OAAvC;AACH,GAND,MAOK;AACD,QAAI,CAACjE,UAAL,EAAiB;AACbA,MAAAA,UAAU,GAAGE,WAAW,EAAxB;;AACAF,MAAAA,UAAU,CAACkE,MAAX,GAAoB,UAAUjC,IAAV,EAAgB;AAChC,YAAIA,IAAI,CAACE,MAAL,CAAYgC,GAAhB,EAAqB;AACjBlC,UAAAA,IAAI,CAACE,MAAL,CAAYiC,aAAZ,CAA0BC,YAA1B,GAAyCZ,eAAzC;AACAxB,UAAAA,IAAI,CAACE,MAAL,CAAYiC,aAAZ,CAA0BE,KAA1B;AACH;AACJ,OALD;AAMH;;AACDd,IAAAA,gBAAgB;AAChBxD,IAAAA,UAAU,CAACmE,GAAX,GAAiBI,GAAG,CAACC,eAAJ,CAAoBT,IAApB,CAAjB;AACH;AACJ;AACD;AACA;AACA;AACA;;AACA,OAAO,IAAIU,aAAa,GAAG,UAAUhE,OAAV,EAAmB;AAC1C,MAAIiE,QAAQ,GAAGjE,OAAO,CAACiE,QAAvB;AAAA,MAAiC/D,IAAI,GAAGF,OAAO,CAACE,IAAhD;AAAA,MAAsDH,OAAO,GAAGC,OAAO,CAACD,OAAxE;AACA,MAAIY,IAAI,GAAGsD,QAAQ,GAAG,GAAX,GAAiB/D,IAA5B;;AACA,MAAIgE,MAAM,CAACjE,IAAX,EAAiB;AACb,QAAIqD,IAAI,GAAGvD,OAAO,YAAYE,IAAnB,GAA0BF,OAA1B,GAAoCD,sBAAsB,CAAChB,OAAO,CAACqF,aAAR,CAAsBpE,OAAtB,CAAD,EAAiCC,OAAjC,CAArE;;AACA,QAAIoE,SAAS,CAACC,UAAd,EAA0B;AACtBD,MAAAA,SAAS,CAACC,UAAV,CAAqBf,IAArB,EAA2B3C,IAA3B;AACH,KAFD,MAGK;AACD,UAAI2D,KAAK,GAAGR,GAAG,CAACC,eAAJ,CAAoBT,IAApB,CAAZ;AACA,UAAIiB,UAAU,GAAG5E,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAjB;AACA2E,MAAAA,UAAU,CAAC7C,MAAX,GAAoB,QAApB;AACA6C,MAAAA,UAAU,CAACC,QAAX,GAAsB7D,IAAtB;AACA4D,MAAAA,UAAU,CAACE,IAAX,GAAkBH,KAAlB;AACA3E,MAAAA,QAAQ,CAACkB,IAAT,CAAcD,WAAd,CAA0B2D,UAA1B;AACAA,MAAAA,UAAU,CAAC/B,KAAX;AACAS,MAAAA,qBAAqB,CAAC,YAAY;AAC9B,YAAIsB,UAAU,CAAC7B,UAAf,EAA2B;AACvB6B,UAAAA,UAAU,CAAC7B,UAAX,CAAsBI,WAAtB,CAAkCyB,UAAlC;AACH;;AACDT,QAAAA,GAAG,CAACY,eAAJ,CAAoBJ,KAApB;AACH,OALoB,CAArB;AAMH;;AACD,WAAOxD,OAAO,CAACC,OAAR,EAAP;AACH;;AACD,SAAOD,OAAO,CAACE,MAAR,CAAe,IAAI2D,KAAJ,CAAUvF,MAAM,CAAC,kBAAD,CAAhB,CAAf,CAAP;AACH,CA1BM","sourcesContent":["import XEUtils from 'xe-utils';\nimport GlobalConfig from '../../v-x-e-table/src/conf';\nimport { VXETable } from '../../v-x-e-table';\nimport { browse } from '../../tools/dom';\nimport { parseFile } from '../../tools/utils';\nimport { errLog, getLog } from '../../tools/log';\n// 导入\nvar fileForm;\nvar fileInput;\n// 打印\nvar printFrame;\n// 默认导出或打印的 HTML 样式\nvar defaultHtmlStyle = 'body{margin:0;color:#333333;font-size:14px;font-family:\"Microsoft YaHei\",微软雅黑,\"MicrosoftJhengHei\",华文细黑,STHeiti,MingLiu}body *{-webkit-box-sizing:border-box;box-sizing:border-box}.vxe-table{border-collapse:collapse;text-align:left;border-spacing:0}.vxe-table:not(.is--print){table-layout:fixed}.vxe-table,.vxe-table th,.vxe-table td,.vxe-table td{border-color:#D0D0D0;border-style:solid;border-width:0}.vxe-table.is--print{width:100%}.border--default,.border--full,.border--outer{border-top-width:1px}.border--default,.border--full,.border--outer{border-left-width:1px}.border--outer,.border--default th,.border--default td,.border--full th,.border--full td,.border--outer th,.border--inner th,.border--inner td{border-bottom-width:1px}.border--default,.border--outer,.border--full th,.border--full td{border-right-width:1px}.border--default th,.border--full th,.border--outer th{background-color:#f8f8f9}.vxe-table td>div,.vxe-table th>div{padding:.5em .4em}.col--center{text-align:center}.col--right{text-align:right}.vxe-table:not(.is--print) .col--ellipsis>div{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-break:break-all}.vxe-table--tree-node{text-align:left}.vxe-table--tree-node-wrapper{position:relative}.vxe-table--tree-icon-wrapper{position:absolute;top:50%;width:1em;height:1em;text-align:center;-webkit-transform:translateY(-50%);transform:translateY(-50%);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}.vxe-table--tree-unfold-icon,.vxe-table--tree-fold-icon{position:absolute;width:0;height:0;border-style:solid;border-width:.5em;border-right-color:transparent;border-bottom-color:transparent}.vxe-table--tree-unfold-icon{left:.3em;top:0;border-left-color:#939599;border-top-color:transparent}.vxe-table--tree-fold-icon{left:0;top:.3em;border-left-color:transparent;border-top-color:#939599}.vxe-table--tree-cell{display:block;padding-left:1.5em}.vxe-table input[type=\"checkbox\"]{margin:0}.vxe-table input[type=\"checkbox\"],.vxe-table input[type=\"radio\"],.vxe-table input[type=\"checkbox\"]+span,.vxe-table input[type=\"radio\"]+span{vertical-align:middle;padding-left:0.4em}';\nexport function createFrame() {\n    var frame = document.createElement('iframe');\n    frame.className = 'vxe-table--print-frame';\n    return frame;\n}\nexport function getExportBlobByContent(content, options) {\n    return new Blob([content], { type: \"text/\" + options.type + \";charset=utf-8;\" });\n}\nexport function createHtmlPage(opts, content) {\n    var style = opts.style;\n    return [\n        '<!DOCTYPE html><html>',\n        '<head>',\n        '<meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui\">',\n        \"<title>\" + opts.sheetName + \"</title>\",\n        \"<style>\" + defaultHtmlStyle + \"</style>\",\n        style ? \"<style>\" + style + \"</style>\" : '',\n        '</head>',\n        \"<body>\" + content + \"</body>\",\n        '</html>'\n    ].join('');\n}\n/**\n * 读取本地文件\n * @param {*} options 参数\n */\nexport var readLocalFile = function (options) {\n    var opts = Object.assign({}, options);\n    if (!fileForm) {\n        fileForm = document.createElement('form');\n        fileInput = document.createElement('input');\n        fileForm.className = 'vxe-table--file-form';\n        fileInput.name = 'file';\n        fileInput.type = 'file';\n        fileForm.appendChild(fileInput);\n        document.body.appendChild(fileForm);\n    }\n    return new Promise(function (resolve, reject) {\n        var types = opts.types || [];\n        var isAllType = !types.length || types.some(function (type) { return type === '*'; });\n        fileInput.multiple = !!opts.multiple;\n        fileInput.accept = isAllType ? '' : \".\" + types.join(', .');\n        fileInput.onchange = function (evnt) {\n            var files = evnt.target.files;\n            var file = files[0];\n            var errType = '';\n            // 校验类型\n            if (!isAllType) {\n                for (var fIndex = 0; fIndex < files.length; fIndex++) {\n                    var type = parseFile(files[fIndex]).type;\n                    if (!XEUtils.includes(types, type)) {\n                        errType = type;\n                        break;\n                    }\n                }\n            }\n            if (!errType) {\n                resolve({ status: true, files: files, file: file });\n            }\n            else {\n                if (opts.message !== false) {\n                    // 检测弹窗模块\n                    if (process.env.NODE_ENV === 'development') {\n                        if (!VXETable.modal) {\n                            errLog('vxe.error.reqModule', ['Modal']);\n                        }\n                    }\n                    VXETable.modal.message({ content: GlobalConfig.i18n('vxe.error.notType', [errType]), status: 'error' });\n                }\n                var params = { status: false, files: files, file: file };\n                reject(params);\n            }\n        };\n        fileForm.reset();\n        fileInput.click();\n    });\n};\nfunction removePrintFrame() {\n    if (printFrame) {\n        if (printFrame.parentNode) {\n            try {\n                printFrame.contentDocument.write('');\n            }\n            catch (e) { }\n            printFrame.parentNode.removeChild(printFrame);\n        }\n        printFrame = null;\n    }\n}\nfunction appendPrintFrame() {\n    if (!printFrame.parentNode) {\n        document.body.appendChild(printFrame);\n    }\n}\nfunction afterPrintEvent() {\n    requestAnimationFrame(removePrintFrame);\n}\nexport function handlePrint($xetable, opts, content) {\n    if (content === void 0) { content = ''; }\n    var beforePrintMethod = opts.beforePrintMethod;\n    if (beforePrintMethod) {\n        content = beforePrintMethod({ content: content, options: opts, $table: $xetable }) || '';\n    }\n    content = createHtmlPage(opts, content);\n    var blob = getExportBlobByContent(content, opts);\n    if (browse.msie) {\n        removePrintFrame();\n        printFrame = createFrame();\n        appendPrintFrame();\n        printFrame.contentDocument.write(content);\n        printFrame.contentDocument.execCommand('print');\n    }\n    else {\n        if (!printFrame) {\n            printFrame = createFrame();\n            printFrame.onload = function (evnt) {\n                if (evnt.target.src) {\n                    evnt.target.contentWindow.onafterprint = afterPrintEvent;\n                    evnt.target.contentWindow.print();\n                }\n            };\n        }\n        appendPrintFrame();\n        printFrame.src = URL.createObjectURL(blob);\n    }\n}\n/**\n * 保存文件到本地\n * @param {*} options 参数\n */\nexport var saveLocalFile = function (options) {\n    var filename = options.filename, type = options.type, content = options.content;\n    var name = filename + \".\" + type;\n    if (window.Blob) {\n        var blob = content instanceof Blob ? content : getExportBlobByContent(XEUtils.toValueString(content), options);\n        if (navigator.msSaveBlob) {\n            navigator.msSaveBlob(blob, name);\n        }\n        else {\n            var url_1 = URL.createObjectURL(blob);\n            var linkElem_1 = document.createElement('a');\n            linkElem_1.target = '_blank';\n            linkElem_1.download = name;\n            linkElem_1.href = url_1;\n            document.body.appendChild(linkElem_1);\n            linkElem_1.click();\n            requestAnimationFrame(function () {\n                if (linkElem_1.parentNode) {\n                    linkElem_1.parentNode.removeChild(linkElem_1);\n                }\n                URL.revokeObjectURL(url_1);\n            });\n        }\n        return Promise.resolve();\n    }\n    return Promise.reject(new Error(getLog('vxe.error.notExp')));\n};\n"]},"metadata":{},"sourceType":"module"}