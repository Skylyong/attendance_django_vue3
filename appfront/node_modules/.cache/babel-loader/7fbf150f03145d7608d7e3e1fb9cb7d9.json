{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { defineComponent, nextTick, onBeforeUnmount, onMounted, onUpdated, reactive, ref, computed } from 'vue';\nimport PropTypes from '../_util/vue-types';\nimport classNames from '../_util/classNames';\nimport addEventListener from '../vc-util/Dom/addEventListener';\nimport Affix from '../affix';\nimport scrollTo from '../_util/scrollTo';\nimport getScroll from '../_util/getScroll';\nimport useConfigInject from '../_util/hooks/useConfigInject';\nimport useProvideAnchor from './context';\n\nfunction getDefaultContainer() {\n  return window;\n}\n\nfunction getOffsetTop(element, container) {\n  if (!element.getClientRects().length) {\n    return 0;\n  }\n\n  var rect = element.getBoundingClientRect();\n\n  if (rect.width || rect.height) {\n    if (container === window) {\n      container = element.ownerDocument.documentElement;\n      return rect.top - container.clientTop;\n    }\n\n    return rect.top - container.getBoundingClientRect().top;\n  }\n\n  return rect.top;\n}\n\nvar sharpMatcherRegx = /#(\\S+)$/;\nvar anchorProps = {\n  prefixCls: PropTypes.string,\n  offsetTop: PropTypes.number,\n  bounds: PropTypes.number,\n  affix: PropTypes.looseBool.def(true),\n  showInkInFixed: PropTypes.looseBool.def(false),\n  getContainer: PropTypes.func.def(getDefaultContainer),\n  wrapperClass: PropTypes.string,\n  wrapperStyle: PropTypes.style,\n  getCurrentAnchor: PropTypes.func,\n  targetOffset: PropTypes.number,\n  onChange: PropTypes.func,\n  onClick: PropTypes.func\n};\nexport default defineComponent({\n  name: 'AAnchor',\n  inheritAttrs: false,\n  props: anchorProps,\n  emits: ['change', 'click'],\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit,\n        attrs = _ref.attrs,\n        slots = _ref.slots,\n        expose = _ref.expose;\n\n    var _useConfigInject = useConfigInject('anchor', props),\n        prefixCls = _useConfigInject.prefixCls,\n        getTargetContainer = _useConfigInject.getTargetContainer,\n        direction = _useConfigInject.direction;\n\n    var inkNodeRef = ref();\n    var anchorRef = ref();\n    var state = reactive({\n      links: [],\n      scrollContainer: null,\n      scrollEvent: null,\n      animating: false\n    });\n    var activeLink = ref(null);\n    var getContainer = computed(function () {\n      var getContainer = props.getContainer;\n      return getContainer || getTargetContainer.value || getDefaultContainer;\n    }); // func...\n\n    var getCurrentAnchor = function getCurrentAnchor() {\n      var offsetTop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var bounds = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n      var linkSections = [];\n      var container = getContainer.value();\n      state.links.forEach(function (link) {\n        var sharpLinkMatch = sharpMatcherRegx.exec(link.toString());\n\n        if (!sharpLinkMatch) {\n          return;\n        }\n\n        var target = document.getElementById(sharpLinkMatch[1]);\n\n        if (target) {\n          var top = getOffsetTop(target, container);\n\n          if (top < offsetTop + bounds) {\n            linkSections.push({\n              link: link,\n              top: top\n            });\n          }\n        }\n      });\n\n      if (linkSections.length) {\n        var maxSection = linkSections.reduce(function (prev, curr) {\n          return curr.top > prev.top ? curr : prev;\n        });\n        return maxSection.link;\n      }\n\n      return '';\n    };\n\n    var setCurrentActiveLink = function setCurrentActiveLink(link) {\n      var getCurrentAnchor = props.getCurrentAnchor;\n\n      if (activeLink.value === link) {\n        return;\n      }\n\n      activeLink.value = typeof getCurrentAnchor === 'function' ? getCurrentAnchor() : link;\n      emit('change', link);\n    };\n\n    var handleScrollTo = function handleScrollTo(link) {\n      var offsetTop = props.offsetTop,\n          getContainer = props.getContainer,\n          targetOffset = props.targetOffset;\n      setCurrentActiveLink(link);\n      var container = getContainer();\n      var scrollTop = getScroll(container, true);\n      var sharpLinkMatch = sharpMatcherRegx.exec(link);\n\n      if (!sharpLinkMatch) {\n        return;\n      }\n\n      var targetElement = document.getElementById(sharpLinkMatch[1]);\n\n      if (!targetElement) {\n        return;\n      }\n\n      var eleOffsetTop = getOffsetTop(targetElement, container);\n      var y = scrollTop + eleOffsetTop;\n      y -= targetOffset !== undefined ? targetOffset : offsetTop || 0;\n      state.animating = true;\n      scrollTo(y, {\n        callback: function callback() {\n          state.animating = false;\n        },\n        getContainer: getContainer\n      });\n    };\n\n    expose({\n      scrollTo: handleScrollTo\n    });\n\n    var handleScroll = function handleScroll() {\n      if (state.animating) {\n        return;\n      }\n\n      var offsetTop = props.offsetTop,\n          bounds = props.bounds,\n          targetOffset = props.targetOffset;\n      var currentActiveLink = getCurrentAnchor(targetOffset !== undefined ? targetOffset : offsetTop || 0, bounds);\n      setCurrentActiveLink(currentActiveLink);\n    };\n\n    var updateInk = function updateInk() {\n      var linkNode = anchorRef.value.getElementsByClassName(\"\".concat(prefixCls.value, \"-link-title-active\"))[0];\n\n      if (linkNode) {\n        inkNodeRef.value.style.top = \"\".concat(linkNode.offsetTop + linkNode.clientHeight / 2 - 4.5, \"px\");\n      }\n    };\n\n    useProvideAnchor({\n      registerLink: function registerLink(link) {\n        if (!state.links.includes(link)) {\n          state.links.push(link);\n        }\n      },\n      unregisterLink: function unregisterLink(link) {\n        var index = state.links.indexOf(link);\n\n        if (index !== -1) {\n          state.links.splice(index, 1);\n        }\n      },\n      activeLink: activeLink,\n      scrollTo: handleScrollTo,\n      handleClick: function handleClick(e, info) {\n        emit('click', e, info);\n      }\n    });\n    onMounted(function () {\n      nextTick(function () {\n        var container = getContainer.value();\n        state.scrollContainer = container;\n        state.scrollEvent = addEventListener(state.scrollContainer, 'scroll', handleScroll);\n        handleScroll();\n      });\n    });\n    onBeforeUnmount(function () {\n      if (state.scrollEvent) {\n        state.scrollEvent.remove();\n      }\n    });\n    onUpdated(function () {\n      if (state.scrollEvent) {\n        var currentContainer = getContainer.value();\n\n        if (state.scrollContainer !== currentContainer) {\n          state.scrollContainer = currentContainer;\n          state.scrollEvent.remove();\n          state.scrollEvent = addEventListener(state.scrollContainer, 'scroll', handleScroll);\n          handleScroll();\n        }\n      }\n\n      updateInk();\n    });\n    return function () {\n      var _a;\n\n      var offsetTop = props.offsetTop,\n          affix = props.affix,\n          showInkInFixed = props.showInkInFixed;\n      var pre = prefixCls.value;\n      var inkClass = classNames(\"\".concat(pre, \"-ink-ball\"), {\n        visible: activeLink.value\n      });\n      var wrapperClass = classNames(props.wrapperClass, \"\".concat(pre, \"-wrapper\"), _defineProperty({}, \"\".concat(pre, \"-rtl\"), direction.value === 'rtl'));\n      var anchorClass = classNames(pre, {\n        fixed: !affix && !showInkInFixed\n      });\n\n      var wrapperStyle = _extends({\n        maxHeight: offsetTop ? \"calc(100vh - \".concat(offsetTop, \"px)\") : '100vh'\n      }, props.wrapperStyle);\n\n      var anchorContent = _createVNode(\"div\", {\n        \"class\": wrapperClass,\n        \"style\": wrapperStyle,\n        \"ref\": anchorRef\n      }, [_createVNode(\"div\", {\n        \"class\": anchorClass\n      }, [_createVNode(\"div\", {\n        \"class\": \"\".concat(pre, \"-ink\")\n      }, [_createVNode(\"span\", {\n        \"class\": inkClass,\n        \"ref\": inkNodeRef\n      }, null)]), (_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots)])]);\n\n      return !affix ? anchorContent : _createVNode(Affix, _objectSpread(_objectSpread({}, attrs), {}, {\n        \"offsetTop\": offsetTop,\n        \"target\": getContainer.value\n      }), {\n        default: function _default() {\n          return [anchorContent];\n        }\n      });\n    };\n  }\n});","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/node_modules/ant-design-vue/es/anchor/Anchor.js"],"names":["_objectSpread","_extends","_defineProperty","createVNode","_createVNode","defineComponent","nextTick","onBeforeUnmount","onMounted","onUpdated","reactive","ref","computed","PropTypes","classNames","addEventListener","Affix","scrollTo","getScroll","useConfigInject","useProvideAnchor","getDefaultContainer","window","getOffsetTop","element","container","getClientRects","length","rect","getBoundingClientRect","width","height","ownerDocument","documentElement","top","clientTop","sharpMatcherRegx","anchorProps","prefixCls","string","offsetTop","number","bounds","affix","looseBool","def","showInkInFixed","getContainer","func","wrapperClass","wrapperStyle","style","getCurrentAnchor","targetOffset","onChange","onClick","name","inheritAttrs","props","emits","setup","_ref","emit","attrs","slots","expose","_useConfigInject","getTargetContainer","direction","inkNodeRef","anchorRef","state","links","scrollContainer","scrollEvent","animating","activeLink","value","arguments","undefined","linkSections","forEach","link","sharpLinkMatch","exec","toString","target","document","getElementById","push","maxSection","reduce","prev","curr","setCurrentActiveLink","handleScrollTo","scrollTop","targetElement","eleOffsetTop","y","callback","handleScroll","currentActiveLink","updateInk","linkNode","getElementsByClassName","concat","clientHeight","registerLink","includes","unregisterLink","index","indexOf","splice","handleClick","e","info","remove","currentContainer","_a","pre","inkClass","visible","anchorClass","fixed","maxHeight","anchorContent","default","call","_default"],"mappings":"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","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { defineComponent, nextTick, onBeforeUnmount, onMounted, onUpdated, reactive, ref, computed } from 'vue';\nimport PropTypes from '../_util/vue-types';\nimport classNames from '../_util/classNames';\nimport addEventListener from '../vc-util/Dom/addEventListener';\nimport Affix from '../affix';\nimport scrollTo from '../_util/scrollTo';\nimport getScroll from '../_util/getScroll';\nimport useConfigInject from '../_util/hooks/useConfigInject';\nimport useProvideAnchor from './context';\n\nfunction getDefaultContainer() {\n  return window;\n}\n\nfunction getOffsetTop(element, container) {\n  if (!element.getClientRects().length) {\n    return 0;\n  }\n\n  var rect = element.getBoundingClientRect();\n\n  if (rect.width || rect.height) {\n    if (container === window) {\n      container = element.ownerDocument.documentElement;\n      return rect.top - container.clientTop;\n    }\n\n    return rect.top - container.getBoundingClientRect().top;\n  }\n\n  return rect.top;\n}\n\nvar sharpMatcherRegx = /#(\\S+)$/;\nvar anchorProps = {\n  prefixCls: PropTypes.string,\n  offsetTop: PropTypes.number,\n  bounds: PropTypes.number,\n  affix: PropTypes.looseBool.def(true),\n  showInkInFixed: PropTypes.looseBool.def(false),\n  getContainer: PropTypes.func.def(getDefaultContainer),\n  wrapperClass: PropTypes.string,\n  wrapperStyle: PropTypes.style,\n  getCurrentAnchor: PropTypes.func,\n  targetOffset: PropTypes.number,\n  onChange: PropTypes.func,\n  onClick: PropTypes.func\n};\nexport default defineComponent({\n  name: 'AAnchor',\n  inheritAttrs: false,\n  props: anchorProps,\n  emits: ['change', 'click'],\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit,\n        attrs = _ref.attrs,\n        slots = _ref.slots,\n        expose = _ref.expose;\n\n    var _useConfigInject = useConfigInject('anchor', props),\n        prefixCls = _useConfigInject.prefixCls,\n        getTargetContainer = _useConfigInject.getTargetContainer,\n        direction = _useConfigInject.direction;\n\n    var inkNodeRef = ref();\n    var anchorRef = ref();\n    var state = reactive({\n      links: [],\n      scrollContainer: null,\n      scrollEvent: null,\n      animating: false\n    });\n    var activeLink = ref(null);\n    var getContainer = computed(function () {\n      var getContainer = props.getContainer;\n      return getContainer || getTargetContainer.value || getDefaultContainer;\n    }); // func...\n\n    var getCurrentAnchor = function getCurrentAnchor() {\n      var offsetTop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var bounds = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n      var linkSections = [];\n      var container = getContainer.value();\n      state.links.forEach(function (link) {\n        var sharpLinkMatch = sharpMatcherRegx.exec(link.toString());\n\n        if (!sharpLinkMatch) {\n          return;\n        }\n\n        var target = document.getElementById(sharpLinkMatch[1]);\n\n        if (target) {\n          var top = getOffsetTop(target, container);\n\n          if (top < offsetTop + bounds) {\n            linkSections.push({\n              link: link,\n              top: top\n            });\n          }\n        }\n      });\n\n      if (linkSections.length) {\n        var maxSection = linkSections.reduce(function (prev, curr) {\n          return curr.top > prev.top ? curr : prev;\n        });\n        return maxSection.link;\n      }\n\n      return '';\n    };\n\n    var setCurrentActiveLink = function setCurrentActiveLink(link) {\n      var getCurrentAnchor = props.getCurrentAnchor;\n\n      if (activeLink.value === link) {\n        return;\n      }\n\n      activeLink.value = typeof getCurrentAnchor === 'function' ? getCurrentAnchor() : link;\n      emit('change', link);\n    };\n\n    var handleScrollTo = function handleScrollTo(link) {\n      var offsetTop = props.offsetTop,\n          getContainer = props.getContainer,\n          targetOffset = props.targetOffset;\n      setCurrentActiveLink(link);\n      var container = getContainer();\n      var scrollTop = getScroll(container, true);\n      var sharpLinkMatch = sharpMatcherRegx.exec(link);\n\n      if (!sharpLinkMatch) {\n        return;\n      }\n\n      var targetElement = document.getElementById(sharpLinkMatch[1]);\n\n      if (!targetElement) {\n        return;\n      }\n\n      var eleOffsetTop = getOffsetTop(targetElement, container);\n      var y = scrollTop + eleOffsetTop;\n      y -= targetOffset !== undefined ? targetOffset : offsetTop || 0;\n      state.animating = true;\n      scrollTo(y, {\n        callback: function callback() {\n          state.animating = false;\n        },\n        getContainer: getContainer\n      });\n    };\n\n    expose({\n      scrollTo: handleScrollTo\n    });\n\n    var handleScroll = function handleScroll() {\n      if (state.animating) {\n        return;\n      }\n\n      var offsetTop = props.offsetTop,\n          bounds = props.bounds,\n          targetOffset = props.targetOffset;\n      var currentActiveLink = getCurrentAnchor(targetOffset !== undefined ? targetOffset : offsetTop || 0, bounds);\n      setCurrentActiveLink(currentActiveLink);\n    };\n\n    var updateInk = function updateInk() {\n      var linkNode = anchorRef.value.getElementsByClassName(\"\".concat(prefixCls.value, \"-link-title-active\"))[0];\n\n      if (linkNode) {\n        inkNodeRef.value.style.top = \"\".concat(linkNode.offsetTop + linkNode.clientHeight / 2 - 4.5, \"px\");\n      }\n    };\n\n    useProvideAnchor({\n      registerLink: function registerLink(link) {\n        if (!state.links.includes(link)) {\n          state.links.push(link);\n        }\n      },\n      unregisterLink: function unregisterLink(link) {\n        var index = state.links.indexOf(link);\n\n        if (index !== -1) {\n          state.links.splice(index, 1);\n        }\n      },\n      activeLink: activeLink,\n      scrollTo: handleScrollTo,\n      handleClick: function handleClick(e, info) {\n        emit('click', e, info);\n      }\n    });\n    onMounted(function () {\n      nextTick(function () {\n        var container = getContainer.value();\n        state.scrollContainer = container;\n        state.scrollEvent = addEventListener(state.scrollContainer, 'scroll', handleScroll);\n        handleScroll();\n      });\n    });\n    onBeforeUnmount(function () {\n      if (state.scrollEvent) {\n        state.scrollEvent.remove();\n      }\n    });\n    onUpdated(function () {\n      if (state.scrollEvent) {\n        var currentContainer = getContainer.value();\n\n        if (state.scrollContainer !== currentContainer) {\n          state.scrollContainer = currentContainer;\n          state.scrollEvent.remove();\n          state.scrollEvent = addEventListener(state.scrollContainer, 'scroll', handleScroll);\n          handleScroll();\n        }\n      }\n\n      updateInk();\n    });\n    return function () {\n      var _a;\n\n      var offsetTop = props.offsetTop,\n          affix = props.affix,\n          showInkInFixed = props.showInkInFixed;\n      var pre = prefixCls.value;\n      var inkClass = classNames(\"\".concat(pre, \"-ink-ball\"), {\n        visible: activeLink.value\n      });\n      var wrapperClass = classNames(props.wrapperClass, \"\".concat(pre, \"-wrapper\"), _defineProperty({}, \"\".concat(pre, \"-rtl\"), direction.value === 'rtl'));\n      var anchorClass = classNames(pre, {\n        fixed: !affix && !showInkInFixed\n      });\n\n      var wrapperStyle = _extends({\n        maxHeight: offsetTop ? \"calc(100vh - \".concat(offsetTop, \"px)\") : '100vh'\n      }, props.wrapperStyle);\n\n      var anchorContent = _createVNode(\"div\", {\n        \"class\": wrapperClass,\n        \"style\": wrapperStyle,\n        \"ref\": anchorRef\n      }, [_createVNode(\"div\", {\n        \"class\": anchorClass\n      }, [_createVNode(\"div\", {\n        \"class\": \"\".concat(pre, \"-ink\")\n      }, [_createVNode(\"span\", {\n        \"class\": inkClass,\n        \"ref\": inkNodeRef\n      }, null)]), (_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots)])]);\n\n      return !affix ? anchorContent : _createVNode(Affix, _objectSpread(_objectSpread({}, attrs), {}, {\n        \"offsetTop\": offsetTop,\n        \"target\": getContainer.value\n      }), {\n        default: function _default() {\n          return [anchorContent];\n        }\n      });\n    };\n  }\n});"]},"metadata":{},"sourceType":"module"}