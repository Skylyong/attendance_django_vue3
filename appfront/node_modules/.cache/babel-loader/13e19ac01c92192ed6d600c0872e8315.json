{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport { ref, reactive, computed, defineComponent } from \"vue\";\nimport { clamp, isDef, numericProp, preventDefault, callInterceptor, createNamespace, makeNumericProp } from \"../utils\";\nimport { useRect, useClickAway } from \"@vant/use\";\nimport { useTouch } from \"../composables/use-touch\";\nimport { useExpose } from \"../composables/use-expose\";\nconst [name, bem] = createNamespace(\"swipe-cell\");\nconst swipeCellProps = {\n  name: makeNumericProp(\"\"),\n  disabled: Boolean,\n  leftWidth: numericProp,\n  rightWidth: numericProp,\n  beforeClose: Function,\n  stopPropagation: Boolean\n};\nvar stdin_default = defineComponent({\n  name,\n  props: swipeCellProps,\n  emits: [\"open\", \"close\", \"click\"],\n\n  setup(props, {\n    emit,\n    slots\n  }) {\n    let opened;\n    let lockClick;\n    let startOffset;\n    const root = ref();\n    const leftRef = ref();\n    const rightRef = ref();\n    const state = reactive({\n      offset: 0,\n      dragging: false\n    });\n    const touch = useTouch();\n\n    const getWidthByRef = ref2 => ref2.value ? useRect(ref2).width : 0;\n\n    const leftWidth = computed(() => isDef(props.leftWidth) ? +props.leftWidth : getWidthByRef(leftRef));\n    const rightWidth = computed(() => isDef(props.rightWidth) ? +props.rightWidth : getWidthByRef(rightRef));\n\n    const open = side => {\n      state.offset = side === \"left\" ? leftWidth.value : -rightWidth.value;\n\n      if (!opened) {\n        opened = true;\n        emit(\"open\", {\n          name: props.name,\n          position: side\n        });\n      }\n    };\n\n    const close = position => {\n      state.offset = 0;\n\n      if (opened) {\n        opened = false;\n        emit(\"close\", {\n          name: props.name,\n          position\n        });\n      }\n    };\n\n    const toggle = side => {\n      const offset = Math.abs(state.offset);\n      const THRESHOLD = 0.15;\n      const threshold = opened ? 1 - THRESHOLD : THRESHOLD;\n      const width = side === \"left\" ? leftWidth.value : rightWidth.value;\n\n      if (width && offset > width * threshold) {\n        open(side);\n      } else {\n        close(side);\n      }\n    };\n\n    const onTouchStart = event => {\n      if (!props.disabled) {\n        startOffset = state.offset;\n        touch.start(event);\n      }\n    };\n\n    const onTouchMove = event => {\n      if (props.disabled) {\n        return;\n      }\n\n      const {\n        deltaX\n      } = touch;\n      touch.move(event);\n\n      if (touch.isHorizontal()) {\n        lockClick = true;\n        state.dragging = true;\n        const isEdge = !opened || deltaX.value * startOffset < 0;\n\n        if (isEdge) {\n          preventDefault(event, props.stopPropagation);\n        }\n\n        state.offset = clamp(deltaX.value + startOffset, -rightWidth.value, leftWidth.value);\n      }\n    };\n\n    const onTouchEnd = () => {\n      if (state.dragging) {\n        state.dragging = false;\n        toggle(state.offset > 0 ? \"left\" : \"right\");\n        setTimeout(() => {\n          lockClick = false;\n        }, 0);\n      }\n    };\n\n    const onClick = (position = \"outside\") => {\n      emit(\"click\", position);\n\n      if (opened && !lockClick) {\n        callInterceptor(props.beforeClose, {\n          args: [{\n            name: props.name,\n            position\n          }],\n          done: () => close(position)\n        });\n      }\n    };\n\n    const getClickHandler = (position, stop) => event => {\n      if (stop) {\n        event.stopPropagation();\n      }\n\n      onClick(position);\n    };\n\n    const renderSideContent = (side, ref2) => {\n      const contentSlot = slots[side];\n\n      if (contentSlot) {\n        return _createVNode(\"div\", {\n          \"ref\": ref2,\n          \"class\": bem(side),\n          \"onClick\": getClickHandler(side, true)\n        }, [contentSlot()]);\n      }\n    };\n\n    useExpose({\n      open,\n      close\n    });\n    useClickAway(root, () => onClick(\"outside\"), {\n      eventName: \"touchstart\"\n    });\n    return () => {\n      var _a;\n\n      const wrapperStyle = {\n        transform: `translate3d(${state.offset}px, 0, 0)`,\n        transitionDuration: state.dragging ? \"0s\" : \".6s\"\n      };\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"class\": bem(),\n        \"onClick\": getClickHandler(\"cell\"),\n        \"onTouchstart\": onTouchStart,\n        \"onTouchmove\": onTouchMove,\n        \"onTouchend\": onTouchEnd,\n        \"onTouchcancel\": onTouchEnd\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"wrapper\"),\n        \"style\": wrapperStyle\n      }, [renderSideContent(\"left\", leftRef), (_a = slots.default) == null ? void 0 : _a.call(slots), renderSideContent(\"right\", rightRef)])]);\n    };\n  }\n\n});\nexport { stdin_default as default };","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/vant/es/swipe-cell/SwipeCell.js"],"names":["createVNode","_createVNode","ref","reactive","computed","defineComponent","clamp","isDef","numericProp","preventDefault","callInterceptor","createNamespace","makeNumericProp","useRect","useClickAway","useTouch","useExpose","name","bem","swipeCellProps","disabled","Boolean","leftWidth","rightWidth","beforeClose","Function","stopPropagation","stdin_default","props","emits","setup","emit","slots","opened","lockClick","startOffset","root","leftRef","rightRef","state","offset","dragging","touch","getWidthByRef","ref2","value","width","open","side","position","close","toggle","Math","abs","THRESHOLD","threshold","onTouchStart","event","start","onTouchMove","deltaX","move","isHorizontal","isEdge","onTouchEnd","setTimeout","onClick","args","done","getClickHandler","stop","renderSideContent","contentSlot","eventName","_a","wrapperStyle","transform","transitionDuration","default","call"],"mappings":"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","sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { ref, reactive, computed, defineComponent } from \"vue\";\nimport { clamp, isDef, numericProp, preventDefault, callInterceptor, createNamespace, makeNumericProp } from \"../utils\";\nimport { useRect, useClickAway } from \"@vant/use\";\nimport { useTouch } from \"../composables/use-touch\";\nimport { useExpose } from \"../composables/use-expose\";\nconst [name, bem] = createNamespace(\"swipe-cell\");\nconst swipeCellProps = {\n  name: makeNumericProp(\"\"),\n  disabled: Boolean,\n  leftWidth: numericProp,\n  rightWidth: numericProp,\n  beforeClose: Function,\n  stopPropagation: Boolean\n};\nvar stdin_default = defineComponent({\n  name,\n  props: swipeCellProps,\n  emits: [\"open\", \"close\", \"click\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    let opened;\n    let lockClick;\n    let startOffset;\n    const root = ref();\n    const leftRef = ref();\n    const rightRef = ref();\n    const state = reactive({\n      offset: 0,\n      dragging: false\n    });\n    const touch = useTouch();\n    const getWidthByRef = (ref2) => ref2.value ? useRect(ref2).width : 0;\n    const leftWidth = computed(() => isDef(props.leftWidth) ? +props.leftWidth : getWidthByRef(leftRef));\n    const rightWidth = computed(() => isDef(props.rightWidth) ? +props.rightWidth : getWidthByRef(rightRef));\n    const open = (side) => {\n      state.offset = side === \"left\" ? leftWidth.value : -rightWidth.value;\n      if (!opened) {\n        opened = true;\n        emit(\"open\", {\n          name: props.name,\n          position: side\n        });\n      }\n    };\n    const close = (position) => {\n      state.offset = 0;\n      if (opened) {\n        opened = false;\n        emit(\"close\", {\n          name: props.name,\n          position\n        });\n      }\n    };\n    const toggle = (side) => {\n      const offset = Math.abs(state.offset);\n      const THRESHOLD = 0.15;\n      const threshold = opened ? 1 - THRESHOLD : THRESHOLD;\n      const width = side === \"left\" ? leftWidth.value : rightWidth.value;\n      if (width && offset > width * threshold) {\n        open(side);\n      } else {\n        close(side);\n      }\n    };\n    const onTouchStart = (event) => {\n      if (!props.disabled) {\n        startOffset = state.offset;\n        touch.start(event);\n      }\n    };\n    const onTouchMove = (event) => {\n      if (props.disabled) {\n        return;\n      }\n      const {\n        deltaX\n      } = touch;\n      touch.move(event);\n      if (touch.isHorizontal()) {\n        lockClick = true;\n        state.dragging = true;\n        const isEdge = !opened || deltaX.value * startOffset < 0;\n        if (isEdge) {\n          preventDefault(event, props.stopPropagation);\n        }\n        state.offset = clamp(deltaX.value + startOffset, -rightWidth.value, leftWidth.value);\n      }\n    };\n    const onTouchEnd = () => {\n      if (state.dragging) {\n        state.dragging = false;\n        toggle(state.offset > 0 ? \"left\" : \"right\");\n        setTimeout(() => {\n          lockClick = false;\n        }, 0);\n      }\n    };\n    const onClick = (position = \"outside\") => {\n      emit(\"click\", position);\n      if (opened && !lockClick) {\n        callInterceptor(props.beforeClose, {\n          args: [{\n            name: props.name,\n            position\n          }],\n          done: () => close(position)\n        });\n      }\n    };\n    const getClickHandler = (position, stop) => (event) => {\n      if (stop) {\n        event.stopPropagation();\n      }\n      onClick(position);\n    };\n    const renderSideContent = (side, ref2) => {\n      const contentSlot = slots[side];\n      if (contentSlot) {\n        return _createVNode(\"div\", {\n          \"ref\": ref2,\n          \"class\": bem(side),\n          \"onClick\": getClickHandler(side, true)\n        }, [contentSlot()]);\n      }\n    };\n    useExpose({\n      open,\n      close\n    });\n    useClickAway(root, () => onClick(\"outside\"), {\n      eventName: \"touchstart\"\n    });\n    return () => {\n      var _a;\n      const wrapperStyle = {\n        transform: `translate3d(${state.offset}px, 0, 0)`,\n        transitionDuration: state.dragging ? \"0s\" : \".6s\"\n      };\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"class\": bem(),\n        \"onClick\": getClickHandler(\"cell\"),\n        \"onTouchstart\": onTouchStart,\n        \"onTouchmove\": onTouchMove,\n        \"onTouchend\": onTouchEnd,\n        \"onTouchcancel\": onTouchEnd\n      }, [_createVNode(\"div\", {\n        \"class\": bem(\"wrapper\"),\n        \"style\": wrapperStyle\n      }, [renderSideContent(\"left\", leftRef), (_a = slots.default) == null ? void 0 : _a.call(slots), renderSideContent(\"right\", rightRef)])]);\n    };\n  }\n});\nexport {\n  stdin_default as default\n};\n"]},"metadata":{},"sourceType":"module"}