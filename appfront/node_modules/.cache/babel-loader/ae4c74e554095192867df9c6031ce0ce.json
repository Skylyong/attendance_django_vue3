{"ast":null,"code":"import { usePagination } from \"vue-request\";\nimport { getworkerApplyHistory, delApplication } from \"../../api/api.js\";\nimport { computed, defineComponent, ref, reactive } from \"vue\";\nimport { cloneDeep } from \"lodash-es\";\nimport axios from \"axios\";\nimport { CheckOutlined, EditOutlined } from \"@ant-design/icons-vue\";\nimport { message } from \"ant-design-vue\";\nconst columns = [{\n  title: \"序号\",\n  dataIndex: \"id\",\n  width: \"8%\",\n  sorter: (a, b) => a.id - b.id\n}, {\n  title: \"申请时间\",\n  dataIndex: \"applyTime\",\n  width: \"8%\",\n  sorter: (a, b) => a.id - b.id\n}, {\n  title: \"开始时间\",\n  dataIndex: \"applyStartTime\",\n  sorter: true,\n  width: \"8%\",\n  sorter: (a, b) => a.applyStartTime - b.applyStartTime\n}, {\n  title: \"结束时间\",\n  dataIndex: \"applyEndTime\",\n  sorter: true,\n  width: \"8%\",\n  sorter: (a, b) => a.applyEndTime - b.applyEndTime\n}, {\n  title: \"申请时长\",\n  dataIndex: \"applyTimeLast\",\n  sorter: true,\n  width: \"8%\",\n  sorter: (a, b) => a.timeLast - b.timeLast\n}, {\n  title: \"休假状态\",\n  dataIndex: \"applyType\",\n  filters: [{\n    text: \"公休\",\n    value: \"公休\"\n  }, {\n    text: \"值班加班\",\n    value: \"值班加班\"\n  }],\n  onFilter: (value, record) => record.applyType.indexOf(value) === 0,\n  sorter: (a, b) => a.applyType.length - b.applyType.length,\n  width: \"12%\"\n}, {\n  title: \"假期种类\",\n  dataIndex: \"holidayType\",\n  filters: [{\n    text: \"公休请假\",\n    value: \"公休请假\"\n  }, {\n    text: \"加班换积休\",\n    value: \"加班换积休\"\n  }, {\n    text: \"值班换积休\",\n    value: \"值班换积休\"\n  }],\n  onFilter: (value, record) => record.holidayType.indexOf(value) === 0,\n  sorter: (a, b) => a.holidayType.length - b.holidayType.length,\n  width: \"12%\"\n}, {\n  title: \"申请原因\",\n  dataIndex: \"applyReason\",\n  width: \"20%\",\n  sorter: (a, b) => a.applyReason.length - b.applyReason.length\n}, {\n  title: \"审批状态\",\n  dataIndex: \"approveState\",\n  sorter: (a, b) => a.approveState.length - b.approveState.length,\n  onFilter: (value, record) => record.approveState.indexOf(value) === 0,\n  width: \"8%\",\n  filters: [{\n    text: \"通过\",\n    value: \"通过\"\n  }, {\n    text: \"不通过\",\n    value: \"不通过\"\n  }, {\n    text: \"未审批\",\n    value: \"未审批\"\n  }]\n}, {\n  title: \"批注\",\n  dataIndex: \"approveNote\",\n  sorter: true,\n  width: \"10%\",\n  sorter: (a, b) => a.applyReason.length - b.applyReason.length\n}, {\n  title: \"操作\",\n  dataIndex: \"operation\",\n  slots: {\n    customRender: \"operation\"\n  }\n}];\nexport default defineComponent({\n  components: {\n    CheckOutlined,\n    EditOutlined\n  },\n\n  setup() {\n    const handleTableChange = (pag, filters, sorter) => {\n      run({\n        results: pag.pageSize,\n        page: pag?.current,\n        sortField: sorter.field,\n        sortOrder: sorter.order,\n        ...filters\n      });\n    };\n\n    const editableData = reactive({});\n\n    const edit = key => {\n      editableData[key] = cloneDeep(dataSource.value.filter(item => key === item.key)[0]);\n    };\n\n    let dataSource = ref();\n    let getid = localStorage.getItem(\"Userid\");\n    getworkerApplyHistory(getid).then(response => {\n      if (response[\"code\"] == 1) {\n        console.log(response[\"data\"]);\n        dataSource.value = response[\"data\"];\n      }\n    });\n\n    const save = key => {\n      Object.assign(dataSource.value.filter(item => key === item.key)[0], editableData[key]);\n      delete editableData[key];\n    };\n\n    const onDelete = key => {\n      delApplication(getid, key).then(response => {\n        if (1 === response[\"code\"]) {\n          dataSource.value = dataSource.value.filter(item => item.applyTime !== key);\n          message.success(\"从服务器删除成功！\");\n          getworkerApplyHistory(getid).then(response => {\n            if (response[\"code\"] == 1) {\n              console.log(response[\"data\"]);\n              dataSource.value = response[\"data\"];\n            }\n          });\n        } else {\n          message.error(\"服务端删除失败！\");\n        }\n      }, response => {\n        message.error(\"服务端删除失败！\");\n      });\n    };\n\n    return {\n      dataSource,\n      editableData,\n      save,\n      onDelete,\n      columns,\n      handleTableChange\n    };\n  }\n\n});","map":{"version":3,"mappings":"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","names":["usePagination","getworkerApplyHistory","delApplication","computed","defineComponent","ref","reactive","cloneDeep","axios","CheckOutlined","EditOutlined","message","columns","title","dataIndex","width","sorter","a","b","id","applyStartTime","applyEndTime","timeLast","filters","text","value","onFilter","record","applyType","indexOf","length","holidayType","applyReason","approveState","slots","customRender","components","setup","handleTableChange","pag","run","results","pageSize","page","current","sortField","field","sortOrder","order","editableData","edit","key","dataSource","filter","item","getid","localStorage","getItem","then","response","console","log","save","Object","assign","onDelete","applyTime","success","error"],"sourceRoot":"","sources":["/Users/lyong/Desktop/myproj/appfront/src/components/worker/workerApplyHistory.vue"],"sourcesContent":["<template>\n  <!-- <a-button class=\"editable-add-btn\" style=\"margin-bottom: 8px\" @click=\"handleAdd\">Add</a-button> -->\n  <a-table\n    bordered\n    :data-source=\"dataSource\"\n    :columns=\"columns\"\n    :@handleTableChange=\"handleTableChange\"\n  >\n    <template #operation=\"{ record }\">\n      <a-popconfirm\n        v-if=\"dataSource.length && record.approveState == '未审批'\"\n        title=\"确定删除吗?\"\n        @confirm=\"onDelete(record.applyTime)\"\n      >\n        <a>删除</a>\n      </a-popconfirm>\n    </template>\n  </a-table>\n</template>\n\n<script>\nimport { usePagination } from \"vue-request\";\nimport { getworkerApplyHistory, delApplication } from \"../../api/api.js\";\nimport { computed, defineComponent, ref, reactive } from \"vue\";\nimport { cloneDeep } from \"lodash-es\";\nimport axios from \"axios\";\nimport { CheckOutlined, EditOutlined } from \"@ant-design/icons-vue\";\nimport { message } from \"ant-design-vue\";\nconst columns = [\n  {\n    title: \"序号\",\n    dataIndex: \"id\",\n    width: \"8%\",\n    sorter: (a, b) => a.id - b.id,\n  },\n  {\n    title: \"申请时间\",\n    dataIndex: \"applyTime\",\n    width: \"8%\",\n    sorter: (a, b) => a.id - b.id,\n  },\n\n  {\n    title: \"开始时间\",\n    dataIndex: \"applyStartTime\",\n    sorter: true,\n    width: \"8%\",\n    sorter: (a, b) => a.applyStartTime - b.applyStartTime,\n  },\n  {\n    title: \"结束时间\",\n    dataIndex: \"applyEndTime\",\n    sorter: true,\n    width: \"8%\",\n    sorter: (a, b) => a.applyEndTime - b.applyEndTime,\n  },\n  {\n    title: \"申请时长\",\n    dataIndex: \"applyTimeLast\",\n    sorter: true,\n    width: \"8%\",\n    sorter: (a, b) => a.timeLast - b.timeLast,\n  },\n  {\n    title: \"休假状态\",\n    dataIndex: \"applyType\",\n    filters: [\n      {\n        text: \"公休\",\n        value: \"公休\",\n      },\n      {\n        text: \"值班加班\",\n        value: \"值班加班\",\n      },\n    ],\n    onFilter: (value, record) => record.applyType.indexOf(value) === 0,\n    sorter: (a, b) => a.applyType.length - b.applyType.length,\n    width: \"12%\",\n  },\n  {\n    title: \"假期种类\",\n    dataIndex: \"holidayType\",\n    filters: [\n      {\n        text: \"公休请假\",\n        value: \"公休请假\",\n      },\n      {\n        text: \"加班换积休\",\n        value: \"加班换积休\",\n      },\n      {\n        text: \"值班换积休\",\n        value: \"值班换积休\",\n      },\n    ],\n    onFilter: (value, record) => record.holidayType.indexOf(value) === 0,\n    sorter: (a, b) => a.holidayType.length - b.holidayType.length,\n    width: \"12%\",\n  },\n  {\n    title: \"申请原因\",\n    dataIndex: \"applyReason\",\n    width: \"20%\",\n    sorter: (a, b) => a.applyReason.length - b.applyReason.length,\n  },\n  {\n    title: \"审批状态\",\n    dataIndex: \"approveState\",\n    sorter: (a, b) => a.approveState.length - b.approveState.length,\n    onFilter: (value, record) => record.approveState.indexOf(value) === 0,\n    width: \"8%\",\n    filters: [\n      {\n        text: \"通过\",\n        value: \"通过\",\n      },\n      {\n        text: \"不通过\",\n        value: \"不通过\",\n      },\n      {\n        text: \"未审批\",\n        value: \"未审批\",\n      },\n    ],\n  },\n  {\n    title: \"批注\",\n    dataIndex: \"approveNote\",\n    sorter: true,\n    width: \"10%\",\n    sorter: (a, b) => a.applyReason.length - b.applyReason.length,\n  },\n\n  {\n    title: \"操作\",\n    dataIndex: \"operation\",\n    slots: {\n      customRender: \"operation\",\n    },\n  },\n];\n\nexport default defineComponent({\n  components: {\n    CheckOutlined,\n    EditOutlined,\n  },\n  setup() {\n    const handleTableChange = (pag, filters, sorter) => {\n      run({\n        results: pag.pageSize,\n        page: pag?.current,\n        sortField: sorter.field,\n        sortOrder: sorter.order,\n        ...filters,\n      });\n    };\n    const editableData = reactive({});\n    const edit = (key) => {\n      editableData[key] = cloneDeep(\n        dataSource.value.filter((item) => key === item.key)[0]\n      );\n    };\n\n    let dataSource = ref();\n\n    let getid = localStorage.getItem(\"Userid\");\n    getworkerApplyHistory(getid).then((response) => {\n      if (response[\"code\"] == 1) {\n        console.log(response[\"data\"]);\n        dataSource.value = response[\"data\"];\n      }\n    });\n    const save = (key) => {\n      Object.assign(\n        dataSource.value.filter((item) => key === item.key)[0],\n        editableData[key]\n      );\n      delete editableData[key];\n    };\n    const onDelete = (key) => {\n      delApplication(getid, key).then(\n        (response) => {\n          if (1 === response[\"code\"]) {\n            dataSource.value = dataSource.value.filter(\n              (item) => item.applyTime !== key\n            );\n            message.success(\"从服务器删除成功！\");\n            getworkerApplyHistory(getid).then((response) => {\n              if (response[\"code\"] == 1) {\n                console.log(response[\"data\"]);\n                dataSource.value = response[\"data\"];\n              }\n            });\n          } else {\n            message.error(\"服务端删除失败！\");\n          }\n        },\n        (response) => {\n          message.error(\"服务端删除失败！\");\n        }\n      );\n    };\n\n    return {\n      dataSource,\n      editableData,\n      save,\n      onDelete,\n\n      columns,\n      handleTableChange,\n    };\n  },\n});\n</script>\n\n\n<style lang=\"less\">\n.editable-cell {\n  position: relative;\n  .editable-cell-input-wrapper,\n  .editable-cell-text-wrapper {\n    padding-right: 24px;\n  }\n\n  .editable-cell-text-wrapper {\n    padding: 5px 24px 5px 5px;\n  }\n\n  .editable-cell-icon,\n  .editable-cell-icon-check {\n    position: absolute;\n    right: 0;\n    width: 20px;\n    cursor: pointer;\n  }\n\n  .editable-cell-icon {\n    margin-top: 4px;\n    display: none;\n  }\n\n  .editable-cell-icon-check {\n    line-height: 28px;\n  }\n\n  .editable-cell-icon:hover,\n  .editable-cell-icon-check:hover {\n    color: #108ee9;\n  }\n\n  .editable-add-btn {\n    margin-bottom: 8px;\n  }\n}\n.editable-cell:hover .editable-cell-icon {\n  display: inline-block;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}