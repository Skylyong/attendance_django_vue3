{"ast":null,"code":"import { getworkerApplyHistory } from '../../api/api.js';\nimport { computed, defineComponent, reactive, ref } from 'vue';\nimport { CheckOutlined, EditOutlined } from '@ant-design/icons-vue';\nimport { cloneDeep } from 'lodash-es';\nimport { message } from 'ant-design-vue';\nexport default defineComponent({\n  components: {\n    CheckOutlined,\n    EditOutlined\n  },\n\n  setup() {\n    const options = ref([{\n      value: '1',\n      label: '通过'\n    }, {\n      value: '2',\n      label: '不通过'\n    }]);\n    const columns = [{\n      title: '工号',\n      dataIndex: 'userId',\n      width: '5%',\n      sorter: (a, b) => a.length - b.length\n    }, {\n      title: '姓名',\n      dataIndex: 'name',\n      width: '8%' // sorter: (a, b) => a.length - b.length,\n\n    }, {\n      title: '开始时间',\n      dataIndex: 'applyStartTime',\n      // sorter: true,\n      width: '8%' // sorter: (a, b) => a.applyStartTime - b.applyStartTime,\n\n    }, {\n      title: '结束时间',\n      dataIndex: 'applyEndTime',\n      // sorter: true,\n      width: '8%' // sorter: (a, b) => a.applyEndTime - b.applyEndTime,\n\n    }, {\n      title: '申请类型',\n      dataIndex: 'applyType',\n      // filters: [{\n      //   text: '公休',\n      //   value: '公休',\n      // }, {\n      //   text: '值班加班',\n      //   value: '值班加班',\n      // }\n      // ],\n      // onFilter: (value, record) => record.applyType.indexOf(value) === 0,\n      // sorter: (a, b) => a.applyType.length - b.applyType.length,\n      width: '8%'\n    }, {\n      title: '假期种类',\n      dataIndex: 'holidayType',\n      // filters: [{\n      //   text: '公休请假',\n      //   value: '公休请假',\n      // }, {\n      //   text: '加班换积休',\n      //   value: '加班换积休',\n      // },\n      // {\n      //   text: '值班换积休',\n      //   value: '值班换积休',\n      // }\n      // ],\n      // onFilter: (value, record) => record.holidayType.indexOf(value) === 0,\n      // sorter: (a, b) => a.holidayType.length - b.holidayType.length,\n      width: '8%'\n    }, {\n      title: '申请原因',\n      dataIndex: 'applyReason',\n      width: '15%' // sorter: (a, b) => a.applyReason.length - b.applyReason.length,\n\n    }, {\n      title: '填写批注',\n      dataIndex: 'approveNote',\n      // sorter: true,\n      width: '20%',\n      slots: {\n        customRender: 'approveNote'\n      }\n    }, {\n      title: '审批结果',\n      dataIndex: 'approveState',\n      // sorter: (a, b) => a.approveState.length - b.approveState.length,\n      // onFilter: (value, record) => record.approveState.indexOf(value) === 0,\n      width: '8%',\n      slots: {\n        customRender: 'approveState'\n      } //   filters: [{\n      //   text: '通过',\n      //   value: '通过',\n      // }, {\n      //   text: '不通过',\n      //   value: '不通过',\n      // },{\n      //   text: '未审批',\n      // //   value: '未审批',\n      // },\n      // ],\n\n    } // {\n    //         title: '操作',\n    //         dataIndex: 'operation',\n    //         slots: {\n    //           customRender: 'operation',\n    //         },\n    //       },\n    ];\n    const dataSource = ref();\n    let getid = localStorage.getItem(\"Userid\");\n    getworkerApplyHistory(getid).then(response => {\n      message.success(getid + 'aaaaa:' + response['code']);\n\n      if (response['code'] == 2004) {\n        dataSource.value = response['data'];\n        console.log(dataSource);\n      }\n    });\n    const count = computed(() => dataSource.value.length + 1);\n    const editableData = reactive({});\n\n    const edit = key => {\n      editableData[key] = cloneDeep(dataSource.value.filter(item => key === item.key)[0]);\n      message.success(editableData);\n    };\n\n    const save = key => {\n      Object.assign(dataSource.value.filter(item => key === item.key)[0], editableData[key]);\n      delete editableData[key];\n    };\n\n    const save_server = key => {\n      Object.assign(dataSource.value.filter(item => key === item.key)[0], editableData[key]);\n      delete editableData[key];\n    };\n\n    const onDelete = key => {\n      dataSource.value = dataSource.value.filter(item => item.key !== key);\n    };\n\n    const handleAdd = () => {\n      const newData = {\n        key: `${count.value}`,\n        name: `Edward King ${count.value}`,\n        age: 32,\n        address: `London, Park Lane no. ${count.value}`\n      };\n      dataSource.value.push(newData);\n    };\n\n    return {\n      getworkerApplyHistory,\n      options,\n      columns,\n      onDelete,\n      handleAdd,\n      dataSource,\n      editableData,\n      count,\n      edit,\n      save,\n      save_server\n    };\n  }\n\n});","map":{"version":3,"mappings":"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","names":["getworkerApplyHistory","computed","defineComponent","reactive","ref","CheckOutlined","EditOutlined","cloneDeep","message","components","setup","options","value","label","columns","title","dataIndex","width","sorter","a","b","length","slots","customRender","dataSource","getid","localStorage","getItem","then","response","success","console","log","count","editableData","edit","key","filter","item","save","Object","assign","save_server","onDelete","handleAdd","newData","name","age","address","push"],"sourceRoot":"","sources":["/Users/lyong/Desktop/myproj/appfront/src/components/manager/managerApprove.vue"],"sourcesContent":["<template>\n  <a-button class=\"editable-add-btn\" @click=\"handleAdd\" style=\"margin-bottom: 8px\">Add</a-button>\n  <a-table bordered :data-source=\"dataSource\" :columns=\"columns\">\n    <template #approveNote=\"{ text, record }\">\n      <div class=\"editable-cell\">\n        <div v-if=\"editableData[record.key]\" class=\"editable-cell-input-wrapper\">\n          <a-input  v-model:value=\"editableData[record.key].approveNote\" @pressEnter=\"save(record.key)\" />\n          <!-- <check-outlined class=\"editable-cell-icon-check\" @click=\"save(record.key)\" />    -->\n      </div>\n        <div v-else class=\"editable-cell-text-wrapper\">\n          {{ text || ' ' }}\n          <edit-outlined class=\"editable-cell-icon\" @click=\"edit(record.key)\" />\n        </div>\n      </div>\n    </template>\n\n\n   <template #approveState=\"{record }\">\n      <div class=\"editable-cell\">\n        <div v-if=\"editableData[record.key]\" class=\"editable-cell-input-wrapper\">\n        <a-select\n            v-model:value=\"editableData[record.key].approveState\"\n            label-in-value\n            style=\"width: 120px\"\n            :options=\"options\"\n            @pressEnter=\"save(record.key)\"\n          >\n          </a-select>\n          <check-outlined class=\"editable-cell-icon-check\" @click=\"save_server(record.key)\" />     \n      </div>\n        <div v-else class=\"editable-cell-text-wrapper\">\n          {{ record.approveState || ' ' }}\n          <edit-outlined class=\"editable-cell-icon\" @click=\"edit(record.key)\" />\n        </div> \n      </div> \n    </template>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    <template #operation=\"{ record }\">\n      <a-popconfirm\n        v-if=\"dataSource.length\"\n        title=\"Sure to delete?\"\n        @confirm=\"onDelete(record.key)\"\n      >\n        <a>Delete</a>\n      </a-popconfirm>\n    </template>\n  </a-table>\n</template>\n<script>\nimport{getworkerApplyHistory,} from '../../api/api.js'\nimport { computed, defineComponent, reactive, ref } from 'vue';\nimport { CheckOutlined, EditOutlined } from '@ant-design/icons-vue';\nimport { cloneDeep } from 'lodash-es';\nimport { message } from 'ant-design-vue';\nexport default defineComponent({\n  components: {\n    CheckOutlined,\n    EditOutlined,\n  },\n\n  setup() {\n    const options = ref([\n      {\n        value: '1',\n        label: '通过',\n      },\n      {\n        value: '2',\n        label: '不通过',\n      },\n    ]);\n\nconst columns = [\n  {\n  title: '工号',\n  dataIndex: 'userId',\n  width: '5%',\n  sorter: (a, b) => a.length - b.length,\n} ,\n  {\n  title: '姓名',\n  dataIndex: 'name',\n  width: '8%',\n  // sorter: (a, b) => a.length - b.length,\n} ,\n\n{\n  title: '开始时间',\n  dataIndex: 'applyStartTime',\n  // sorter: true,\n  width: '8%',\n  // sorter: (a, b) => a.applyStartTime - b.applyStartTime,\n} ,\n{\n  title: '结束时间',\n  dataIndex: 'applyEndTime',\n  // sorter: true,\n  width: '8%',\n  // sorter: (a, b) => a.applyEndTime - b.applyEndTime,\n} \n,\n{\n  title: '申请类型',\n  dataIndex: 'applyType',\n  // filters: [{\n  //   text: '公休',\n  //   value: '公休',\n  // }, {\n  //   text: '值班加班',\n  //   value: '值班加班',\n  // }\n  // ],\n  // onFilter: (value, record) => record.applyType.indexOf(value) === 0,\n  // sorter: (a, b) => a.applyType.length - b.applyType.length,\n  width: '8%',\n},\n{\n  title: '假期种类',\n  dataIndex: 'holidayType',\n  // filters: [{\n  //   text: '公休请假',\n  //   value: '公休请假',\n  // }, {\n  //   text: '加班换积休',\n  //   value: '加班换积休',\n  // },\n  // {\n  //   text: '值班换积休',\n  //   value: '值班换积休',\n  // }\n  // ],\n  // onFilter: (value, record) => record.holidayType.indexOf(value) === 0,\n  // sorter: (a, b) => a.holidayType.length - b.holidayType.length,\n  width: '8%',\n}\n,\n{\n  title: '申请原因',\n  dataIndex: 'applyReason',\n  width: '15%',\n  // sorter: (a, b) => a.applyReason.length - b.applyReason.length,\n},\n{\n  title: '填写批注',\n  dataIndex: 'approveNote',\n  // sorter: true,\n  width: '20%',\n  slots: {\n          customRender: 'approveNote',\n        },\n},\n{\n  title: '审批结果',\n  dataIndex: 'approveState',\n  // sorter: (a, b) => a.approveState.length - b.approveState.length,\n  // onFilter: (value, record) => record.approveState.indexOf(value) === 0,\n  width: '8%',\n  slots: {\n          customRender: 'approveState',\n        },\n  //   filters: [{\n  //   text: '通过',\n  //   value: '通过',\n  // }, {\n  //   text: '不通过',\n  //   value: '不通过',\n  // },{\n  //   text: '未审批',\n  // //   value: '未审批',\n  // },\n  \n  // ],\n}\n,\n\n// {\n//         title: '操作',\n//         dataIndex: 'operation',\n//         slots: {\n//           customRender: 'operation',\n//         },\n//       },\n];\n  \n\n    const dataSource = ref();\n    let getid = localStorage.getItem(\"Userid\");\n     \n     getworkerApplyHistory(getid).then (\n       response =>{\n          message.success(getid+'aaaaa:'+response['code'])\n         if (response['code'] == 2004){\n           \n            dataSource.value = response['data']\n            console.log(dataSource)\n         }\n       \n       }\n       )\n       \n\n\n\n\n\n    const count = computed(() => dataSource.value.length + 1);\n    const editableData = reactive({});\n\n    const edit = key => {\n      editableData[key] = cloneDeep(dataSource.value.filter(item => key === item.key)[0]);\n      message.success(editableData)\n    };\n\n    const save = key => {\n      Object.assign(dataSource.value.filter(item => key === item.key)[0], editableData[key]);\n      delete editableData[key];\n    };\n    \n  const save_server = key => {\n      Object.assign(dataSource.value.filter(item => key === item.key)[0], editableData[key]);\n      delete editableData[key];\n    };\n\n\n    const onDelete = key => {\n      dataSource.value = dataSource.value.filter(item => item.key !== key);\n    };\n\n    const handleAdd = () => {\n      const newData = {\n        key: `${count.value}`,\n        name: `Edward King ${count.value}`,\n        age: 32,\n        address: `London, Park Lane no. ${count.value}`,\n      };\n      dataSource.value.push(newData);\n    };\n\n    return {\n      getworkerApplyHistory,\n      options,\n      columns,\n      onDelete,\n      handleAdd,\n      dataSource,\n      editableData,\n      count,\n      edit,\n      save,\n      save_server,\n    };\n  },\n});\n</script>\n<style lang=\"less\">\n.editable-cell {\n  position: relative;\n  .editable-cell-input-wrapper,\n  .editable-cell-text-wrapper {\n    padding-right: 24px;\n  }\n\n  .editable-cell-text-wrapper {\n    padding: 5px 24px 5px 5px;\n  }\n\n  .editable-cell-icon,\n  .editable-cell-icon-check {\n    position: absolute;\n    right: 0;\n    width: 20px;\n    cursor: pointer;\n  }\n\n  .editable-cell-icon {\n    margin-top: 4px;\n    display: none;\n  }\n\n  .editable-cell-icon-check {\n    line-height: 28px;\n  }\n\n  .editable-cell-icon:hover,\n  .editable-cell-icon-check:hover {\n    color: #108ee9;\n  }\n\n  .editable-add-btn {\n    margin-bottom: 8px;\n  }\n}\n.editable-cell:hover .editable-cell-icon {\n  display: inline-block;\n}\n</style>"]},"metadata":{},"sourceType":"module"}