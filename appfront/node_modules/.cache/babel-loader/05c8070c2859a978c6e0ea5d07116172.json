{"ast":null,"code":"var staticStrFirst = require('./staticStrFirst');\n\nvar staticStrLast = require('./staticStrLast');\n\nvar staticDayTime = require('./staticDayTime');\n\nvar helperGetDateFullYear = require('./helperGetDateFullYear');\n\nvar helperGetDateTime = require('./helperGetDateTime');\n\nvar helperGetDateMonth = require('./helperGetDateMonth');\n\nvar toStringDate = require('./toStringDate');\n\nvar isValidDate = require('./isValidDate');\n\nvar isNumber = require('./isNumber');\n/**\r\n  * 返回前几月或后几月的日期\r\n  *\r\n  * @param {Date} date 日期或数字\r\n  * @param {Number} offsetMonth 月(默认当前月)、前几个月、后几个月\r\n  * @param {Number/String} offsetDay 获取哪天：月初(first)、月末(last)、指定天数(数值)，如果为空，但超过指定月份的天数时，则默认单月最后一天\r\n  * @return {Date}\r\n  */\n\n\nfunction getWhatMonth(date, offsetMonth, offsetDay) {\n  var monthNum = offsetMonth && !isNaN(offsetMonth) ? offsetMonth : 0;\n  date = toStringDate(date);\n\n  if (isValidDate(date)) {\n    if (offsetDay === staticStrFirst) {\n      return new Date(helperGetDateFullYear(date), helperGetDateMonth(date) + monthNum, 1);\n    } else if (offsetDay === staticStrLast) {\n      return new Date(helperGetDateTime(getWhatMonth(date, monthNum + 1, staticStrFirst)) - 1);\n    } else if (isNumber(offsetDay)) {\n      date.setDate(offsetDay);\n    }\n\n    if (monthNum) {\n      var currDate = date.getDate();\n      date.setMonth(helperGetDateMonth(date) + monthNum);\n\n      if (currDate !== date.getDate()) {\n        // 当为指定天数，且被跨月了，则默认单月最后一天\n        date.setDate(1);\n        return new Date(helperGetDateTime(date) - staticDayTime);\n      }\n    }\n  }\n\n  return date;\n}\n\nmodule.exports = getWhatMonth;","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/xe-utils/getWhatMonth.js"],"names":["staticStrFirst","require","staticStrLast","staticDayTime","helperGetDateFullYear","helperGetDateTime","helperGetDateMonth","toStringDate","isValidDate","isNumber","getWhatMonth","date","offsetMonth","offsetDay","monthNum","isNaN","Date","setDate","currDate","getDate","setMonth","module","exports"],"mappings":"AAAA,IAAIA,cAAc,GAAGC,OAAO,CAAC,kBAAD,CAA5B;;AACA,IAAIC,aAAa,GAAGD,OAAO,CAAC,iBAAD,CAA3B;;AACA,IAAIE,aAAa,GAAGF,OAAO,CAAC,iBAAD,CAA3B;;AAEA,IAAIG,qBAAqB,GAAGH,OAAO,CAAC,yBAAD,CAAnC;;AACA,IAAII,iBAAiB,GAAGJ,OAAO,CAAC,qBAAD,CAA/B;;AACA,IAAIK,kBAAkB,GAAGL,OAAO,CAAC,sBAAD,CAAhC;;AAEA,IAAIM,YAAY,GAAGN,OAAO,CAAC,gBAAD,CAA1B;;AACA,IAAIO,WAAW,GAAGP,OAAO,CAAC,eAAD,CAAzB;;AACA,IAAIQ,QAAQ,GAAGR,OAAO,CAAC,YAAD,CAAtB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASS,YAAT,CAAuBC,IAAvB,EAA6BC,WAA7B,EAA0CC,SAA1C,EAAqD;AACnD,MAAIC,QAAQ,GAAGF,WAAW,IAAI,CAACG,KAAK,CAACH,WAAD,CAArB,GAAqCA,WAArC,GAAmD,CAAlE;AACAD,EAAAA,IAAI,GAAGJ,YAAY,CAACI,IAAD,CAAnB;;AACA,MAAIH,WAAW,CAACG,IAAD,CAAf,EAAuB;AACrB,QAAIE,SAAS,KAAKb,cAAlB,EAAkC;AAChC,aAAO,IAAIgB,IAAJ,CAASZ,qBAAqB,CAACO,IAAD,CAA9B,EAAsCL,kBAAkB,CAACK,IAAD,CAAlB,GAA2BG,QAAjE,EAA2E,CAA3E,CAAP;AACD,KAFD,MAEO,IAAID,SAAS,KAAKX,aAAlB,EAAiC;AACtC,aAAO,IAAIc,IAAJ,CAASX,iBAAiB,CAACK,YAAY,CAACC,IAAD,EAAOG,QAAQ,GAAG,CAAlB,EAAqBd,cAArB,CAAb,CAAjB,GAAsE,CAA/E,CAAP;AACD,KAFM,MAEA,IAAIS,QAAQ,CAACI,SAAD,CAAZ,EAAyB;AAC9BF,MAAAA,IAAI,CAACM,OAAL,CAAaJ,SAAb;AACD;;AACD,QAAIC,QAAJ,EAAc;AACZ,UAAII,QAAQ,GAAGP,IAAI,CAACQ,OAAL,EAAf;AACAR,MAAAA,IAAI,CAACS,QAAL,CAAcd,kBAAkB,CAACK,IAAD,CAAlB,GAA2BG,QAAzC;;AACA,UAAII,QAAQ,KAAKP,IAAI,CAACQ,OAAL,EAAjB,EAAiC;AAC/B;AACAR,QAAAA,IAAI,CAACM,OAAL,CAAa,CAAb;AACA,eAAO,IAAID,IAAJ,CAASX,iBAAiB,CAACM,IAAD,CAAjB,GAA0BR,aAAnC,CAAP;AACD;AACF;AACF;;AACD,SAAOQ,IAAP;AACD;;AAEDU,MAAM,CAACC,OAAP,GAAiBZ,YAAjB","sourcesContent":["var staticStrFirst = require('./staticStrFirst')\r\nvar staticStrLast = require('./staticStrLast')\r\nvar staticDayTime = require('./staticDayTime')\r\n\r\nvar helperGetDateFullYear = require('./helperGetDateFullYear')\r\nvar helperGetDateTime = require('./helperGetDateTime')\r\nvar helperGetDateMonth = require('./helperGetDateMonth')\r\n\r\nvar toStringDate = require('./toStringDate')\r\nvar isValidDate = require('./isValidDate')\r\nvar isNumber = require('./isNumber')\r\n\r\n/**\r\n  * 返回前几月或后几月的日期\r\n  *\r\n  * @param {Date} date 日期或数字\r\n  * @param {Number} offsetMonth 月(默认当前月)、前几个月、后几个月\r\n  * @param {Number/String} offsetDay 获取哪天：月初(first)、月末(last)、指定天数(数值)，如果为空，但超过指定月份的天数时，则默认单月最后一天\r\n  * @return {Date}\r\n  */\r\nfunction getWhatMonth (date, offsetMonth, offsetDay) {\r\n  var monthNum = offsetMonth && !isNaN(offsetMonth) ? offsetMonth : 0\r\n  date = toStringDate(date)\r\n  if (isValidDate(date)) {\r\n    if (offsetDay === staticStrFirst) {\r\n      return new Date(helperGetDateFullYear(date), helperGetDateMonth(date) + monthNum, 1)\r\n    } else if (offsetDay === staticStrLast) {\r\n      return new Date(helperGetDateTime(getWhatMonth(date, monthNum + 1, staticStrFirst)) - 1)\r\n    } else if (isNumber(offsetDay)) {\r\n      date.setDate(offsetDay)\r\n    }\r\n    if (monthNum) {\r\n      var currDate = date.getDate()\r\n      date.setMonth(helperGetDateMonth(date) + monthNum)\r\n      if (currDate !== date.getDate()) {\r\n        // 当为指定天数，且被跨月了，则默认单月最后一天\r\n        date.setDate(1)\r\n        return new Date(helperGetDateTime(date) - staticDayTime)\r\n      }\r\n    }\r\n  }\r\n  return date\r\n}\r\n\r\nmodule.exports = getWhatMonth\r\n"]},"metadata":{},"sourceType":"script"}