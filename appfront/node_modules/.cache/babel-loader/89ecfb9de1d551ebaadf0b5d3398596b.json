{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { nextTick } from 'vue';\nimport XEUtils from 'xe-utils';\nimport { VXETable } from '../../v-x-e-table';\nimport { getDomNode, getAbsolutePos, getEventTargetNode } from '../../tools/dom';\nimport { isEnableConf, hasChildrenList } from '../../tools/utils';\nimport { hasEventKey, EVENT_KEYS } from '../../tools/event';\nvar tableMenuMethodKeys = ['closeMenu'];\nvar tableMenuHook = {\n  setupTable: function ($xetable) {\n    var xID = $xetable.xID,\n        props = $xetable.props,\n        reactData = $xetable.reactData,\n        internalData = $xetable.internalData;\n\n    var _a = $xetable.getRefMaps(),\n        refElem = _a.refElem,\n        refTableFilter = _a.refTableFilter,\n        refTableMenu = _a.refTableMenu;\n\n    var _b = $xetable.getComputeMaps(),\n        computeMouseOpts = _b.computeMouseOpts,\n        computeIsMenu = _b.computeIsMenu,\n        computeMenuOpts = _b.computeMenuOpts;\n\n    var menuMethods = {};\n    var menuPrivateMethods = {};\n    /**\n     * 显示快捷菜单\n     */\n\n    var openContextMenu = function (evnt, type, params) {\n      var ctxMenuStore = reactData.ctxMenuStore;\n      var isMenu = computeIsMenu.value;\n      var menuOpts = computeMenuOpts.value;\n      var config = menuOpts[type];\n      var visibleMethod = menuOpts.visibleMethod;\n\n      if (config) {\n        var options_1 = config.options,\n            disabled = config.disabled;\n\n        if (disabled) {\n          evnt.preventDefault();\n        } else if (isMenu && options_1 && options_1.length) {\n          params.options = options_1;\n          $xetable.preventEvent(evnt, 'event.showMenu', params, function () {\n            if (!visibleMethod || visibleMethod(params)) {\n              evnt.preventDefault();\n              $xetable.updateZindex();\n\n              var _a = getDomNode(),\n                  scrollTop_1 = _a.scrollTop,\n                  scrollLeft_1 = _a.scrollLeft,\n                  visibleHeight_1 = _a.visibleHeight,\n                  visibleWidth_1 = _a.visibleWidth;\n\n              var top_1 = evnt.clientY + scrollTop_1;\n              var left_1 = evnt.clientX + scrollLeft_1;\n\n              var handleVisible_1 = function () {\n                internalData._currMenuParams = params;\n                Object.assign(ctxMenuStore, {\n                  visible: true,\n                  list: options_1,\n                  selected: null,\n                  selectChild: null,\n                  showChild: false,\n                  style: {\n                    zIndex: internalData.tZindex,\n                    top: top_1 + \"px\",\n                    left: left_1 + \"px\"\n                  }\n                });\n                nextTick(function () {\n                  var tableMenu = refTableMenu.value;\n                  var ctxElem = tableMenu.getRefMaps().refElem.value;\n                  var clientHeight = ctxElem.clientHeight;\n                  var clientWidth = ctxElem.clientWidth;\n\n                  var _a = getAbsolutePos(ctxElem),\n                      boundingTop = _a.boundingTop,\n                      boundingLeft = _a.boundingLeft;\n\n                  var offsetTop = boundingTop + clientHeight - visibleHeight_1;\n                  var offsetLeft = boundingLeft + clientWidth - visibleWidth_1;\n\n                  if (offsetTop > -10) {\n                    ctxMenuStore.style.top = Math.max(scrollTop_1 + 2, top_1 - clientHeight - 2) + \"px\";\n                  }\n\n                  if (offsetLeft > -10) {\n                    ctxMenuStore.style.left = Math.max(scrollLeft_1 + 2, left_1 - clientWidth - 2) + \"px\";\n                  }\n                });\n              };\n\n              var keyboard = params.keyboard,\n                  row_1 = params.row,\n                  column_1 = params.column;\n\n              if (keyboard && row_1 && column_1) {\n                $xetable.scrollToRow(row_1, column_1).then(function () {\n                  var cell = $xetable.getCell(row_1, column_1);\n\n                  if (cell) {\n                    var _a = getAbsolutePos(cell),\n                        boundingTop = _a.boundingTop,\n                        boundingLeft = _a.boundingLeft;\n\n                    top_1 = boundingTop + scrollTop_1 + Math.floor(cell.offsetHeight / 2);\n                    left_1 = boundingLeft + scrollLeft_1 + Math.floor(cell.offsetWidth / 2);\n                  }\n\n                  handleVisible_1();\n                });\n              } else {\n                handleVisible_1();\n              }\n            } else {\n              menuMethods.closeMenu();\n            }\n          });\n        }\n      }\n\n      $xetable.closeFilter();\n    };\n\n    menuMethods = {\n      /**\n       * 关闭快捷菜单\n       */\n      closeMenu: function () {\n        Object.assign(reactData.ctxMenuStore, {\n          visible: false,\n          selected: null,\n          selectChild: null,\n          showChild: false\n        });\n        return nextTick();\n      }\n    };\n    menuPrivateMethods = {\n      /**\n       * 处理菜单的移动\n       * @param evnt\n       * @param ctxMenuStore\n       * @param property\n       * @param hasOper\n       * @param operRest\n       * @param menuList\n       */\n      moveCtxMenu: function (evnt, ctxMenuStore, property, hasOper, operRest, menuList) {\n        var selectItem;\n        var selectIndex = XEUtils.findIndexOf(menuList, function (item) {\n          return ctxMenuStore[property] === item;\n        });\n\n        if (hasOper) {\n          if (operRest && hasChildrenList(ctxMenuStore.selected)) {\n            ctxMenuStore.showChild = true;\n          } else {\n            ctxMenuStore.showChild = false;\n            ctxMenuStore.selectChild = null;\n          }\n        } else if (hasEventKey(evnt, EVENT_KEYS.ARROW_UP)) {\n          for (var len = selectIndex - 1; len >= 0; len--) {\n            if (menuList[len].visible !== false) {\n              selectItem = menuList[len];\n              break;\n            }\n          }\n\n          ctxMenuStore[property] = selectItem || menuList[menuList.length - 1];\n        } else if (hasEventKey(evnt, EVENT_KEYS.ARROW_DOWN)) {\n          for (var index = selectIndex + 1; index < menuList.length; index++) {\n            if (menuList[index].visible !== false) {\n              selectItem = menuList[index];\n              break;\n            }\n          }\n\n          ctxMenuStore[property] = selectItem || menuList[0];\n        } else if (ctxMenuStore[property] && (hasEventKey(evnt, EVENT_KEYS.ENTER) || hasEventKey(evnt, EVENT_KEYS.SPACEBAR))) {\n          menuPrivateMethods.ctxMenuLinkEvent(evnt, ctxMenuStore[property]);\n        }\n      },\n\n      /**\n       * 快捷菜单事件处理\n       */\n      handleGlobalContextmenuEvent: function (evnt) {\n        var mouseConfig = props.mouseConfig,\n            menuConfig = props.menuConfig;\n        var editStore = reactData.editStore,\n            ctxMenuStore = reactData.ctxMenuStore;\n        var visibleColumn = internalData.visibleColumn;\n        var tableFilter = refTableFilter.value;\n        var tableMenu = refTableMenu.value;\n        var mouseOpts = computeMouseOpts.value;\n        var menuOpts = computeMenuOpts.value;\n        var el = refElem.value;\n        var selected = editStore.selected;\n        var layoutList = ['header', 'body', 'footer'];\n\n        if (isEnableConf(menuConfig)) {\n          if (ctxMenuStore.visible && tableMenu && getEventTargetNode(evnt, tableMenu.getRefMaps().refElem.value).flag) {\n            evnt.preventDefault();\n            return;\n          }\n\n          if (internalData._keyCtx) {\n            var type = 'body';\n            var params = {\n              type: type,\n              $table: $xetable,\n              keyboard: true,\n              columns: visibleColumn.slice(0),\n              $event: evnt\n            }; // 如果开启单元格区域\n\n            if (mouseConfig && mouseOpts.area) {\n              var activeArea = $xetable.getActiveCellArea();\n\n              if (activeArea && activeArea.row && activeArea.column) {\n                params.row = activeArea.row;\n                params.column = activeArea.column;\n                openContextMenu(evnt, type, params);\n                return;\n              }\n            } else if (mouseConfig && mouseOpts.selected) {\n              // 如果启用键盘导航且已选中单元格\n              if (selected.row && selected.column) {\n                params.row = selected.row;\n                params.column = selected.column;\n                openContextMenu(evnt, type, params);\n                return;\n              }\n            }\n          } // 分别匹配表尾、内容、表尾的快捷菜单\n\n\n          for (var index = 0; index < layoutList.length; index++) {\n            var layout = layoutList[index];\n            var columnTargetNode = getEventTargetNode(evnt, el, \"vxe-\" + layout + \"--column\", function (target) {\n              // target=td|th，直接向上找 table 去匹配即可\n              return target.parentNode.parentNode.parentNode.getAttribute('xid') === xID;\n            });\n            var params = {\n              type: layout,\n              $table: $xetable,\n              columns: visibleColumn.slice(0),\n              $event: evnt\n            };\n\n            if (columnTargetNode.flag) {\n              var cell = columnTargetNode.targetElem;\n              var columnNodeRest = $xetable.getColumnNode(cell);\n              var column = columnNodeRest ? columnNodeRest.item : null;\n              var typePrefix = layout + \"-\";\n\n              if (column) {\n                Object.assign(params, {\n                  column: column,\n                  columnIndex: $xetable.getColumnIndex(column),\n                  cell: cell\n                });\n              }\n\n              if (layout === 'body') {\n                var rowNodeRest = $xetable.getRowNode(cell.parentNode);\n                var row = rowNodeRest ? rowNodeRest.item : null;\n                typePrefix = '';\n\n                if (row) {\n                  params.row = row;\n                  params.rowIndex = $xetable.getRowIndex(row);\n                }\n              }\n\n              var eventType = typePrefix + \"cell-menu\";\n              openContextMenu(evnt, layout, params);\n              $xetable.dispatchEvent(eventType, params, evnt);\n              return;\n            } else if (getEventTargetNode(evnt, el, \"vxe-table--\" + layout + \"-wrapper\", function (target) {\n              return target.getAttribute('xid') === xID;\n            }).flag) {\n              if (menuOpts.trigger === 'cell') {\n                evnt.preventDefault();\n              } else {\n                openContextMenu(evnt, layout, params);\n              }\n\n              return;\n            }\n          }\n        }\n\n        if (tableFilter && !getEventTargetNode(evnt, tableFilter.$el).flag) {\n          $xetable.closeFilter();\n        }\n\n        menuMethods.closeMenu();\n      },\n      ctxMenuMouseoverEvent: function (evnt, item, child) {\n        var menuElem = evnt.currentTarget;\n        var ctxMenuStore = reactData.ctxMenuStore;\n        evnt.preventDefault();\n        evnt.stopPropagation();\n        ctxMenuStore.selected = item;\n        ctxMenuStore.selectChild = child;\n\n        if (!child) {\n          ctxMenuStore.showChild = hasChildrenList(item);\n\n          if (ctxMenuStore.showChild) {\n            nextTick(function () {\n              var childWrapperElem = menuElem.nextElementSibling;\n\n              if (childWrapperElem) {\n                var _a = getAbsolutePos(menuElem),\n                    boundingTop = _a.boundingTop,\n                    boundingLeft = _a.boundingLeft,\n                    visibleHeight = _a.visibleHeight,\n                    visibleWidth = _a.visibleWidth;\n\n                var posTop = boundingTop + menuElem.offsetHeight;\n                var posLeft = boundingLeft + menuElem.offsetWidth;\n                var left = '';\n                var right = ''; // 是否超出右侧\n\n                if (posLeft + childWrapperElem.offsetWidth > visibleWidth - 10) {\n                  left = 'auto';\n                  right = menuElem.offsetWidth + \"px\";\n                } // 是否超出底部\n\n\n                var top_2 = '';\n                var bottom = '';\n\n                if (posTop + childWrapperElem.offsetHeight > visibleHeight - 10) {\n                  top_2 = 'auto';\n                  bottom = '0';\n                }\n\n                childWrapperElem.style.left = left;\n                childWrapperElem.style.right = right;\n                childWrapperElem.style.top = top_2;\n                childWrapperElem.style.bottom = bottom;\n              }\n            });\n          }\n        }\n      },\n      ctxMenuMouseoutEvent: function (evnt, item) {\n        var ctxMenuStore = reactData.ctxMenuStore;\n\n        if (!item.children) {\n          ctxMenuStore.selected = null;\n        }\n\n        ctxMenuStore.selectChild = null;\n      },\n\n      /**\n       * 快捷菜单点击事件\n       */\n      ctxMenuLinkEvent: function (evnt, menu) {\n        // 如果一级菜单有配置 code 则允许点击，否则不能点击\n        if (!menu.disabled && (menu.code || !menu.children || !menu.children.length)) {\n          var ctxMenuMethod = VXETable.menus.get(menu.code);\n          var params = Object.assign({}, internalData._currMenuParams, {\n            menu: menu,\n            $table: $xetable,\n            $grid: $xetable.xegrid,\n            $event: evnt\n          });\n\n          if (ctxMenuMethod) {\n            ctxMenuMethod(params, evnt);\n          }\n\n          $xetable.dispatchEvent('menu-click', params, evnt);\n          menuMethods.closeMenu();\n        }\n      }\n    };\n    return __assign(__assign({}, menuMethods), menuPrivateMethods);\n  },\n  setupGrid: function ($xegrid) {\n    return $xegrid.extendTableMethods(tableMenuMethodKeys);\n  }\n};\nexport default tableMenuHook;","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/vxe-table/es/menu/src/hooks.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","nextTick","XEUtils","VXETable","getDomNode","getAbsolutePos","getEventTargetNode","isEnableConf","hasChildrenList","hasEventKey","EVENT_KEYS","tableMenuMethodKeys","tableMenuHook","setupTable","$xetable","xID","props","reactData","internalData","_a","getRefMaps","refElem","refTableFilter","refTableMenu","_b","getComputeMaps","computeMouseOpts","computeIsMenu","computeMenuOpts","menuMethods","menuPrivateMethods","openContextMenu","evnt","type","params","ctxMenuStore","isMenu","value","menuOpts","config","visibleMethod","options_1","options","disabled","preventDefault","preventEvent","updateZindex","scrollTop_1","scrollTop","scrollLeft_1","scrollLeft","visibleHeight_1","visibleHeight","visibleWidth_1","visibleWidth","top_1","clientY","left_1","clientX","handleVisible_1","_currMenuParams","visible","list","selected","selectChild","showChild","style","zIndex","tZindex","top","left","tableMenu","ctxElem","clientHeight","clientWidth","boundingTop","boundingLeft","offsetTop","offsetLeft","Math","max","keyboard","row_1","row","column_1","column","scrollToRow","then","cell","getCell","floor","offsetHeight","offsetWidth","closeMenu","closeFilter","moveCtxMenu","property","hasOper","operRest","menuList","selectItem","selectIndex","findIndexOf","item","ARROW_UP","len","ARROW_DOWN","index","ENTER","SPACEBAR","ctxMenuLinkEvent","handleGlobalContextmenuEvent","mouseConfig","menuConfig","editStore","visibleColumn","tableFilter","mouseOpts","el","layoutList","flag","_keyCtx","$table","columns","slice","$event","area","activeArea","getActiveCellArea","layout","columnTargetNode","target","parentNode","getAttribute","targetElem","columnNodeRest","getColumnNode","typePrefix","columnIndex","getColumnIndex","rowNodeRest","getRowNode","rowIndex","getRowIndex","eventType","dispatchEvent","trigger","$el","ctxMenuMouseoverEvent","child","menuElem","currentTarget","stopPropagation","childWrapperElem","nextElementSibling","posTop","posLeft","right","top_2","bottom","ctxMenuMouseoutEvent","children","menu","code","ctxMenuMethod","menus","get","$grid","xegrid","setupGrid","$xegrid","extendTableMethods"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { nextTick } from 'vue';\nimport XEUtils from 'xe-utils';\nimport { VXETable } from '../../v-x-e-table';\nimport { getDomNode, getAbsolutePos, getEventTargetNode } from '../../tools/dom';\nimport { isEnableConf, hasChildrenList } from '../../tools/utils';\nimport { hasEventKey, EVENT_KEYS } from '../../tools/event';\nvar tableMenuMethodKeys = ['closeMenu'];\nvar tableMenuHook = {\n    setupTable: function ($xetable) {\n        var xID = $xetable.xID, props = $xetable.props, reactData = $xetable.reactData, internalData = $xetable.internalData;\n        var _a = $xetable.getRefMaps(), refElem = _a.refElem, refTableFilter = _a.refTableFilter, refTableMenu = _a.refTableMenu;\n        var _b = $xetable.getComputeMaps(), computeMouseOpts = _b.computeMouseOpts, computeIsMenu = _b.computeIsMenu, computeMenuOpts = _b.computeMenuOpts;\n        var menuMethods = {};\n        var menuPrivateMethods = {};\n        /**\n         * 显示快捷菜单\n         */\n        var openContextMenu = function (evnt, type, params) {\n            var ctxMenuStore = reactData.ctxMenuStore;\n            var isMenu = computeIsMenu.value;\n            var menuOpts = computeMenuOpts.value;\n            var config = menuOpts[type];\n            var visibleMethod = menuOpts.visibleMethod;\n            if (config) {\n                var options_1 = config.options, disabled = config.disabled;\n                if (disabled) {\n                    evnt.preventDefault();\n                }\n                else if (isMenu && options_1 && options_1.length) {\n                    params.options = options_1;\n                    $xetable.preventEvent(evnt, 'event.showMenu', params, function () {\n                        if (!visibleMethod || visibleMethod(params)) {\n                            evnt.preventDefault();\n                            $xetable.updateZindex();\n                            var _a = getDomNode(), scrollTop_1 = _a.scrollTop, scrollLeft_1 = _a.scrollLeft, visibleHeight_1 = _a.visibleHeight, visibleWidth_1 = _a.visibleWidth;\n                            var top_1 = evnt.clientY + scrollTop_1;\n                            var left_1 = evnt.clientX + scrollLeft_1;\n                            var handleVisible_1 = function () {\n                                internalData._currMenuParams = params;\n                                Object.assign(ctxMenuStore, {\n                                    visible: true,\n                                    list: options_1,\n                                    selected: null,\n                                    selectChild: null,\n                                    showChild: false,\n                                    style: {\n                                        zIndex: internalData.tZindex,\n                                        top: top_1 + \"px\",\n                                        left: left_1 + \"px\"\n                                    }\n                                });\n                                nextTick(function () {\n                                    var tableMenu = refTableMenu.value;\n                                    var ctxElem = tableMenu.getRefMaps().refElem.value;\n                                    var clientHeight = ctxElem.clientHeight;\n                                    var clientWidth = ctxElem.clientWidth;\n                                    var _a = getAbsolutePos(ctxElem), boundingTop = _a.boundingTop, boundingLeft = _a.boundingLeft;\n                                    var offsetTop = boundingTop + clientHeight - visibleHeight_1;\n                                    var offsetLeft = boundingLeft + clientWidth - visibleWidth_1;\n                                    if (offsetTop > -10) {\n                                        ctxMenuStore.style.top = Math.max(scrollTop_1 + 2, top_1 - clientHeight - 2) + \"px\";\n                                    }\n                                    if (offsetLeft > -10) {\n                                        ctxMenuStore.style.left = Math.max(scrollLeft_1 + 2, left_1 - clientWidth - 2) + \"px\";\n                                    }\n                                });\n                            };\n                            var keyboard = params.keyboard, row_1 = params.row, column_1 = params.column;\n                            if (keyboard && row_1 && column_1) {\n                                $xetable.scrollToRow(row_1, column_1).then(function () {\n                                    var cell = $xetable.getCell(row_1, column_1);\n                                    if (cell) {\n                                        var _a = getAbsolutePos(cell), boundingTop = _a.boundingTop, boundingLeft = _a.boundingLeft;\n                                        top_1 = boundingTop + scrollTop_1 + Math.floor(cell.offsetHeight / 2);\n                                        left_1 = boundingLeft + scrollLeft_1 + Math.floor(cell.offsetWidth / 2);\n                                    }\n                                    handleVisible_1();\n                                });\n                            }\n                            else {\n                                handleVisible_1();\n                            }\n                        }\n                        else {\n                            menuMethods.closeMenu();\n                        }\n                    });\n                }\n            }\n            $xetable.closeFilter();\n        };\n        menuMethods = {\n            /**\n             * 关闭快捷菜单\n             */\n            closeMenu: function () {\n                Object.assign(reactData.ctxMenuStore, {\n                    visible: false,\n                    selected: null,\n                    selectChild: null,\n                    showChild: false\n                });\n                return nextTick();\n            }\n        };\n        menuPrivateMethods = {\n            /**\n             * 处理菜单的移动\n             * @param evnt\n             * @param ctxMenuStore\n             * @param property\n             * @param hasOper\n             * @param operRest\n             * @param menuList\n             */\n            moveCtxMenu: function (evnt, ctxMenuStore, property, hasOper, operRest, menuList) {\n                var selectItem;\n                var selectIndex = XEUtils.findIndexOf(menuList, function (item) { return ctxMenuStore[property] === item; });\n                if (hasOper) {\n                    if (operRest && hasChildrenList(ctxMenuStore.selected)) {\n                        ctxMenuStore.showChild = true;\n                    }\n                    else {\n                        ctxMenuStore.showChild = false;\n                        ctxMenuStore.selectChild = null;\n                    }\n                }\n                else if (hasEventKey(evnt, EVENT_KEYS.ARROW_UP)) {\n                    for (var len = selectIndex - 1; len >= 0; len--) {\n                        if (menuList[len].visible !== false) {\n                            selectItem = menuList[len];\n                            break;\n                        }\n                    }\n                    ctxMenuStore[property] = selectItem || menuList[menuList.length - 1];\n                }\n                else if (hasEventKey(evnt, EVENT_KEYS.ARROW_DOWN)) {\n                    for (var index = selectIndex + 1; index < menuList.length; index++) {\n                        if (menuList[index].visible !== false) {\n                            selectItem = menuList[index];\n                            break;\n                        }\n                    }\n                    ctxMenuStore[property] = selectItem || menuList[0];\n                }\n                else if (ctxMenuStore[property] && (hasEventKey(evnt, EVENT_KEYS.ENTER) || hasEventKey(evnt, EVENT_KEYS.SPACEBAR))) {\n                    menuPrivateMethods.ctxMenuLinkEvent(evnt, ctxMenuStore[property]);\n                }\n            },\n            /**\n             * 快捷菜单事件处理\n             */\n            handleGlobalContextmenuEvent: function (evnt) {\n                var mouseConfig = props.mouseConfig, menuConfig = props.menuConfig;\n                var editStore = reactData.editStore, ctxMenuStore = reactData.ctxMenuStore;\n                var visibleColumn = internalData.visibleColumn;\n                var tableFilter = refTableFilter.value;\n                var tableMenu = refTableMenu.value;\n                var mouseOpts = computeMouseOpts.value;\n                var menuOpts = computeMenuOpts.value;\n                var el = refElem.value;\n                var selected = editStore.selected;\n                var layoutList = ['header', 'body', 'footer'];\n                if (isEnableConf(menuConfig)) {\n                    if (ctxMenuStore.visible && tableMenu && getEventTargetNode(evnt, tableMenu.getRefMaps().refElem.value).flag) {\n                        evnt.preventDefault();\n                        return;\n                    }\n                    if (internalData._keyCtx) {\n                        var type = 'body';\n                        var params = { type: type, $table: $xetable, keyboard: true, columns: visibleColumn.slice(0), $event: evnt };\n                        // 如果开启单元格区域\n                        if (mouseConfig && mouseOpts.area) {\n                            var activeArea = $xetable.getActiveCellArea();\n                            if (activeArea && activeArea.row && activeArea.column) {\n                                params.row = activeArea.row;\n                                params.column = activeArea.column;\n                                openContextMenu(evnt, type, params);\n                                return;\n                            }\n                        }\n                        else if (mouseConfig && mouseOpts.selected) {\n                            // 如果启用键盘导航且已选中单元格\n                            if (selected.row && selected.column) {\n                                params.row = selected.row;\n                                params.column = selected.column;\n                                openContextMenu(evnt, type, params);\n                                return;\n                            }\n                        }\n                    }\n                    // 分别匹配表尾、内容、表尾的快捷菜单\n                    for (var index = 0; index < layoutList.length; index++) {\n                        var layout = layoutList[index];\n                        var columnTargetNode = getEventTargetNode(evnt, el, \"vxe-\" + layout + \"--column\", function (target) {\n                            // target=td|th，直接向上找 table 去匹配即可\n                            return target.parentNode.parentNode.parentNode.getAttribute('xid') === xID;\n                        });\n                        var params = { type: layout, $table: $xetable, columns: visibleColumn.slice(0), $event: evnt };\n                        if (columnTargetNode.flag) {\n                            var cell = columnTargetNode.targetElem;\n                            var columnNodeRest = $xetable.getColumnNode(cell);\n                            var column = columnNodeRest ? columnNodeRest.item : null;\n                            var typePrefix = layout + \"-\";\n                            if (column) {\n                                Object.assign(params, { column: column, columnIndex: $xetable.getColumnIndex(column), cell: cell });\n                            }\n                            if (layout === 'body') {\n                                var rowNodeRest = $xetable.getRowNode(cell.parentNode);\n                                var row = rowNodeRest ? rowNodeRest.item : null;\n                                typePrefix = '';\n                                if (row) {\n                                    params.row = row;\n                                    params.rowIndex = $xetable.getRowIndex(row);\n                                }\n                            }\n                            var eventType = typePrefix + \"cell-menu\";\n                            openContextMenu(evnt, layout, params);\n                            $xetable.dispatchEvent(eventType, params, evnt);\n                            return;\n                        }\n                        else if (getEventTargetNode(evnt, el, \"vxe-table--\" + layout + \"-wrapper\", function (target) { return target.getAttribute('xid') === xID; }).flag) {\n                            if (menuOpts.trigger === 'cell') {\n                                evnt.preventDefault();\n                            }\n                            else {\n                                openContextMenu(evnt, layout, params);\n                            }\n                            return;\n                        }\n                    }\n                }\n                if (tableFilter && !getEventTargetNode(evnt, tableFilter.$el).flag) {\n                    $xetable.closeFilter();\n                }\n                menuMethods.closeMenu();\n            },\n            ctxMenuMouseoverEvent: function (evnt, item, child) {\n                var menuElem = evnt.currentTarget;\n                var ctxMenuStore = reactData.ctxMenuStore;\n                evnt.preventDefault();\n                evnt.stopPropagation();\n                ctxMenuStore.selected = item;\n                ctxMenuStore.selectChild = child;\n                if (!child) {\n                    ctxMenuStore.showChild = hasChildrenList(item);\n                    if (ctxMenuStore.showChild) {\n                        nextTick(function () {\n                            var childWrapperElem = menuElem.nextElementSibling;\n                            if (childWrapperElem) {\n                                var _a = getAbsolutePos(menuElem), boundingTop = _a.boundingTop, boundingLeft = _a.boundingLeft, visibleHeight = _a.visibleHeight, visibleWidth = _a.visibleWidth;\n                                var posTop = boundingTop + menuElem.offsetHeight;\n                                var posLeft = boundingLeft + menuElem.offsetWidth;\n                                var left = '';\n                                var right = '';\n                                // 是否超出右侧\n                                if (posLeft + childWrapperElem.offsetWidth > visibleWidth - 10) {\n                                    left = 'auto';\n                                    right = menuElem.offsetWidth + \"px\";\n                                }\n                                // 是否超出底部\n                                var top_2 = '';\n                                var bottom = '';\n                                if (posTop + childWrapperElem.offsetHeight > visibleHeight - 10) {\n                                    top_2 = 'auto';\n                                    bottom = '0';\n                                }\n                                childWrapperElem.style.left = left;\n                                childWrapperElem.style.right = right;\n                                childWrapperElem.style.top = top_2;\n                                childWrapperElem.style.bottom = bottom;\n                            }\n                        });\n                    }\n                }\n            },\n            ctxMenuMouseoutEvent: function (evnt, item) {\n                var ctxMenuStore = reactData.ctxMenuStore;\n                if (!item.children) {\n                    ctxMenuStore.selected = null;\n                }\n                ctxMenuStore.selectChild = null;\n            },\n            /**\n             * 快捷菜单点击事件\n             */\n            ctxMenuLinkEvent: function (evnt, menu) {\n                // 如果一级菜单有配置 code 则允许点击，否则不能点击\n                if (!menu.disabled && (menu.code || !menu.children || !menu.children.length)) {\n                    var ctxMenuMethod = VXETable.menus.get(menu.code);\n                    var params = Object.assign({}, internalData._currMenuParams, { menu: menu, $table: $xetable, $grid: $xetable.xegrid, $event: evnt });\n                    if (ctxMenuMethod) {\n                        ctxMenuMethod(params, evnt);\n                    }\n                    $xetable.dispatchEvent('menu-click', params, evnt);\n                    menuMethods.closeMenu();\n                }\n            }\n        };\n        return __assign(__assign({}, menuMethods), menuPrivateMethods);\n    },\n    setupGrid: function ($xegrid) {\n        return $xegrid.extendTableMethods(tableMenuMethodKeys);\n    }\n};\nexport default tableMenuHook;\n"]},"metadata":{},"sourceType":"module"}