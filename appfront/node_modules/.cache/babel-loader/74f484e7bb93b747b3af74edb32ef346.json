{"ast":null,"code":"var setupDefaults = require('./setupDefaults');\n\nvar helperStringUpperCase = require('./helperStringUpperCase');\n\nvar helperGetDateFullYear = require('./helperGetDateFullYear');\n\nvar helperGetDateMonth = require('./helperGetDateMonth');\n\nvar toStringDate = require('./toStringDate');\n\nvar getYearWeek = require('./getYearWeek');\n\nvar getYearDay = require('./getYearDay');\n\nvar assign = require('./assign');\n\nvar isValidDate = require('./isValidDate');\n\nvar isFunction = require('./isFunction');\n\nvar padStart = require('./padStart');\n\nfunction handleCustomTemplate(date, formats, match, value) {\n  var format = formats[match];\n\n  if (format) {\n    if (isFunction(format)) {\n      return format(value, match, date);\n    } else {\n      return format[value];\n    }\n  }\n\n  return value;\n}\n\nvar dateFormatRE = /\\[([^\\]]+)]|y{2,4}|M{1,2}|d{1,2}|H{1,2}|h{1,2}|m{1,2}|s{1,2}|S{1,3}|Z{1,2}|W{1,2}|D{1,3}|[aAeEq]/g;\n/**\r\n  * 日期格式化为字符串，转义符号 []\r\n  *\r\n  * @param {Date} date 日期或数字\r\n  * @param {String} format 输出日期格式(年份(yy|yyyy)、月份(M|MM自动补0)、天(d|dd自动补0)、12小时制(h|hh自动补0)、24小时制(H|HH自动补0)、分钟(m|mm自动补0)、秒(s|ss自动补0)、毫秒(S|SSS自动补0)、D当年的第几天、a/A上午下午、e/E星期几、w当年的第几周、W当月的第几周、q当年第几个季度、Z时区)\r\n  * @param {Object} options {formats: {q: ['日', '一', '二', '三', '四', '五', '六'], E: function (value, match, date) {return '三'}, }} 自定义格式化模板\r\n  * @return {String}\r\n  */\n\nfunction toDateString(date, format, options) {\n  if (date) {\n    date = toStringDate(date);\n\n    if (isValidDate(date)) {\n      var result = format || setupDefaults.parseDateFormat || setupDefaults.formatString;\n      var hours = date.getHours();\n      var apm = hours < 12 ? 'am' : 'pm';\n      var formats = assign({}, setupDefaults.parseDateRules || setupDefaults.formatStringMatchs, options ? options.formats : null);\n\n      var fy = function (match, length) {\n        return ('' + helperGetDateFullYear(date)).substr(4 - length);\n      };\n\n      var fM = function (match, length) {\n        return padStart(helperGetDateMonth(date) + 1, length, '0');\n      };\n\n      var fd = function (match, length) {\n        return padStart(date.getDate(), length, '0');\n      };\n\n      var fH = function (match, length) {\n        return padStart(hours, length, '0');\n      };\n\n      var fh = function (match, length) {\n        return padStart(hours <= 12 ? hours : hours - 12, length, '0');\n      };\n\n      var fm = function (match, length) {\n        return padStart(date.getMinutes(), length, '0');\n      };\n\n      var fs = function (match, length) {\n        return padStart(date.getSeconds(), length, '0');\n      };\n\n      var fS = function (match, length) {\n        return padStart(date.getMilliseconds(), length, '0');\n      };\n\n      var fZ = function (match, length) {\n        var zoneHours = date.getTimezoneOffset() / 60 * -1;\n        return handleCustomTemplate(date, formats, match, (zoneHours >= 0 ? '+' : '-') + padStart(zoneHours, 2, '0') + (length === 1 ? ':' : '') + '00');\n      };\n\n      var fW = function (match, length) {\n        return padStart(handleCustomTemplate(date, formats, match, getYearWeek(date, (options ? options.firstDay : null) || setupDefaults.firstDayOfWeek)), length, '0');\n      };\n\n      var fD = function (match, length) {\n        return padStart(handleCustomTemplate(date, formats, match, getYearDay(date)), length, '0');\n      };\n\n      var parseDates = {\n        yyyy: fy,\n        yy: fy,\n        MM: fM,\n        M: fM,\n        dd: fd,\n        d: fd,\n        HH: fH,\n        H: fH,\n        hh: fh,\n        h: fh,\n        mm: fm,\n        m: fm,\n        ss: fs,\n        s: fs,\n        SSS: fS,\n        S: fS,\n        ZZ: fZ,\n        Z: fZ,\n        WW: fW,\n        W: fW,\n        DDD: fD,\n        D: fD,\n        a: function (match) {\n          return handleCustomTemplate(date, formats, match, apm);\n        },\n        A: function (match) {\n          return handleCustomTemplate(date, formats, match, helperStringUpperCase(apm));\n        },\n        e: function (match) {\n          return handleCustomTemplate(date, formats, match, date.getDay());\n        },\n        E: function (match) {\n          return handleCustomTemplate(date, formats, match, date.getDay());\n        },\n        q: function (match) {\n          return handleCustomTemplate(date, formats, match, Math.floor((helperGetDateMonth(date) + 3) / 3));\n        }\n      };\n      return result.replace(dateFormatRE, function (match, skip) {\n        return skip || (parseDates[match] ? parseDates[match](match, match.length) : match);\n      });\n    }\n\n    return 'Invalid Date';\n  }\n\n  return '';\n}\n\nmodule.exports = toDateString;","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/xe-utils/toDateString.js"],"names":["setupDefaults","require","helperStringUpperCase","helperGetDateFullYear","helperGetDateMonth","toStringDate","getYearWeek","getYearDay","assign","isValidDate","isFunction","padStart","handleCustomTemplate","date","formats","match","value","format","dateFormatRE","toDateString","options","result","parseDateFormat","formatString","hours","getHours","apm","parseDateRules","formatStringMatchs","fy","length","substr","fM","fd","getDate","fH","fh","fm","getMinutes","fs","getSeconds","fS","getMilliseconds","fZ","zoneHours","getTimezoneOffset","fW","firstDay","firstDayOfWeek","fD","parseDates","yyyy","yy","MM","M","dd","d","HH","H","hh","h","mm","m","ss","s","SSS","S","ZZ","Z","WW","W","DDD","D","a","A","e","getDay","E","q","Math","floor","replace","skip","module","exports"],"mappings":"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","sourcesContent":["var setupDefaults = require('./setupDefaults')\r\n\r\nvar helperStringUpperCase = require('./helperStringUpperCase')\r\nvar helperGetDateFullYear = require('./helperGetDateFullYear')\r\nvar helperGetDateMonth = require('./helperGetDateMonth')\r\n\r\nvar toStringDate = require('./toStringDate')\r\nvar getYearWeek = require('./getYearWeek')\r\nvar getYearDay = require('./getYearDay')\r\n\r\nvar assign = require('./assign')\r\n\r\nvar isValidDate = require('./isValidDate')\r\nvar isFunction = require('./isFunction')\r\n\r\nvar padStart = require('./padStart')\r\n\r\nfunction handleCustomTemplate (date, formats, match, value) {\r\n  var format = formats[match]\r\n  if (format) {\r\n    if (isFunction(format)) {\r\n      return format(value, match, date)\r\n    } else {\r\n      return format[value]\r\n    }\r\n  }\r\n  return value\r\n}\r\n\r\nvar dateFormatRE = /\\[([^\\]]+)]|y{2,4}|M{1,2}|d{1,2}|H{1,2}|h{1,2}|m{1,2}|s{1,2}|S{1,3}|Z{1,2}|W{1,2}|D{1,3}|[aAeEq]/g\r\n\r\n/**\r\n  * 日期格式化为字符串，转义符号 []\r\n  *\r\n  * @param {Date} date 日期或数字\r\n  * @param {String} format 输出日期格式(年份(yy|yyyy)、月份(M|MM自动补0)、天(d|dd自动补0)、12小时制(h|hh自动补0)、24小时制(H|HH自动补0)、分钟(m|mm自动补0)、秒(s|ss自动补0)、毫秒(S|SSS自动补0)、D当年的第几天、a/A上午下午、e/E星期几、w当年的第几周、W当月的第几周、q当年第几个季度、Z时区)\r\n  * @param {Object} options {formats: {q: ['日', '一', '二', '三', '四', '五', '六'], E: function (value, match, date) {return '三'}, }} 自定义格式化模板\r\n  * @return {String}\r\n  */\r\nfunction toDateString (date, format, options) {\r\n  if (date) {\r\n    date = toStringDate(date)\r\n    if (isValidDate(date)) {\r\n      var result = format || setupDefaults.parseDateFormat || setupDefaults.formatString\r\n      var hours = date.getHours()\r\n      var apm = hours < 12 ? 'am' : 'pm'\r\n      var formats = assign({}, setupDefaults.parseDateRules || setupDefaults.formatStringMatchs, options ? options.formats : null)\r\n      var fy = function (match, length) {\r\n        return ('' + helperGetDateFullYear(date)).substr(4 - length)\r\n      }\r\n      var fM = function (match, length) {\r\n        return padStart(helperGetDateMonth(date) + 1, length, '0')\r\n      }\r\n      var fd = function (match, length) {\r\n        return padStart(date.getDate(), length, '0')\r\n      }\r\n      var fH = function (match, length) {\r\n        return padStart(hours, length, '0')\r\n      }\r\n      var fh = function (match, length) {\r\n        return padStart(hours <= 12 ? hours : hours - 12, length, '0')\r\n      }\r\n      var fm = function (match, length) {\r\n        return padStart(date.getMinutes(), length, '0')\r\n      }\r\n      var fs = function (match, length) {\r\n        return padStart(date.getSeconds(), length, '0')\r\n      }\r\n      var fS = function (match, length) {\r\n        return padStart(date.getMilliseconds(), length, '0')\r\n      }\r\n      var fZ = function (match, length) {\r\n        var zoneHours = date.getTimezoneOffset() / 60 * -1\r\n        return handleCustomTemplate(date, formats, match, (zoneHours >= 0 ? '+' : '-') + padStart(zoneHours, 2, '0') + (length === 1 ? ':' : '') + '00')\r\n      }\r\n      var fW = function (match, length) {\r\n        return padStart(handleCustomTemplate(date, formats, match, getYearWeek(date, (options ? options.firstDay : null) || setupDefaults.firstDayOfWeek)), length, '0')\r\n      }\r\n      var fD = function (match, length) {\r\n        return padStart(handleCustomTemplate(date, formats, match, getYearDay(date)), length, '0')\r\n      }\r\n      var parseDates = {\r\n        yyyy: fy,\r\n        yy: fy,\r\n        MM: fM,\r\n        M: fM,\r\n        dd: fd,\r\n        d: fd,\r\n        HH: fH,\r\n        H: fH,\r\n        hh: fh,\r\n        h: fh,\r\n        mm: fm,\r\n        m: fm,\r\n        ss: fs,\r\n        s: fs,\r\n        SSS: fS,\r\n        S: fS,\r\n        ZZ: fZ,\r\n        Z: fZ,\r\n        WW: fW,\r\n        W: fW,\r\n        DDD: fD,\r\n        D: fD,\r\n        a: function (match) {\r\n          return handleCustomTemplate(date, formats, match, apm)\r\n        },\r\n        A: function (match) {\r\n          return handleCustomTemplate(date, formats, match, helperStringUpperCase(apm))\r\n        },\r\n        e: function (match) {\r\n          return handleCustomTemplate(date, formats, match, date.getDay())\r\n        },\r\n        E: function (match) {\r\n          return handleCustomTemplate(date, formats, match, date.getDay())\r\n        },\r\n        q: function (match) {\r\n          return handleCustomTemplate(date, formats, match, Math.floor((helperGetDateMonth(date) + 3) / 3))\r\n        }\r\n      }\r\n      return result.replace(dateFormatRE, function (match, skip) {\r\n        return skip || (parseDates[match] ? parseDates[match](match, match.length) : match)\r\n      })\r\n    }\r\n    return 'Invalid Date'\r\n  }\r\n  return ''\r\n}\r\n\r\nmodule.exports = toDateString\r\n"]},"metadata":{},"sourceType":"script"}