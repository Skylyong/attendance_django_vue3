{"ast":null,"code":"import { usePagination } from 'vue-request';\nimport { getworkerApplyHistory } from '../../api/api.js';\nimport { computed, defineComponent, ref, reactive } from 'vue';\nimport { cloneDeep } from 'lodash-es';\nimport axios from 'axios';\nimport { CheckOutlined, EditOutlined } from '@ant-design/icons-vue';\nconst columns = [{\n  title: '序号',\n  dataIndex: 'id',\n  width: '8%',\n  sorter: (a, b) => a.id - b.id\n}, {\n  title: '申请时间',\n  dataIndex: 'applyTime',\n  width: '8%',\n  sorter: (a, b) => a.id - b.id\n}, {\n  title: '开始时间',\n  dataIndex: 'applyStartTime',\n  sorter: true,\n  width: '8%',\n  sorter: (a, b) => a.applyStartTime - b.applyStartTime\n}, {\n  title: '结束时间',\n  dataIndex: 'applyEndTime',\n  sorter: true,\n  width: '8%',\n  sorter: (a, b) => a.applyEndTime - b.applyEndTime\n}, {\n  title: '申请时长',\n  dataIndex: 'applyTimeLast',\n  sorter: true,\n  width: '8%',\n  sorter: (a, b) => a.timeLast - b.timeLast\n}, {\n  title: '休假状态',\n  dataIndex: 'applyType',\n  filters: [{\n    text: '公休',\n    value: '公休'\n  }, {\n    text: '值班加班',\n    value: '值班加班'\n  }],\n  onFilter: (value, record) => record.applyType.indexOf(value) === 0,\n  sorter: (a, b) => a.applyType.length - b.applyType.length,\n  width: '12%'\n}, {\n  title: '假期种类',\n  dataIndex: 'holidayType',\n  filters: [{\n    text: '公休请假',\n    value: '公休请假'\n  }, {\n    text: '加班换积休',\n    value: '加班换积休'\n  }, {\n    text: '值班换积休',\n    value: '值班换积休'\n  }],\n  onFilter: (value, record) => record.holidayType.indexOf(value) === 0,\n  sorter: (a, b) => a.holidayType.length - b.holidayType.length,\n  width: '12%'\n}, {\n  title: '申请原因',\n  dataIndex: 'applyReason',\n  width: '20%',\n  sorter: (a, b) => a.applyReason.length - b.applyReason.length\n}, {\n  title: '审批状态',\n  dataIndex: 'approveState',\n  sorter: (a, b) => a.approveState.length - b.approveState.length,\n  onFilter: (value, record) => record.approveState.indexOf(value) === 0,\n  width: '8%',\n  filters: [{\n    text: '通过',\n    value: '通过'\n  }, {\n    text: '不通过',\n    value: '不通过'\n  }, {\n    text: '未审批',\n    value: '未审批'\n  }]\n}, {\n  title: '批注',\n  dataIndex: '',\n  sorter: true,\n  width: '10%'\n}, {\n  title: '操作',\n  dataIndex: 'operation',\n  slots: {\n    customRender: 'operation'\n  }\n} // {\n//       title: '操作',\n//       dataIndex: 'operation',\n//     }\n];\nexport default defineComponent({\n  components: {\n    CheckOutlined,\n    EditOutlined\n  },\n\n  setup() {\n    //  const onDelete = key => {\n    //     dataSource.value = dataSource.value.filter(item => item.key !== key);\n    //   };\n    const handleTableChange = (pag, filters, sorter) => {\n      run({\n        results: pag.pageSize,\n        page: pag?.current,\n        sortField: sorter.field,\n        sortOrder: sorter.order,\n        ...filters\n      });\n    };\n\n    const editableData = reactive({});\n\n    const edit = key => {\n      editableData[key] = cloneDeep(dataSource.value.filter(item => key === item.key)[0]);\n    };\n\n    let dataSource = ref();\n    let getid = localStorage.getItem(\"Userid\");\n    getworkerApplyHistory(getid).then(response => {\n      if (response['code'] == 1) {\n        console.log(response['data']);\n        dataSource.value = response['data'];\n      }\n    });\n\n    const save = key => {\n      Object.assign(dataSource.value.filter(item => key === item.key)[0], editableData[key]);\n      delete editableData[key];\n    };\n\n    const onDelete = key => {\n      console.log('key key::', key);\n      dataSource.value = dataSource.value.filter(item => item.id !== key);\n    };\n\n    return {\n      dataSource,\n      editableData,\n      save,\n      onDelete,\n      // pagination,\n      // loading,\n      columns,\n      handleTableChange\n    };\n  }\n\n});","map":{"version":3,"mappings":"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","names":["usePagination","getworkerApplyHistory","computed","defineComponent","ref","reactive","cloneDeep","axios","CheckOutlined","EditOutlined","columns","title","dataIndex","width","sorter","a","b","id","applyStartTime","applyEndTime","timeLast","filters","text","value","onFilter","record","applyType","indexOf","length","holidayType","applyReason","approveState","slots","customRender","components","setup","handleTableChange","pag","run","results","pageSize","page","current","sortField","field","sortOrder","order","editableData","edit","key","dataSource","filter","item","getid","localStorage","getItem","then","response","console","log","save","Object","assign","onDelete"],"sourceRoot":"","sources":["/Users/lyong/Desktop/myproj/appfront/src/components/worker/workerApplyHistory.vue"],"sourcesContent":["<template>\n<!-- <a-button class=\"editable-add-btn\" style=\"margin-bottom: 8px\" @click=\"handleAdd\">Add</a-button> -->\n  <a-table bordered :data-source=\"dataSource\" :columns=\"columns\" :@handleTableChange=handleTableChange>\n      <template #operation=\"{ record }\">\n      <a-popconfirm\n        v-if=\"dataSource.length && record.approveState == 1\" \n        title=\"确定删除吗?\"\n        @confirm=\"onDelete(record.id)\">\n        <a>删除</a>\n      </a-popconfirm>\n    </template>\n\n  </a-table>\n</template>\n\n<script>\n\n\nimport { usePagination } from 'vue-request';\nimport{getworkerApplyHistory} from '../../api/api.js'\nimport { computed, defineComponent,ref ,reactive} from 'vue';\nimport { cloneDeep } from 'lodash-es';\nimport axios from 'axios';\nimport { CheckOutlined, EditOutlined } from '@ant-design/icons-vue';\nconst columns = [\n  {\n  title: '序号',\n  dataIndex: 'id',\n  width: '8%',\n  sorter: (a, b) => a.id - b.id,\n} ,\n  {\n  title: '申请时间',\n  dataIndex: 'applyTime',\n  width: '8%',\n  sorter: (a, b) => a.id - b.id,\n} ,\n\n{\n  title: '开始时间',\n  dataIndex: 'applyStartTime',\n  sorter: true,\n  width: '8%',\n  sorter: (a, b) => a.applyStartTime - b.applyStartTime,\n} ,\n{\n  title: '结束时间',\n  dataIndex: 'applyEndTime',\n  sorter: true,\n  width: '8%',\n  sorter: (a, b) => a.applyEndTime - b.applyEndTime,\n} \n,\n{\n  title: '申请时长',\n  dataIndex: 'applyTimeLast',\n  sorter: true,\n  width: '8%',\n  sorter: (a, b) => a.timeLast - b.timeLast,\n}\n,\n{\n  title: '休假状态',\n  dataIndex: 'applyType',\n  filters: [{\n    text: '公休',\n    value: '公休',\n  }, {\n    text: '值班加班',\n    value: '值班加班',\n  }],\n  onFilter: (value, record) => record.applyType.indexOf(value) === 0,\n  sorter: (a, b) => a.applyType.length - b.applyType.length,\n  width: '12%',\n},\n{\n  title: '假期种类',\n  dataIndex: 'holidayType',\n  filters: [{\n    text: '公休请假',\n    value: '公休请假',\n  }, {\n    text: '加班换积休',\n    value: '加班换积休',\n  },\n  {\n    text: '值班换积休',\n    value: '值班换积休',\n  }\n  ],\n  onFilter: (value, record) => record.holidayType.indexOf(value) === 0,\n  sorter: (a, b) => a.holidayType.length - b.holidayType.length,\n  width: '12%',\n}\n,\n{\n  title: '申请原因',\n  dataIndex: 'applyReason',\n  width: '20%',\n  sorter: (a, b) => a.applyReason.length - b.applyReason.length,\n},\n{\n  title: '审批状态',\n  dataIndex: 'approveState',\n  sorter: (a, b) => a.approveState.length - b.approveState.length,\n  onFilter: (value, record) => record.approveState.indexOf(value) === 0,\n  width: '8%',\n    filters: [{\n    text: '通过',\n    value: '通过',\n  }, {\n    text: '不通过',\n    value: '不通过',\n  },{\n    text: '未审批',\n    value: '未审批',\n  },\n  \n  ],\n}\n,\n{\n  title: '批注',\n  dataIndex: '',\n  sorter: true,\n  width: '10%',\n},\n\n{\n        title: '操作',\n        dataIndex: 'operation',\n        slots: {\n          customRender: 'operation',\n        },\n      },\n\n\n\n// {\n//       title: '操作',\n//       dataIndex: 'operation',\n//     }\n];\n\n\nexport default defineComponent({\n   components: {\n    CheckOutlined,\n    EditOutlined,\n  },\n  setup() {\n  //  const onDelete = key => {\n  //     dataSource.value = dataSource.value.filter(item => item.key !== key);\n  //   };\n\n    const handleTableChange = (pag, filters, sorter) => {\n      run({\n        results: pag.pageSize,\n        page: pag?.current,\n        sortField: sorter.field,\n        sortOrder: sorter.order,\n        ...filters,\n      });\n    };\n       const editableData = reactive({});\n        const edit = key => {\n      editableData[key] = cloneDeep(dataSource.value.filter(item => key === item.key)[0]);\n    };\n\n    let dataSource = ref()\n\nlet getid = localStorage.getItem(\"Userid\");\n    getworkerApplyHistory(getid).then (\n       response =>{\n         if (response['code'] == 1){\n           console.log(response['data'])\n        dataSource.value = response['data']\n        \n         }\n       \n       }\n       \n       )\n const save = key => {\n      Object.assign(dataSource.value.filter(item => key === item.key)[0], editableData[key]);\n      delete editableData[key];\n    };\n  const onDelete = key => {\nconsole.log('key key::', key)\n\n      dataSource.value = dataSource.value.filter(item => item.id !== key);\n    };\n\n    return {\n      dataSource,\n      editableData,\n      save,\n      onDelete,\n      // pagination,\n      // loading,\n      columns,\n      handleTableChange,\n    };\n  },\n\n});\n</script>\n\n\n<style lang=\"less\">\n.editable-cell {\n  position: relative;\n  .editable-cell-input-wrapper,\n  .editable-cell-text-wrapper {\n    padding-right: 24px;\n  }\n\n  .editable-cell-text-wrapper {\n    padding: 5px 24px 5px 5px;\n  }\n\n  .editable-cell-icon,\n  .editable-cell-icon-check {\n    position: absolute;\n    right: 0;\n    width: 20px;\n    cursor: pointer;\n  }\n\n  .editable-cell-icon {\n    margin-top: 4px;\n    display: none;\n  }\n\n  .editable-cell-icon-check {\n    line-height: 28px;\n  }\n\n  .editable-cell-icon:hover,\n  .editable-cell-icon-check:hover {\n    color: #108ee9;\n  }\n\n  .editable-add-btn {\n    margin-bottom: 8px;\n  }\n}\n.editable-cell:hover .editable-cell-icon {\n  display: inline-block;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}