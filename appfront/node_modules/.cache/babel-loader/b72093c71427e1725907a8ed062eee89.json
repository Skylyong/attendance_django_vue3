{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { tuple } from '../_util/type';\nimport { computed, defineComponent, nextTick, onMounted, ref, watch } from 'vue';\nimport { getPropsSlot } from '../_util/props-util';\nimport PropTypes from '../_util/vue-types';\nimport useBreakpoint from '../_util/hooks/useBreakpoint';\nimport { responsiveArray } from '../_util/responsiveObserve';\nimport useConfigInject from '../_util/hooks/useConfigInject';\nimport ResizeObserver from '../vc-resize-observer';\nimport { useInjectSize } from '../_util/hooks/useSize';\nexport var avatarProps = {\n  prefixCls: PropTypes.string,\n  shape: PropTypes.oneOf(tuple('circle', 'square')).def('circle'),\n  size: {\n    type: [Number, String, Object],\n    default: function _default() {\n      return 'default';\n    }\n  },\n  src: PropTypes.string,\n\n  /** Srcset of image avatar */\n  srcset: PropTypes.string,\n  icon: PropTypes.VNodeChild,\n  alt: PropTypes.string,\n  gap: PropTypes.number,\n  draggable: PropTypes.bool,\n  loadError: {\n    type: Function\n  }\n};\nvar Avatar = defineComponent({\n  name: 'AAvatar',\n  inheritAttrs: false,\n  props: avatarProps,\n  slots: ['icon'],\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n        attrs = _ref.attrs;\n    var isImgExist = ref(true);\n    var isMounted = ref(false);\n    var scale = ref(1);\n    var avatarChildrenRef = ref(null);\n    var avatarNodeRef = ref(null);\n\n    var _useConfigInject = useConfigInject('avatar', props),\n        prefixCls = _useConfigInject.prefixCls;\n\n    var groupSize = useInjectSize();\n    var screens = useBreakpoint();\n    var responsiveSize = computed(function () {\n      if (_typeof(props.size) !== 'object') {\n        return undefined;\n      }\n\n      var currentBreakpoint = responsiveArray.find(function (screen) {\n        return screens.value[screen];\n      });\n      var currentSize = props.size[currentBreakpoint];\n      return currentSize;\n    });\n\n    var responsiveSizeStyle = function responsiveSizeStyle(hasIcon) {\n      if (responsiveSize.value) {\n        return {\n          width: \"\".concat(responsiveSize.value, \"px\"),\n          height: \"\".concat(responsiveSize.value, \"px\"),\n          lineHeight: \"\".concat(responsiveSize.value, \"px\"),\n          fontSize: \"\".concat(hasIcon ? responsiveSize.value / 2 : 18, \"px\")\n        };\n      }\n\n      return {};\n    };\n\n    var setScaleParam = function setScaleParam() {\n      if (!avatarChildrenRef.value || !avatarNodeRef.value) {\n        return;\n      }\n\n      var childrenWidth = avatarChildrenRef.value.offsetWidth; // offsetWidth avoid affecting be transform scale\n\n      var nodeWidth = avatarNodeRef.value.offsetWidth; // denominator is 0 is no meaning\n\n      if (childrenWidth !== 0 && nodeWidth !== 0) {\n        var _props$gap = props.gap,\n            gap = _props$gap === void 0 ? 4 : _props$gap;\n\n        if (gap * 2 < nodeWidth) {\n          scale.value = nodeWidth - gap * 2 < childrenWidth ? (nodeWidth - gap * 2) / childrenWidth : 1;\n        }\n      }\n    };\n\n    var handleImgLoadError = function handleImgLoadError() {\n      var loadError = props.loadError;\n      var errorFlag = loadError === null || loadError === void 0 ? void 0 : loadError();\n\n      if (errorFlag !== false) {\n        isImgExist.value = false;\n      }\n    };\n\n    watch(function () {\n      return props.src;\n    }, function () {\n      nextTick(function () {\n        isImgExist.value = true;\n        scale.value = 1;\n      });\n    });\n    watch(function () {\n      return props.gap;\n    }, function () {\n      nextTick(function () {\n        setScaleParam();\n      });\n    });\n    onMounted(function () {\n      nextTick(function () {\n        setScaleParam();\n        isMounted.value = true;\n      });\n    });\n    return function () {\n      var _classString;\n\n      var _a;\n\n      var shape = props.shape,\n          customSize = props.size,\n          src = props.src,\n          alt = props.alt,\n          srcset = props.srcset,\n          draggable = props.draggable;\n      var icon = getPropsSlot(slots, props, 'icon');\n      var pre = prefixCls.value;\n      var size = customSize === 'default' ? groupSize.value : customSize;\n      var classString = (_classString = {}, _defineProperty(_classString, \"\".concat(attrs.class), !!attrs.class), _defineProperty(_classString, pre, true), _defineProperty(_classString, \"\".concat(pre, \"-lg\"), size === 'large'), _defineProperty(_classString, \"\".concat(pre, \"-sm\"), size === 'small'), _defineProperty(_classString, \"\".concat(pre, \"-\").concat(shape), shape), _defineProperty(_classString, \"\".concat(pre, \"-image\"), src && isImgExist.value), _defineProperty(_classString, \"\".concat(pre, \"-icon\"), icon), _classString);\n      var sizeStyle = typeof size === 'number' ? {\n        width: \"\".concat(size, \"px\"),\n        height: \"\".concat(size, \"px\"),\n        lineHeight: \"\".concat(size, \"px\"),\n        fontSize: icon ? \"\".concat(size / 2, \"px\") : '18px'\n      } : {};\n      var children = (_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots);\n      var childrenToRender;\n\n      if (src && isImgExist.value) {\n        childrenToRender = _createVNode(\"img\", {\n          \"draggable\": draggable,\n          \"src\": src,\n          \"srcset\": srcset,\n          \"onError\": handleImgLoadError,\n          \"alt\": alt\n        }, null);\n      } else if (icon) {\n        childrenToRender = icon;\n      } else if (isMounted.value || scale.value !== 1) {\n        var transformString = \"scale(\".concat(scale.value, \") translateX(-50%)\");\n        var childrenStyle = {\n          msTransform: transformString,\n          WebkitTransform: transformString,\n          transform: transformString\n        };\n        var sizeChildrenStyle = typeof size === 'number' ? {\n          lineHeight: \"\".concat(size, \"px\")\n        } : {};\n        childrenToRender = _createVNode(ResizeObserver, {\n          \"onResize\": setScaleParam\n        }, {\n          default: function _default() {\n            return [_createVNode(\"span\", {\n              \"class\": \"\".concat(pre, \"-string\"),\n              \"ref\": avatarChildrenRef,\n              \"style\": _extends(_extends({}, sizeChildrenStyle), childrenStyle)\n            }, [children])];\n          }\n        });\n      } else {\n        childrenToRender = _createVNode(\"span\", {\n          \"class\": \"\".concat(pre, \"-string\"),\n          \"ref\": avatarChildrenRef,\n          \"style\": {\n            opacity: 0\n          }\n        }, [children]);\n      }\n\n      return _createVNode(\"span\", _objectSpread(_objectSpread({}, attrs), {}, {\n        \"ref\": avatarNodeRef,\n        \"class\": classString,\n        \"style\": _extends(_extends(_extends({}, sizeStyle), responsiveSizeStyle(!!icon)), attrs.style)\n      }), [childrenToRender]);\n    };\n  }\n});\nexport default Avatar;","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/node_modules/ant-design-vue/es/avatar/Avatar.js"],"names":["_objectSpread","_extends","_defineProperty","_typeof","createVNode","_createVNode","tuple","computed","defineComponent","nextTick","onMounted","ref","watch","getPropsSlot","PropTypes","useBreakpoint","responsiveArray","useConfigInject","ResizeObserver","useInjectSize","avatarProps","prefixCls","string","shape","oneOf","def","size","type","Number","String","Object","default","_default","src","srcset","icon","VNodeChild","alt","gap","number","draggable","bool","loadError","Function","Avatar","name","inheritAttrs","props","slots","setup","_ref","attrs","isImgExist","isMounted","scale","avatarChildrenRef","avatarNodeRef","_useConfigInject","groupSize","screens","responsiveSize","undefined","currentBreakpoint","find","screen","value","currentSize","responsiveSizeStyle","hasIcon","width","concat","height","lineHeight","fontSize","setScaleParam","childrenWidth","offsetWidth","nodeWidth","_props$gap","handleImgLoadError","errorFlag","_classString","_a","customSize","pre","classString","class","sizeStyle","children","call","childrenToRender","transformString","childrenStyle","msTransform","WebkitTransform","transform","sizeChildrenStyle","opacity","style"],"mappings":"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","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { tuple } from '../_util/type';\nimport { computed, defineComponent, nextTick, onMounted, ref, watch } from 'vue';\nimport { getPropsSlot } from '../_util/props-util';\nimport PropTypes from '../_util/vue-types';\nimport useBreakpoint from '../_util/hooks/useBreakpoint';\nimport { responsiveArray } from '../_util/responsiveObserve';\nimport useConfigInject from '../_util/hooks/useConfigInject';\nimport ResizeObserver from '../vc-resize-observer';\nimport { useInjectSize } from '../_util/hooks/useSize';\nexport var avatarProps = {\n  prefixCls: PropTypes.string,\n  shape: PropTypes.oneOf(tuple('circle', 'square')).def('circle'),\n  size: {\n    type: [Number, String, Object],\n    default: function _default() {\n      return 'default';\n    }\n  },\n  src: PropTypes.string,\n\n  /** Srcset of image avatar */\n  srcset: PropTypes.string,\n  icon: PropTypes.VNodeChild,\n  alt: PropTypes.string,\n  gap: PropTypes.number,\n  draggable: PropTypes.bool,\n  loadError: {\n    type: Function\n  }\n};\nvar Avatar = defineComponent({\n  name: 'AAvatar',\n  inheritAttrs: false,\n  props: avatarProps,\n  slots: ['icon'],\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n        attrs = _ref.attrs;\n    var isImgExist = ref(true);\n    var isMounted = ref(false);\n    var scale = ref(1);\n    var avatarChildrenRef = ref(null);\n    var avatarNodeRef = ref(null);\n\n    var _useConfigInject = useConfigInject('avatar', props),\n        prefixCls = _useConfigInject.prefixCls;\n\n    var groupSize = useInjectSize();\n    var screens = useBreakpoint();\n    var responsiveSize = computed(function () {\n      if (_typeof(props.size) !== 'object') {\n        return undefined;\n      }\n\n      var currentBreakpoint = responsiveArray.find(function (screen) {\n        return screens.value[screen];\n      });\n      var currentSize = props.size[currentBreakpoint];\n      return currentSize;\n    });\n\n    var responsiveSizeStyle = function responsiveSizeStyle(hasIcon) {\n      if (responsiveSize.value) {\n        return {\n          width: \"\".concat(responsiveSize.value, \"px\"),\n          height: \"\".concat(responsiveSize.value, \"px\"),\n          lineHeight: \"\".concat(responsiveSize.value, \"px\"),\n          fontSize: \"\".concat(hasIcon ? responsiveSize.value / 2 : 18, \"px\")\n        };\n      }\n\n      return {};\n    };\n\n    var setScaleParam = function setScaleParam() {\n      if (!avatarChildrenRef.value || !avatarNodeRef.value) {\n        return;\n      }\n\n      var childrenWidth = avatarChildrenRef.value.offsetWidth; // offsetWidth avoid affecting be transform scale\n\n      var nodeWidth = avatarNodeRef.value.offsetWidth; // denominator is 0 is no meaning\n\n      if (childrenWidth !== 0 && nodeWidth !== 0) {\n        var _props$gap = props.gap,\n            gap = _props$gap === void 0 ? 4 : _props$gap;\n\n        if (gap * 2 < nodeWidth) {\n          scale.value = nodeWidth - gap * 2 < childrenWidth ? (nodeWidth - gap * 2) / childrenWidth : 1;\n        }\n      }\n    };\n\n    var handleImgLoadError = function handleImgLoadError() {\n      var loadError = props.loadError;\n      var errorFlag = loadError === null || loadError === void 0 ? void 0 : loadError();\n\n      if (errorFlag !== false) {\n        isImgExist.value = false;\n      }\n    };\n\n    watch(function () {\n      return props.src;\n    }, function () {\n      nextTick(function () {\n        isImgExist.value = true;\n        scale.value = 1;\n      });\n    });\n    watch(function () {\n      return props.gap;\n    }, function () {\n      nextTick(function () {\n        setScaleParam();\n      });\n    });\n    onMounted(function () {\n      nextTick(function () {\n        setScaleParam();\n        isMounted.value = true;\n      });\n    });\n    return function () {\n      var _classString;\n\n      var _a;\n\n      var shape = props.shape,\n          customSize = props.size,\n          src = props.src,\n          alt = props.alt,\n          srcset = props.srcset,\n          draggable = props.draggable;\n      var icon = getPropsSlot(slots, props, 'icon');\n      var pre = prefixCls.value;\n      var size = customSize === 'default' ? groupSize.value : customSize;\n      var classString = (_classString = {}, _defineProperty(_classString, \"\".concat(attrs.class), !!attrs.class), _defineProperty(_classString, pre, true), _defineProperty(_classString, \"\".concat(pre, \"-lg\"), size === 'large'), _defineProperty(_classString, \"\".concat(pre, \"-sm\"), size === 'small'), _defineProperty(_classString, \"\".concat(pre, \"-\").concat(shape), shape), _defineProperty(_classString, \"\".concat(pre, \"-image\"), src && isImgExist.value), _defineProperty(_classString, \"\".concat(pre, \"-icon\"), icon), _classString);\n      var sizeStyle = typeof size === 'number' ? {\n        width: \"\".concat(size, \"px\"),\n        height: \"\".concat(size, \"px\"),\n        lineHeight: \"\".concat(size, \"px\"),\n        fontSize: icon ? \"\".concat(size / 2, \"px\") : '18px'\n      } : {};\n      var children = (_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots);\n      var childrenToRender;\n\n      if (src && isImgExist.value) {\n        childrenToRender = _createVNode(\"img\", {\n          \"draggable\": draggable,\n          \"src\": src,\n          \"srcset\": srcset,\n          \"onError\": handleImgLoadError,\n          \"alt\": alt\n        }, null);\n      } else if (icon) {\n        childrenToRender = icon;\n      } else if (isMounted.value || scale.value !== 1) {\n        var transformString = \"scale(\".concat(scale.value, \") translateX(-50%)\");\n        var childrenStyle = {\n          msTransform: transformString,\n          WebkitTransform: transformString,\n          transform: transformString\n        };\n        var sizeChildrenStyle = typeof size === 'number' ? {\n          lineHeight: \"\".concat(size, \"px\")\n        } : {};\n        childrenToRender = _createVNode(ResizeObserver, {\n          \"onResize\": setScaleParam\n        }, {\n          default: function _default() {\n            return [_createVNode(\"span\", {\n              \"class\": \"\".concat(pre, \"-string\"),\n              \"ref\": avatarChildrenRef,\n              \"style\": _extends(_extends({}, sizeChildrenStyle), childrenStyle)\n            }, [children])];\n          }\n        });\n      } else {\n        childrenToRender = _createVNode(\"span\", {\n          \"class\": \"\".concat(pre, \"-string\"),\n          \"ref\": avatarChildrenRef,\n          \"style\": {\n            opacity: 0\n          }\n        }, [children]);\n      }\n\n      return _createVNode(\"span\", _objectSpread(_objectSpread({}, attrs), {}, {\n        \"ref\": avatarNodeRef,\n        \"class\": classString,\n        \"style\": _extends(_extends(_extends({}, sizeStyle), responsiveSizeStyle(!!icon)), attrs.style)\n      }), [childrenToRender]);\n    };\n  }\n});\nexport default Avatar;"]},"metadata":{},"sourceType":"module"}