{"ast":null,"code":"var setupDefaults = require('./setupDefaults');\n\nvar staticDayTime = require('./staticDayTime');\n\nvar staticWeekTime = require('./staticWeekTime');\n\nvar helperGetDateTime = require('./helperGetDateTime');\n\nvar toStringDate = require('./toStringDate');\n\nvar isValidDate = require('./isValidDate');\n\nvar isNumber = require('./isNumber');\n/**\r\n  * 返回前几周或后几周的星期几\r\n  *\r\n  * @param {Date} date 日期\r\n  * @param {Number} offsetWeek 周(默认当前周)、前几周、后几周\r\n  * @param {Number} offsetDay 星期天(默认0)、星期一(1)、星期二(2)、星期三(3)、星期四(4)、星期五(5)、星期六(6)\r\n  * @param {Number} firstDay 周视图的起始天，默认星期一\r\n  * @return {Date}\r\n  */\n\n\nfunction getWhatWeek(date, offsetWeek, offsetDay, firstDay) {\n  date = toStringDate(date);\n\n  if (isValidDate(date)) {\n    var hasCustomDay = isNumber(offsetDay);\n    var hasStartDay = isNumber(firstDay);\n    var whatDayTime = helperGetDateTime(date); // 如果指定了天或周视图起始天\n\n    if (hasCustomDay || hasStartDay) {\n      var viewStartDay = hasStartDay ? firstDay : setupDefaults.firstDayOfWeek;\n      var currentDay = date.getDay();\n      var customDay = hasCustomDay ? offsetDay : currentDay;\n\n      if (currentDay !== customDay) {\n        var offsetNum = 0;\n\n        if (viewStartDay > currentDay) {\n          offsetNum = -(7 - viewStartDay + currentDay);\n        } else if (viewStartDay < currentDay) {\n          offsetNum = viewStartDay - currentDay;\n        }\n\n        if (customDay > viewStartDay) {\n          whatDayTime += ((customDay === 0 ? 7 : customDay) - viewStartDay + offsetNum) * staticDayTime;\n        } else if (customDay < viewStartDay) {\n          whatDayTime += (7 - viewStartDay + customDay + offsetNum) * staticDayTime;\n        } else {\n          whatDayTime += offsetNum * staticDayTime;\n        }\n      }\n    }\n\n    if (offsetWeek && !isNaN(offsetWeek)) {\n      whatDayTime += offsetWeek * staticWeekTime;\n    }\n\n    return new Date(whatDayTime);\n  }\n\n  return date;\n}\n\nmodule.exports = getWhatWeek;","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/xe-utils/getWhatWeek.js"],"names":["setupDefaults","require","staticDayTime","staticWeekTime","helperGetDateTime","toStringDate","isValidDate","isNumber","getWhatWeek","date","offsetWeek","offsetDay","firstDay","hasCustomDay","hasStartDay","whatDayTime","viewStartDay","firstDayOfWeek","currentDay","getDay","customDay","offsetNum","isNaN","Date","module","exports"],"mappings":"AAAA,IAAIA,aAAa,GAAGC,OAAO,CAAC,iBAAD,CAA3B;;AAEA,IAAIC,aAAa,GAAGD,OAAO,CAAC,iBAAD,CAA3B;;AACA,IAAIE,cAAc,GAAGF,OAAO,CAAC,kBAAD,CAA5B;;AAEA,IAAIG,iBAAiB,GAAGH,OAAO,CAAC,qBAAD,CAA/B;;AAEA,IAAII,YAAY,GAAGJ,OAAO,CAAC,gBAAD,CAA1B;;AAEA,IAAIK,WAAW,GAAGL,OAAO,CAAC,eAAD,CAAzB;;AACA,IAAIM,QAAQ,GAAGN,OAAO,CAAC,YAAD,CAAtB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASO,WAAT,CAAsBC,IAAtB,EAA4BC,UAA5B,EAAwCC,SAAxC,EAAmDC,QAAnD,EAA6D;AAC3DH,EAAAA,IAAI,GAAGJ,YAAY,CAACI,IAAD,CAAnB;;AACA,MAAIH,WAAW,CAACG,IAAD,CAAf,EAAuB;AACrB,QAAII,YAAY,GAAGN,QAAQ,CAACI,SAAD,CAA3B;AACA,QAAIG,WAAW,GAAGP,QAAQ,CAACK,QAAD,CAA1B;AACA,QAAIG,WAAW,GAAGX,iBAAiB,CAACK,IAAD,CAAnC,CAHqB,CAIrB;;AACA,QAAII,YAAY,IAAIC,WAApB,EAAiC;AAC/B,UAAIE,YAAY,GAAGF,WAAW,GAAGF,QAAH,GAAcZ,aAAa,CAACiB,cAA1D;AACA,UAAIC,UAAU,GAAGT,IAAI,CAACU,MAAL,EAAjB;AACA,UAAIC,SAAS,GAAGP,YAAY,GAAGF,SAAH,GAAeO,UAA3C;;AACA,UAAIA,UAAU,KAAKE,SAAnB,EAA8B;AAC5B,YAAIC,SAAS,GAAG,CAAhB;;AACA,YAAIL,YAAY,GAAGE,UAAnB,EAA+B;AAC7BG,UAAAA,SAAS,GAAG,EAAE,IAAIL,YAAJ,GAAmBE,UAArB,CAAZ;AACD,SAFD,MAEO,IAAIF,YAAY,GAAGE,UAAnB,EAA+B;AACpCG,UAAAA,SAAS,GAAGL,YAAY,GAAGE,UAA3B;AACD;;AACD,YAAIE,SAAS,GAAGJ,YAAhB,EAA8B;AAC5BD,UAAAA,WAAW,IAAI,CAAC,CAACK,SAAS,KAAK,CAAd,GAAkB,CAAlB,GAAsBA,SAAvB,IAAoCJ,YAApC,GAAmDK,SAApD,IAAiEnB,aAAhF;AACD,SAFD,MAEO,IAAIkB,SAAS,GAAGJ,YAAhB,EAA8B;AACnCD,UAAAA,WAAW,IAAI,CAAC,IAAIC,YAAJ,GAAmBI,SAAnB,GAA+BC,SAAhC,IAA6CnB,aAA5D;AACD,SAFM,MAEA;AACLa,UAAAA,WAAW,IAAIM,SAAS,GAAGnB,aAA3B;AACD;AACF;AACF;;AACD,QAAIQ,UAAU,IAAI,CAACY,KAAK,CAACZ,UAAD,CAAxB,EAAsC;AACpCK,MAAAA,WAAW,IAAIL,UAAU,GAAGP,cAA5B;AACD;;AACD,WAAO,IAAIoB,IAAJ,CAASR,WAAT,CAAP;AACD;;AACD,SAAON,IAAP;AACD;;AAEDe,MAAM,CAACC,OAAP,GAAiBjB,WAAjB","sourcesContent":["var setupDefaults = require('./setupDefaults')\r\n\r\nvar staticDayTime = require('./staticDayTime')\r\nvar staticWeekTime = require('./staticWeekTime')\r\n\r\nvar helperGetDateTime = require('./helperGetDateTime')\r\n\r\nvar toStringDate = require('./toStringDate')\r\n\r\nvar isValidDate = require('./isValidDate')\r\nvar isNumber = require('./isNumber')\r\n\r\n/**\r\n  * 返回前几周或后几周的星期几\r\n  *\r\n  * @param {Date} date 日期\r\n  * @param {Number} offsetWeek 周(默认当前周)、前几周、后几周\r\n  * @param {Number} offsetDay 星期天(默认0)、星期一(1)、星期二(2)、星期三(3)、星期四(4)、星期五(5)、星期六(6)\r\n  * @param {Number} firstDay 周视图的起始天，默认星期一\r\n  * @return {Date}\r\n  */\r\nfunction getWhatWeek (date, offsetWeek, offsetDay, firstDay) {\r\n  date = toStringDate(date)\r\n  if (isValidDate(date)) {\r\n    var hasCustomDay = isNumber(offsetDay)\r\n    var hasStartDay = isNumber(firstDay)\r\n    var whatDayTime = helperGetDateTime(date)\r\n    // 如果指定了天或周视图起始天\r\n    if (hasCustomDay || hasStartDay) {\r\n      var viewStartDay = hasStartDay ? firstDay : setupDefaults.firstDayOfWeek\r\n      var currentDay = date.getDay()\r\n      var customDay = hasCustomDay ? offsetDay : currentDay\r\n      if (currentDay !== customDay) {\r\n        var offsetNum = 0\r\n        if (viewStartDay > currentDay) {\r\n          offsetNum = -(7 - viewStartDay + currentDay)\r\n        } else if (viewStartDay < currentDay) {\r\n          offsetNum = viewStartDay - currentDay\r\n        }\r\n        if (customDay > viewStartDay) {\r\n          whatDayTime += ((customDay === 0 ? 7 : customDay) - viewStartDay + offsetNum) * staticDayTime\r\n        } else if (customDay < viewStartDay) {\r\n          whatDayTime += (7 - viewStartDay + customDay + offsetNum) * staticDayTime\r\n        } else {\r\n          whatDayTime += offsetNum * staticDayTime\r\n        }\r\n      }\r\n    }\r\n    if (offsetWeek && !isNaN(offsetWeek)) {\r\n      whatDayTime += offsetWeek * staticWeekTime\r\n    }\r\n    return new Date(whatDayTime)\r\n  }\r\n  return date\r\n}\r\n\r\nmodule.exports = getWhatWeek\r\n"]},"metadata":{},"sourceType":"script"}