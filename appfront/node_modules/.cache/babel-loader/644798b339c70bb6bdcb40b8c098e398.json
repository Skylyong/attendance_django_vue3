{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport PropTypes from '../../../_util/vue-types';\nimport BaseMixin from '../../../_util/BaseMixin';\nimport { getComponent, findDOMNode } from '../../../_util/props-util';\nimport moment from 'moment';\nimport { formatDate } from '../util';\nimport KeyCode from '../../../_util/KeyCode';\nimport { withDirectives } from 'vue';\nimport antInput from '../../../_util/antInputDirective';\nvar cachedSelectionStart;\nvar cachedSelectionEnd;\nvar dateInputInstance;\nvar DateInput = {\n  name: 'DateInput',\n  inheritAttrs: false,\n  mixins: [BaseMixin],\n  props: {\n    prefixCls: PropTypes.string,\n    timePicker: PropTypes.object,\n    value: PropTypes.object,\n    disabledTime: PropTypes.any,\n    format: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string), PropTypes.func]),\n    locale: PropTypes.object,\n    disabledDate: PropTypes.func,\n    // onChange: PropTypes.func,\n    // onClear: PropTypes.func,\n    placeholder: PropTypes.string,\n    // onSelect: PropTypes.func,\n    selectedValue: PropTypes.object,\n    clearIcon: PropTypes.any,\n    inputMode: PropTypes.string,\n    inputReadOnly: PropTypes.looseBool,\n    disabled: PropTypes.looseBool,\n    showClear: PropTypes.looseBool\n  },\n  data: function data() {\n    var selectedValue = this.selectedValue;\n    return {\n      str: formatDate(selectedValue, this.format),\n      invalid: false,\n      hasFocus: false\n    };\n  },\n  watch: {\n    selectedValue: function selectedValue() {\n      this.setState();\n    },\n    format: function format() {\n      this.setState();\n    }\n  },\n  updated: function updated() {\n    var _this = this;\n\n    this.$nextTick(function () {\n      if (dateInputInstance && _this.$data.hasFocus && !_this.invalid && !(cachedSelectionStart === 0 && cachedSelectionEnd === 0)) {\n        dateInputInstance.setSelectionRange(cachedSelectionStart, cachedSelectionEnd);\n      }\n    });\n  },\n  getInstance: function getInstance() {\n    return dateInputInstance;\n  },\n  methods: {\n    getDerivedStateFromProps: function getDerivedStateFromProps(nextProps, state) {\n      var newState = {};\n\n      if (dateInputInstance) {\n        cachedSelectionStart = dateInputInstance.selectionStart;\n        cachedSelectionEnd = dateInputInstance.selectionEnd;\n      } // when popup show, click body will call this, bug!\n\n\n      var selectedValue = nextProps.selectedValue;\n\n      if (!state.hasFocus) {\n        newState = {\n          str: formatDate(selectedValue, this.format),\n          invalid: false\n        };\n      }\n\n      return newState;\n    },\n    onClear: function onClear() {\n      this.setState({\n        str: ''\n      });\n\n      this.__emit('clear', null);\n    },\n    onInputChange: function onInputChange(e) {\n      var _e$target = e.target,\n          str = _e$target.value,\n          composing = _e$target.composing;\n      var _this$str = this.str,\n          oldStr = _this$str === void 0 ? '' : _this$str;\n      if (e.isComposing || composing || oldStr === str) return;\n      var _this$$props = this.$props,\n          disabledDate = _this$$props.disabledDate,\n          format = _this$$props.format,\n          selectedValue = _this$$props.selectedValue; // 没有内容，合法并直接退出\n\n      if (!str) {\n        this.__emit('change', null);\n\n        this.setState({\n          invalid: false,\n          str: str\n        });\n        return;\n      } // 不合法直接退出\n\n\n      var parsed = moment(str, format, true);\n\n      if (!parsed.isValid()) {\n        this.setState({\n          invalid: true,\n          str: str\n        });\n        return;\n      }\n\n      var value = this.value.clone();\n      value.year(parsed.year()).month(parsed.month()).date(parsed.date()).hour(parsed.hour()).minute(parsed.minute()).second(parsed.second());\n\n      if (!value || disabledDate && disabledDate(value)) {\n        this.setState({\n          invalid: true,\n          str: str\n        });\n        return;\n      }\n\n      if (selectedValue !== value || selectedValue && value && !selectedValue.isSame(value)) {\n        this.setState({\n          invalid: false,\n          str: str\n        });\n\n        this.__emit('change', value);\n      }\n    },\n    onFocus: function onFocus() {\n      this.setState({\n        hasFocus: true\n      });\n    },\n    onBlur: function onBlur() {\n      this.setState(function (prevState, prevProps) {\n        return {\n          hasFocus: false,\n          str: formatDate(prevProps.value, prevProps.format)\n        };\n      });\n    },\n    onKeyDown: function onKeyDown(event) {\n      var keyCode = event.keyCode;\n      var _this$$props2 = this.$props,\n          value = _this$$props2.value,\n          disabledDate = _this$$props2.disabledDate;\n\n      if (keyCode === KeyCode.ENTER) {\n        var validateDate = !disabledDate || !disabledDate(value);\n\n        if (validateDate) {\n          this.__emit('select', value.clone());\n        }\n\n        event.preventDefault();\n      }\n    },\n    getRootDOMNode: function getRootDOMNode() {\n      return findDOMNode(this);\n    },\n    focus: function focus() {\n      if (dateInputInstance) {\n        dateInputInstance.focus();\n      }\n    },\n    saveDateInput: function saveDateInput(dateInput) {\n      dateInputInstance = dateInput;\n    }\n  },\n  render: function render() {\n    var invalid = this.invalid,\n        str = this.str,\n        locale = this.locale,\n        prefixCls = this.prefixCls,\n        placeholder = this.placeholder,\n        disabled = this.disabled,\n        showClear = this.showClear,\n        inputMode = this.inputMode,\n        inputReadOnly = this.inputReadOnly;\n    var clearIcon = getComponent(this, 'clearIcon');\n    var invalidClass = invalid ? \"\".concat(prefixCls, \"-input-invalid\") : '';\n    return _createVNode(\"div\", {\n      \"class\": \"\".concat(prefixCls, \"-input-wrap\")\n    }, [_createVNode(\"div\", {\n      \"class\": \"\".concat(prefixCls, \"-date-input-wrap\")\n    }, [withDirectives(_createVNode(\"input\", {\n      \"ref\": this.saveDateInput,\n      \"class\": \"\".concat(prefixCls, \"-input \").concat(invalidClass),\n      \"value\": str,\n      \"disabled\": disabled,\n      \"placeholder\": placeholder,\n      \"onInput\": this.onInputChange,\n      \"onChange\": this.onInputChange,\n      \"onKeydown\": this.onKeyDown,\n      \"onFocus\": this.onFocus,\n      \"onBlur\": this.onBlur,\n      \"inputMode\": inputMode,\n      \"readonly\": inputReadOnly\n    }, null), [[antInput]])]), showClear ? _createVNode(\"a\", {\n      \"role\": \"button\",\n      \"title\": locale.clear,\n      \"onClick\": this.onClear\n    }, [clearIcon || _createVNode(\"span\", {\n      \"class\": \"\".concat(prefixCls, \"-clear-btn\")\n    }, null)]) : null]);\n  }\n};\nexport default DateInput;","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/node_modules/ant-design-vue/es/vc-calendar/src/date/DateInput.js"],"names":["createVNode","_createVNode","PropTypes","BaseMixin","getComponent","findDOMNode","moment","formatDate","KeyCode","withDirectives","antInput","cachedSelectionStart","cachedSelectionEnd","dateInputInstance","DateInput","name","inheritAttrs","mixins","props","prefixCls","string","timePicker","object","value","disabledTime","any","format","oneOfType","arrayOf","func","locale","disabledDate","placeholder","selectedValue","clearIcon","inputMode","inputReadOnly","looseBool","disabled","showClear","data","str","invalid","hasFocus","watch","setState","updated","_this","$nextTick","$data","setSelectionRange","getInstance","methods","getDerivedStateFromProps","nextProps","state","newState","selectionStart","selectionEnd","onClear","__emit","onInputChange","e","_e$target","target","composing","_this$str","oldStr","isComposing","_this$$props","$props","parsed","isValid","clone","year","month","date","hour","minute","second","isSame","onFocus","onBlur","prevState","prevProps","onKeyDown","event","keyCode","_this$$props2","ENTER","validateDate","preventDefault","getRootDOMNode","focus","saveDateInput","dateInput","render","invalidClass","concat","clear"],"mappings":"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","sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport PropTypes from '../../../_util/vue-types';\nimport BaseMixin from '../../../_util/BaseMixin';\nimport { getComponent, findDOMNode } from '../../../_util/props-util';\nimport moment from 'moment';\nimport { formatDate } from '../util';\nimport KeyCode from '../../../_util/KeyCode';\nimport { withDirectives } from 'vue';\nimport antInput from '../../../_util/antInputDirective';\nvar cachedSelectionStart;\nvar cachedSelectionEnd;\nvar dateInputInstance;\nvar DateInput = {\n  name: 'DateInput',\n  inheritAttrs: false,\n  mixins: [BaseMixin],\n  props: {\n    prefixCls: PropTypes.string,\n    timePicker: PropTypes.object,\n    value: PropTypes.object,\n    disabledTime: PropTypes.any,\n    format: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string), PropTypes.func]),\n    locale: PropTypes.object,\n    disabledDate: PropTypes.func,\n    // onChange: PropTypes.func,\n    // onClear: PropTypes.func,\n    placeholder: PropTypes.string,\n    // onSelect: PropTypes.func,\n    selectedValue: PropTypes.object,\n    clearIcon: PropTypes.any,\n    inputMode: PropTypes.string,\n    inputReadOnly: PropTypes.looseBool,\n    disabled: PropTypes.looseBool,\n    showClear: PropTypes.looseBool\n  },\n  data: function data() {\n    var selectedValue = this.selectedValue;\n    return {\n      str: formatDate(selectedValue, this.format),\n      invalid: false,\n      hasFocus: false\n    };\n  },\n  watch: {\n    selectedValue: function selectedValue() {\n      this.setState();\n    },\n    format: function format() {\n      this.setState();\n    }\n  },\n  updated: function updated() {\n    var _this = this;\n\n    this.$nextTick(function () {\n      if (dateInputInstance && _this.$data.hasFocus && !_this.invalid && !(cachedSelectionStart === 0 && cachedSelectionEnd === 0)) {\n        dateInputInstance.setSelectionRange(cachedSelectionStart, cachedSelectionEnd);\n      }\n    });\n  },\n  getInstance: function getInstance() {\n    return dateInputInstance;\n  },\n  methods: {\n    getDerivedStateFromProps: function getDerivedStateFromProps(nextProps, state) {\n      var newState = {};\n\n      if (dateInputInstance) {\n        cachedSelectionStart = dateInputInstance.selectionStart;\n        cachedSelectionEnd = dateInputInstance.selectionEnd;\n      } // when popup show, click body will call this, bug!\n\n\n      var selectedValue = nextProps.selectedValue;\n\n      if (!state.hasFocus) {\n        newState = {\n          str: formatDate(selectedValue, this.format),\n          invalid: false\n        };\n      }\n\n      return newState;\n    },\n    onClear: function onClear() {\n      this.setState({\n        str: ''\n      });\n\n      this.__emit('clear', null);\n    },\n    onInputChange: function onInputChange(e) {\n      var _e$target = e.target,\n          str = _e$target.value,\n          composing = _e$target.composing;\n      var _this$str = this.str,\n          oldStr = _this$str === void 0 ? '' : _this$str;\n      if (e.isComposing || composing || oldStr === str) return;\n      var _this$$props = this.$props,\n          disabledDate = _this$$props.disabledDate,\n          format = _this$$props.format,\n          selectedValue = _this$$props.selectedValue; // 没有内容，合法并直接退出\n\n      if (!str) {\n        this.__emit('change', null);\n\n        this.setState({\n          invalid: false,\n          str: str\n        });\n        return;\n      } // 不合法直接退出\n\n\n      var parsed = moment(str, format, true);\n\n      if (!parsed.isValid()) {\n        this.setState({\n          invalid: true,\n          str: str\n        });\n        return;\n      }\n\n      var value = this.value.clone();\n      value.year(parsed.year()).month(parsed.month()).date(parsed.date()).hour(parsed.hour()).minute(parsed.minute()).second(parsed.second());\n\n      if (!value || disabledDate && disabledDate(value)) {\n        this.setState({\n          invalid: true,\n          str: str\n        });\n        return;\n      }\n\n      if (selectedValue !== value || selectedValue && value && !selectedValue.isSame(value)) {\n        this.setState({\n          invalid: false,\n          str: str\n        });\n\n        this.__emit('change', value);\n      }\n    },\n    onFocus: function onFocus() {\n      this.setState({\n        hasFocus: true\n      });\n    },\n    onBlur: function onBlur() {\n      this.setState(function (prevState, prevProps) {\n        return {\n          hasFocus: false,\n          str: formatDate(prevProps.value, prevProps.format)\n        };\n      });\n    },\n    onKeyDown: function onKeyDown(event) {\n      var keyCode = event.keyCode;\n      var _this$$props2 = this.$props,\n          value = _this$$props2.value,\n          disabledDate = _this$$props2.disabledDate;\n\n      if (keyCode === KeyCode.ENTER) {\n        var validateDate = !disabledDate || !disabledDate(value);\n\n        if (validateDate) {\n          this.__emit('select', value.clone());\n        }\n\n        event.preventDefault();\n      }\n    },\n    getRootDOMNode: function getRootDOMNode() {\n      return findDOMNode(this);\n    },\n    focus: function focus() {\n      if (dateInputInstance) {\n        dateInputInstance.focus();\n      }\n    },\n    saveDateInput: function saveDateInput(dateInput) {\n      dateInputInstance = dateInput;\n    }\n  },\n  render: function render() {\n    var invalid = this.invalid,\n        str = this.str,\n        locale = this.locale,\n        prefixCls = this.prefixCls,\n        placeholder = this.placeholder,\n        disabled = this.disabled,\n        showClear = this.showClear,\n        inputMode = this.inputMode,\n        inputReadOnly = this.inputReadOnly;\n    var clearIcon = getComponent(this, 'clearIcon');\n    var invalidClass = invalid ? \"\".concat(prefixCls, \"-input-invalid\") : '';\n    return _createVNode(\"div\", {\n      \"class\": \"\".concat(prefixCls, \"-input-wrap\")\n    }, [_createVNode(\"div\", {\n      \"class\": \"\".concat(prefixCls, \"-date-input-wrap\")\n    }, [withDirectives(_createVNode(\"input\", {\n      \"ref\": this.saveDateInput,\n      \"class\": \"\".concat(prefixCls, \"-input \").concat(invalidClass),\n      \"value\": str,\n      \"disabled\": disabled,\n      \"placeholder\": placeholder,\n      \"onInput\": this.onInputChange,\n      \"onChange\": this.onInputChange,\n      \"onKeydown\": this.onKeyDown,\n      \"onFocus\": this.onFocus,\n      \"onBlur\": this.onBlur,\n      \"inputMode\": inputMode,\n      \"readonly\": inputReadOnly\n    }, null), [[antInput]])]), showClear ? _createVNode(\"a\", {\n      \"role\": \"button\",\n      \"title\": locale.clear,\n      \"onClick\": this.onClear\n    }, [clearIcon || _createVNode(\"span\", {\n      \"class\": \"\".concat(prefixCls, \"-clear-btn\")\n    }, null)]) : null]);\n  }\n};\nexport default DateInput;"]},"metadata":{},"sourceType":"module"}