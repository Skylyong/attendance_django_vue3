{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { watch } from 'vue';\nimport { defineComponent, computed, nextTick, ref, watchEffect, onBeforeUnmount } from 'vue';\nimport cloneDeep from 'lodash-es/cloneDeep';\nimport PropTypes from '../_util/vue-types';\nimport Row from '../grid/Row';\nimport { isValidElement, flattenChildren, filterEmpty } from '../_util/props-util';\nimport BaseMixin from '../_util/BaseMixin';\nimport { cloneElement } from '../_util/vnode';\nimport { validateRules as validateRulesUtil } from './utils/validateUtil';\nimport { getNamePath } from './utils/valueUtil';\nimport { toArray } from './utils/typeUtil';\nimport { warning } from '../vc-util/warning';\nimport find from 'lodash-es/find';\nimport { tuple } from '../_util/type';\nimport useConfigInject from '../_util/hooks/useConfigInject';\nimport { useInjectForm } from './context';\nimport FormItemLabel from './FormItemLabel';\nimport FormItemInput from './FormItemInput';\nvar ValidateStatuses = tuple('success', 'warning', 'error', 'validating', '');\n\nfunction getPropByPath(obj, namePathList, strict) {\n  var tempObj = obj;\n  var keyArr = namePathList;\n  var i = 0;\n\n  try {\n    for (var len = keyArr.length; i < len - 1; ++i) {\n      if (!tempObj && !strict) break;\n      var key = keyArr[i];\n\n      if (key in tempObj) {\n        tempObj = tempObj[key];\n      } else {\n        if (strict) {\n          throw Error('please transfer a valid name path to form item!');\n        }\n\n        break;\n      }\n    }\n\n    if (strict && !tempObj) {\n      throw Error('please transfer a valid name path to form item!');\n    }\n  } catch (error) {\n    console.error('please transfer a valid name path to form item!');\n  }\n\n  return {\n    o: tempObj,\n    k: keyArr[i],\n    v: tempObj ? tempObj[keyArr[i]] : undefined\n  };\n}\n\nexport var formItemProps = {\n  id: PropTypes.string,\n  htmlFor: PropTypes.string,\n  prefixCls: PropTypes.string,\n  label: PropTypes.VNodeChild,\n  help: PropTypes.VNodeChild,\n  extra: PropTypes.VNodeChild,\n  labelCol: {\n    type: Object\n  },\n  wrapperCol: {\n    type: Object\n  },\n  hasFeedback: PropTypes.looseBool.def(false),\n  colon: PropTypes.looseBool,\n  labelAlign: PropTypes.oneOf(tuple('left', 'right')),\n  prop: {\n    type: [String, Number, Array]\n  },\n  name: {\n    type: [String, Number, Array]\n  },\n  rules: PropTypes.oneOfType([Array, Object]),\n  autoLink: PropTypes.looseBool.def(true),\n  required: PropTypes.looseBool,\n  validateFirst: PropTypes.looseBool,\n  validateStatus: PropTypes.oneOf(tuple('', 'success', 'warning', 'error', 'validating')),\n  validateTrigger: {\n    type: [String, Array]\n  },\n  messageVariables: {\n    type: Object\n  },\n  hidden: Boolean\n};\nvar indexGuid = 0;\nexport default defineComponent({\n  name: 'AFormItem',\n  mixins: [BaseMixin],\n  inheritAttrs: false,\n  __ANT_NEW_FORM_ITEM: true,\n  props: formItemProps,\n  slots: ['help', 'label', 'extra'],\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n        attrs = _ref.attrs,\n        expose = _ref.expose;\n    warning(props.prop === undefined, \"`prop` is deprecated. Please use `name` instead.\");\n    var eventKey = \"form-item-\".concat(++indexGuid);\n\n    var _useConfigInject = useConfigInject('form', props),\n        prefixCls = _useConfigInject.prefixCls;\n\n    var formContext = useInjectForm();\n    var fieldName = computed(function () {\n      return props.name || props.prop;\n    });\n    var errors = ref([]);\n    var validateDisabled = ref(false);\n    var domErrorVisible = ref(false);\n    var inputRef = ref();\n    var namePath = computed(function () {\n      var val = fieldName.value;\n      return getNamePath(val);\n    });\n    var fieldId = computed(function () {\n      var id = props.id;\n\n      if (id) {\n        return id;\n      } else if (!namePath.value.length) {\n        return undefined;\n      } else {\n        var formName = formContext.name.value;\n        var mergedId = namePath.value.join('_');\n        return formName ? \"\".concat(formName, \"_\").concat(mergedId) : mergedId;\n      }\n    });\n    var fieldValue = computed(function () {\n      var model = formContext.model.value;\n\n      if (!model || !fieldName.value) {\n        return;\n      }\n\n      return getPropByPath(model, namePath.value, true).v;\n    });\n    var initialValue = ref(cloneDeep(fieldValue.value));\n    var mergedValidateTrigger = computed(function () {\n      var validateTrigger = props.validateTrigger !== undefined ? props.validateTrigger : formContext.validateTrigger.value;\n      validateTrigger = validateTrigger === undefined ? 'change' : validateTrigger;\n      return toArray(validateTrigger);\n    });\n    var rulesRef = computed(function () {\n      var formRules = formContext.rules.value;\n      var selfRules = props.rules;\n      var requiredRule = props.required !== undefined ? {\n        required: !!props.required,\n        trigger: mergedValidateTrigger.value\n      } : [];\n      var prop = getPropByPath(formRules, namePath.value);\n      formRules = formRules ? prop.o[prop.k] || prop.v : [];\n      var rules = [].concat(selfRules || formRules || []);\n\n      if (find(rules, function (rule) {\n        return rule.required;\n      })) {\n        return rules;\n      } else {\n        return rules.concat(requiredRule);\n      }\n    });\n    var isRequired = computed(function () {\n      var rules = rulesRef.value;\n      var isRequired = false;\n\n      if (rules && rules.length) {\n        rules.every(function (rule) {\n          if (rule.required) {\n            isRequired = true;\n            return false;\n          }\n\n          return true;\n        });\n      }\n\n      return isRequired || props.required;\n    });\n    var validateState = ref();\n    watchEffect(function () {\n      validateState.value = props.validateStatus;\n    });\n\n    var validateRules = function validateRules(options) {\n      var _props$validateFirst = props.validateFirst,\n          validateFirst = _props$validateFirst === void 0 ? false : _props$validateFirst,\n          messageVariables = props.messageVariables;\n\n      var _ref2 = options || {},\n          triggerName = _ref2.triggerName;\n\n      var filteredRules = rulesRef.value;\n\n      if (triggerName) {\n        filteredRules = filteredRules.filter(function (rule) {\n          var trigger = rule.trigger;\n\n          if (!trigger && !mergedValidateTrigger.value.length) {\n            return true;\n          }\n\n          var triggerList = toArray(trigger || mergedValidateTrigger.value);\n          return triggerList.includes(triggerName);\n        });\n      }\n\n      if (!filteredRules.length) {\n        return Promise.resolve();\n      }\n\n      var promise = validateRulesUtil(namePath.value, fieldValue.value, filteredRules, options, validateFirst, messageVariables);\n      validateState.value = 'validating';\n      errors.value = [];\n      promise.catch(function (e) {\n        return e;\n      }).then(function () {\n        var results = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n        if (validateState.value === 'validating') {\n          var res = results.filter(function (result) {\n            return result && result.errors.length;\n          });\n          validateState.value = res.length ? 'error' : 'success';\n          errors.value = res.map(function (r) {\n            return r.errors;\n          });\n        }\n      });\n      return promise;\n    };\n\n    var onFieldBlur = function onFieldBlur() {\n      validateRules({\n        triggerName: 'blur'\n      });\n    };\n\n    var onFieldChange = function onFieldChange() {\n      if (validateDisabled.value) {\n        validateDisabled.value = false;\n        return;\n      }\n\n      validateRules({\n        triggerName: 'change'\n      });\n    };\n\n    var clearValidate = function clearValidate() {\n      validateState.value = '';\n      validateDisabled.value = false;\n      errors.value = [];\n    };\n\n    var resetField = function resetField() {\n      validateState.value = '';\n      validateDisabled.value = true;\n      errors.value = [];\n      var model = formContext.model.value || {};\n      var value = fieldValue.value;\n      var prop = getPropByPath(model, namePath.value, true);\n\n      if (Array.isArray(value)) {\n        prop.o[prop.k] = [].concat(initialValue.value);\n      } else {\n        prop.o[prop.k] = initialValue.value;\n      } // reset validateDisabled after onFieldChange triggered\n\n\n      nextTick(function () {\n        validateDisabled.value = false;\n      });\n    };\n\n    var onLabelClick = function onLabelClick() {\n      var id = fieldId.value;\n\n      if (!id || !inputRef.value) {\n        return;\n      }\n\n      var control = inputRef.value.$el.querySelector(\"[id=\\\"\".concat(id, \"\\\"]\"));\n\n      if (control && control.focus) {\n        control.focus();\n      }\n    };\n\n    expose({\n      onFieldBlur: onFieldBlur,\n      onFieldChange: onFieldChange,\n      clearValidate: clearValidate,\n      resetField: resetField\n    });\n    var registered = false;\n    watch(fieldName, function (val) {\n      if (val) {\n        if (!registered) {\n          registered = true;\n          formContext.addField(eventKey, {\n            fieldValue: fieldValue,\n            fieldId: fieldId,\n            fieldName: fieldName,\n            resetField: resetField,\n            clearValidate: clearValidate,\n            namePath: namePath,\n            validateRules: validateRules,\n            rules: rulesRef\n          });\n        }\n      } else {\n        registered = false;\n        formContext.removeField(eventKey);\n      }\n    }, {\n      immediate: true\n    });\n    onBeforeUnmount(function () {\n      formContext.removeField(eventKey);\n    }); // const onHelpAnimEnd = (_key: string, helpShow: boolean) => {\n    //   this.helpShow = helpShow;\n    //   if (!helpShow) {\n    //     this.$forceUpdate();\n    //   }\n    // };\n\n    var itemClassName = computed(function () {\n      var _ref3;\n\n      return _ref3 = {}, _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item\"), true), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-feedback\"), validateState.value && props.hasFeedback), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-success\"), validateState.value === 'success'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-warning\"), validateState.value === 'warning'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-error\"), validateState.value === 'error'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-is-validating\"), validateState.value === 'validating'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-hidden\"), props.hidden), _ref3;\n    });\n    return function () {\n      var _a, _b, _c, _d, _e, _f;\n\n      var help = (_a = props.help) !== null && _a !== void 0 ? _a : slots.help ? filterEmpty(slots.help()) : null;\n      var children = flattenChildren((_b = slots.default) === null || _b === void 0 ? void 0 : _b.call(slots));\n      var firstChildren = children[0];\n\n      if (fieldName.value && props.autoLink && isValidElement(firstChildren)) {\n        var originalEvents = firstChildren.props || {};\n        var originalBlur = originalEvents.onBlur;\n        var originalChange = originalEvents.onChange;\n        firstChildren = cloneElement(firstChildren, _extends(_extends({}, fieldId.value ? {\n          id: fieldId.value\n        } : undefined), {\n          onBlur: function onBlur() {\n            if (Array.isArray(originalChange)) {\n              for (var i = 0, l = originalChange.length; i < l; i++) {\n                originalBlur[i].apply(originalBlur, arguments);\n              }\n            } else if (originalBlur) {\n              originalBlur.apply(void 0, arguments);\n            }\n\n            onFieldBlur();\n          },\n          onChange: function onChange() {\n            if (Array.isArray(originalChange)) {\n              for (var i = 0, l = originalChange.length; i < l; i++) {\n                originalChange[i].apply(originalChange, arguments);\n              }\n            } else if (originalChange) {\n              originalChange.apply(void 0, arguments);\n            }\n\n            onFieldChange();\n          }\n        }));\n      }\n\n      return _createVNode(Row, _objectSpread(_objectSpread({}, attrs), {}, {\n        \"class\": [itemClassName.value, domErrorVisible.value || !!help ? \"\".concat(prefixCls.value, \"-item-with-help\") : '', attrs.class],\n        \"key\": \"row\"\n      }), {\n        default: function _default() {\n          return [_createVNode(FormItemLabel, _objectSpread(_objectSpread({}, props), {}, {\n            \"htmlFor\": fieldId.value,\n            \"required\": isRequired.value,\n            \"requiredMark\": formContext.requiredMark.value,\n            \"prefixCls\": prefixCls.value,\n            \"onClick\": onLabelClick,\n            \"label\": (_c = props.label) !== null && _c !== void 0 ? _c : (_d = slots.label) === null || _d === void 0 ? void 0 : _d.call(slots)\n          }), null), _createVNode(FormItemInput, _objectSpread(_objectSpread({}, props), {}, {\n            \"errors\": help !== undefined && help !== null ? toArray(help) : errors.value,\n            \"prefixCls\": prefixCls.value,\n            \"status\": validateState.value,\n            \"onDomErrorVisibleChange\": function onDomErrorVisibleChange(v) {\n              return domErrorVisible.value = v;\n            },\n            \"validateStatus\": validateState.value,\n            \"ref\": inputRef,\n            \"help\": help,\n            \"extra\": (_e = props.extra) !== null && _e !== void 0 ? _e : (_f = slots.extra) === null || _f === void 0 ? void 0 : _f.call(slots)\n          }), {\n            default: function _default() {\n              return [[firstChildren, children.slice(1)]];\n            }\n          })];\n        }\n      });\n    };\n  }\n});","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/node_modules/ant-design-vue/es/form/FormItem.js"],"names":["_objectSpread","_extends","_defineProperty","createVNode","_createVNode","watch","defineComponent","computed","nextTick","ref","watchEffect","onBeforeUnmount","cloneDeep","PropTypes","Row","isValidElement","flattenChildren","filterEmpty","BaseMixin","cloneElement","validateRules","validateRulesUtil","getNamePath","toArray","warning","find","tuple","useConfigInject","useInjectForm","FormItemLabel","FormItemInput","ValidateStatuses","getPropByPath","obj","namePathList","strict","tempObj","keyArr","i","len","length","key","Error","error","console","o","k","v","undefined","formItemProps","id","string","htmlFor","prefixCls","label","VNodeChild","help","extra","labelCol","type","Object","wrapperCol","hasFeedback","looseBool","def","colon","labelAlign","oneOf","prop","String","Number","Array","name","rules","oneOfType","autoLink","required","validateFirst","validateStatus","validateTrigger","messageVariables","hidden","Boolean","indexGuid","mixins","inheritAttrs","__ANT_NEW_FORM_ITEM","props","slots","setup","_ref","attrs","expose","eventKey","concat","_useConfigInject","formContext","fieldName","errors","validateDisabled","domErrorVisible","inputRef","namePath","val","value","fieldId","formName","mergedId","join","fieldValue","model","initialValue","mergedValidateTrigger","rulesRef","formRules","selfRules","requiredRule","trigger","rule","isRequired","every","validateState","options","_props$validateFirst","_ref2","triggerName","filteredRules","filter","triggerList","includes","Promise","resolve","promise","catch","e","then","results","arguments","res","result","map","r","onFieldBlur","onFieldChange","clearValidate","resetField","isArray","onLabelClick","control","$el","querySelector","focus","registered","addField","removeField","immediate","itemClassName","_ref3","_a","_b","_c","_d","_e","_f","children","default","call","firstChildren","originalEvents","originalBlur","onBlur","originalChange","onChange","l","apply","class","_default","requiredMark","onDomErrorVisibleChange","slice"],"mappings":"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","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { watch } from 'vue';\nimport { defineComponent, computed, nextTick, ref, watchEffect, onBeforeUnmount } from 'vue';\nimport cloneDeep from 'lodash-es/cloneDeep';\nimport PropTypes from '../_util/vue-types';\nimport Row from '../grid/Row';\nimport { isValidElement, flattenChildren, filterEmpty } from '../_util/props-util';\nimport BaseMixin from '../_util/BaseMixin';\nimport { cloneElement } from '../_util/vnode';\nimport { validateRules as validateRulesUtil } from './utils/validateUtil';\nimport { getNamePath } from './utils/valueUtil';\nimport { toArray } from './utils/typeUtil';\nimport { warning } from '../vc-util/warning';\nimport find from 'lodash-es/find';\nimport { tuple } from '../_util/type';\nimport useConfigInject from '../_util/hooks/useConfigInject';\nimport { useInjectForm } from './context';\nimport FormItemLabel from './FormItemLabel';\nimport FormItemInput from './FormItemInput';\nvar ValidateStatuses = tuple('success', 'warning', 'error', 'validating', '');\n\nfunction getPropByPath(obj, namePathList, strict) {\n  var tempObj = obj;\n  var keyArr = namePathList;\n  var i = 0;\n\n  try {\n    for (var len = keyArr.length; i < len - 1; ++i) {\n      if (!tempObj && !strict) break;\n      var key = keyArr[i];\n\n      if (key in tempObj) {\n        tempObj = tempObj[key];\n      } else {\n        if (strict) {\n          throw Error('please transfer a valid name path to form item!');\n        }\n\n        break;\n      }\n    }\n\n    if (strict && !tempObj) {\n      throw Error('please transfer a valid name path to form item!');\n    }\n  } catch (error) {\n    console.error('please transfer a valid name path to form item!');\n  }\n\n  return {\n    o: tempObj,\n    k: keyArr[i],\n    v: tempObj ? tempObj[keyArr[i]] : undefined\n  };\n}\n\nexport var formItemProps = {\n  id: PropTypes.string,\n  htmlFor: PropTypes.string,\n  prefixCls: PropTypes.string,\n  label: PropTypes.VNodeChild,\n  help: PropTypes.VNodeChild,\n  extra: PropTypes.VNodeChild,\n  labelCol: {\n    type: Object\n  },\n  wrapperCol: {\n    type: Object\n  },\n  hasFeedback: PropTypes.looseBool.def(false),\n  colon: PropTypes.looseBool,\n  labelAlign: PropTypes.oneOf(tuple('left', 'right')),\n  prop: {\n    type: [String, Number, Array]\n  },\n  name: {\n    type: [String, Number, Array]\n  },\n  rules: PropTypes.oneOfType([Array, Object]),\n  autoLink: PropTypes.looseBool.def(true),\n  required: PropTypes.looseBool,\n  validateFirst: PropTypes.looseBool,\n  validateStatus: PropTypes.oneOf(tuple('', 'success', 'warning', 'error', 'validating')),\n  validateTrigger: {\n    type: [String, Array]\n  },\n  messageVariables: {\n    type: Object\n  },\n  hidden: Boolean\n};\nvar indexGuid = 0;\nexport default defineComponent({\n  name: 'AFormItem',\n  mixins: [BaseMixin],\n  inheritAttrs: false,\n  __ANT_NEW_FORM_ITEM: true,\n  props: formItemProps,\n  slots: ['help', 'label', 'extra'],\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n        attrs = _ref.attrs,\n        expose = _ref.expose;\n    warning(props.prop === undefined, \"`prop` is deprecated. Please use `name` instead.\");\n    var eventKey = \"form-item-\".concat(++indexGuid);\n\n    var _useConfigInject = useConfigInject('form', props),\n        prefixCls = _useConfigInject.prefixCls;\n\n    var formContext = useInjectForm();\n    var fieldName = computed(function () {\n      return props.name || props.prop;\n    });\n    var errors = ref([]);\n    var validateDisabled = ref(false);\n    var domErrorVisible = ref(false);\n    var inputRef = ref();\n    var namePath = computed(function () {\n      var val = fieldName.value;\n      return getNamePath(val);\n    });\n    var fieldId = computed(function () {\n      var id = props.id;\n\n      if (id) {\n        return id;\n      } else if (!namePath.value.length) {\n        return undefined;\n      } else {\n        var formName = formContext.name.value;\n        var mergedId = namePath.value.join('_');\n        return formName ? \"\".concat(formName, \"_\").concat(mergedId) : mergedId;\n      }\n    });\n    var fieldValue = computed(function () {\n      var model = formContext.model.value;\n\n      if (!model || !fieldName.value) {\n        return;\n      }\n\n      return getPropByPath(model, namePath.value, true).v;\n    });\n    var initialValue = ref(cloneDeep(fieldValue.value));\n    var mergedValidateTrigger = computed(function () {\n      var validateTrigger = props.validateTrigger !== undefined ? props.validateTrigger : formContext.validateTrigger.value;\n      validateTrigger = validateTrigger === undefined ? 'change' : validateTrigger;\n      return toArray(validateTrigger);\n    });\n    var rulesRef = computed(function () {\n      var formRules = formContext.rules.value;\n      var selfRules = props.rules;\n      var requiredRule = props.required !== undefined ? {\n        required: !!props.required,\n        trigger: mergedValidateTrigger.value\n      } : [];\n      var prop = getPropByPath(formRules, namePath.value);\n      formRules = formRules ? prop.o[prop.k] || prop.v : [];\n      var rules = [].concat(selfRules || formRules || []);\n\n      if (find(rules, function (rule) {\n        return rule.required;\n      })) {\n        return rules;\n      } else {\n        return rules.concat(requiredRule);\n      }\n    });\n    var isRequired = computed(function () {\n      var rules = rulesRef.value;\n      var isRequired = false;\n\n      if (rules && rules.length) {\n        rules.every(function (rule) {\n          if (rule.required) {\n            isRequired = true;\n            return false;\n          }\n\n          return true;\n        });\n      }\n\n      return isRequired || props.required;\n    });\n    var validateState = ref();\n    watchEffect(function () {\n      validateState.value = props.validateStatus;\n    });\n\n    var validateRules = function validateRules(options) {\n      var _props$validateFirst = props.validateFirst,\n          validateFirst = _props$validateFirst === void 0 ? false : _props$validateFirst,\n          messageVariables = props.messageVariables;\n\n      var _ref2 = options || {},\n          triggerName = _ref2.triggerName;\n\n      var filteredRules = rulesRef.value;\n\n      if (triggerName) {\n        filteredRules = filteredRules.filter(function (rule) {\n          var trigger = rule.trigger;\n\n          if (!trigger && !mergedValidateTrigger.value.length) {\n            return true;\n          }\n\n          var triggerList = toArray(trigger || mergedValidateTrigger.value);\n          return triggerList.includes(triggerName);\n        });\n      }\n\n      if (!filteredRules.length) {\n        return Promise.resolve();\n      }\n\n      var promise = validateRulesUtil(namePath.value, fieldValue.value, filteredRules, options, validateFirst, messageVariables);\n      validateState.value = 'validating';\n      errors.value = [];\n      promise.catch(function (e) {\n        return e;\n      }).then(function () {\n        var results = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n        if (validateState.value === 'validating') {\n          var res = results.filter(function (result) {\n            return result && result.errors.length;\n          });\n          validateState.value = res.length ? 'error' : 'success';\n          errors.value = res.map(function (r) {\n            return r.errors;\n          });\n        }\n      });\n      return promise;\n    };\n\n    var onFieldBlur = function onFieldBlur() {\n      validateRules({\n        triggerName: 'blur'\n      });\n    };\n\n    var onFieldChange = function onFieldChange() {\n      if (validateDisabled.value) {\n        validateDisabled.value = false;\n        return;\n      }\n\n      validateRules({\n        triggerName: 'change'\n      });\n    };\n\n    var clearValidate = function clearValidate() {\n      validateState.value = '';\n      validateDisabled.value = false;\n      errors.value = [];\n    };\n\n    var resetField = function resetField() {\n      validateState.value = '';\n      validateDisabled.value = true;\n      errors.value = [];\n      var model = formContext.model.value || {};\n      var value = fieldValue.value;\n      var prop = getPropByPath(model, namePath.value, true);\n\n      if (Array.isArray(value)) {\n        prop.o[prop.k] = [].concat(initialValue.value);\n      } else {\n        prop.o[prop.k] = initialValue.value;\n      } // reset validateDisabled after onFieldChange triggered\n\n\n      nextTick(function () {\n        validateDisabled.value = false;\n      });\n    };\n\n    var onLabelClick = function onLabelClick() {\n      var id = fieldId.value;\n\n      if (!id || !inputRef.value) {\n        return;\n      }\n\n      var control = inputRef.value.$el.querySelector(\"[id=\\\"\".concat(id, \"\\\"]\"));\n\n      if (control && control.focus) {\n        control.focus();\n      }\n    };\n\n    expose({\n      onFieldBlur: onFieldBlur,\n      onFieldChange: onFieldChange,\n      clearValidate: clearValidate,\n      resetField: resetField\n    });\n    var registered = false;\n    watch(fieldName, function (val) {\n      if (val) {\n        if (!registered) {\n          registered = true;\n          formContext.addField(eventKey, {\n            fieldValue: fieldValue,\n            fieldId: fieldId,\n            fieldName: fieldName,\n            resetField: resetField,\n            clearValidate: clearValidate,\n            namePath: namePath,\n            validateRules: validateRules,\n            rules: rulesRef\n          });\n        }\n      } else {\n        registered = false;\n        formContext.removeField(eventKey);\n      }\n    }, {\n      immediate: true\n    });\n    onBeforeUnmount(function () {\n      formContext.removeField(eventKey);\n    }); // const onHelpAnimEnd = (_key: string, helpShow: boolean) => {\n    //   this.helpShow = helpShow;\n    //   if (!helpShow) {\n    //     this.$forceUpdate();\n    //   }\n    // };\n\n    var itemClassName = computed(function () {\n      var _ref3;\n\n      return _ref3 = {}, _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item\"), true), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-feedback\"), validateState.value && props.hasFeedback), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-success\"), validateState.value === 'success'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-warning\"), validateState.value === 'warning'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-has-error\"), validateState.value === 'error'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-is-validating\"), validateState.value === 'validating'), _defineProperty(_ref3, \"\".concat(prefixCls.value, \"-item-hidden\"), props.hidden), _ref3;\n    });\n    return function () {\n      var _a, _b, _c, _d, _e, _f;\n\n      var help = (_a = props.help) !== null && _a !== void 0 ? _a : slots.help ? filterEmpty(slots.help()) : null;\n      var children = flattenChildren((_b = slots.default) === null || _b === void 0 ? void 0 : _b.call(slots));\n      var firstChildren = children[0];\n\n      if (fieldName.value && props.autoLink && isValidElement(firstChildren)) {\n        var originalEvents = firstChildren.props || {};\n        var originalBlur = originalEvents.onBlur;\n        var originalChange = originalEvents.onChange;\n        firstChildren = cloneElement(firstChildren, _extends(_extends({}, fieldId.value ? {\n          id: fieldId.value\n        } : undefined), {\n          onBlur: function onBlur() {\n            if (Array.isArray(originalChange)) {\n              for (var i = 0, l = originalChange.length; i < l; i++) {\n                originalBlur[i].apply(originalBlur, arguments);\n              }\n            } else if (originalBlur) {\n              originalBlur.apply(void 0, arguments);\n            }\n\n            onFieldBlur();\n          },\n          onChange: function onChange() {\n            if (Array.isArray(originalChange)) {\n              for (var i = 0, l = originalChange.length; i < l; i++) {\n                originalChange[i].apply(originalChange, arguments);\n              }\n            } else if (originalChange) {\n              originalChange.apply(void 0, arguments);\n            }\n\n            onFieldChange();\n          }\n        }));\n      }\n\n      return _createVNode(Row, _objectSpread(_objectSpread({}, attrs), {}, {\n        \"class\": [itemClassName.value, domErrorVisible.value || !!help ? \"\".concat(prefixCls.value, \"-item-with-help\") : '', attrs.class],\n        \"key\": \"row\"\n      }), {\n        default: function _default() {\n          return [_createVNode(FormItemLabel, _objectSpread(_objectSpread({}, props), {}, {\n            \"htmlFor\": fieldId.value,\n            \"required\": isRequired.value,\n            \"requiredMark\": formContext.requiredMark.value,\n            \"prefixCls\": prefixCls.value,\n            \"onClick\": onLabelClick,\n            \"label\": (_c = props.label) !== null && _c !== void 0 ? _c : (_d = slots.label) === null || _d === void 0 ? void 0 : _d.call(slots)\n          }), null), _createVNode(FormItemInput, _objectSpread(_objectSpread({}, props), {}, {\n            \"errors\": help !== undefined && help !== null ? toArray(help) : errors.value,\n            \"prefixCls\": prefixCls.value,\n            \"status\": validateState.value,\n            \"onDomErrorVisibleChange\": function onDomErrorVisibleChange(v) {\n              return domErrorVisible.value = v;\n            },\n            \"validateStatus\": validateState.value,\n            \"ref\": inputRef,\n            \"help\": help,\n            \"extra\": (_e = props.extra) !== null && _e !== void 0 ? _e : (_f = slots.extra) === null || _f === void 0 ? void 0 : _f.call(slots)\n          }), {\n            default: function _default() {\n              return [[firstChildren, children.slice(1)]];\n            }\n          })];\n        }\n      });\n    };\n  }\n});"]},"metadata":{},"sourceType":"module"}