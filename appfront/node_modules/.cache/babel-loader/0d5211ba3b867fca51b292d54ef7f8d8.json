{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { computed, defineComponent, ref, inject, watchEffect, watch, onMounted, unref } from 'vue';\nimport shallowEqual from '../../_util/shallowequal';\nimport useProvideMenu, { MenuContextProvider, useProvideFirstLevel } from './hooks/useMenuContext';\nimport useConfigInject from '../../_util/hooks/useConfigInject';\nimport devWarning from '../../vc-util/devWarning';\nimport { collapseMotion } from '../../_util/transition';\nimport uniq from 'lodash-es/uniq';\nimport { SiderCollapsedKey } from '../../layout/injectionKey';\nimport { flattenChildren } from '../../_util/props-util';\nimport Overflow from '../../vc-overflow';\nimport MenuItem from './MenuItem';\nimport SubMenu from './SubMenu';\nimport EllipsisOutlined from '@ant-design/icons-vue/EllipsisOutlined';\nexport var menuProps = {\n  prefixCls: String,\n  disabled: Boolean,\n  inlineCollapsed: Boolean,\n  disabledOverflow: Boolean,\n  openKeys: Array,\n  selectedKeys: Array,\n  activeKey: String,\n  selectable: {\n    type: Boolean,\n    default: true\n  },\n  multiple: {\n    type: Boolean,\n    default: false\n  },\n  motion: Object,\n  theme: {\n    type: String,\n    default: 'light'\n  },\n  mode: {\n    type: String,\n    default: 'vertical'\n  },\n  inlineIndent: {\n    type: Number,\n    default: 24\n  },\n  subMenuOpenDelay: {\n    type: Number,\n    default: 0.1\n  },\n  subMenuCloseDelay: {\n    type: Number,\n    default: 0.1\n  },\n  builtinPlacements: {\n    type: Object\n  },\n  triggerSubMenuAction: {\n    type: String,\n    default: 'hover'\n  },\n  getPopupContainer: Function,\n  expandIcon: Function\n};\nvar EMPTY_LIST = [];\nexport default defineComponent({\n  name: 'AMenu',\n  props: menuProps,\n  emits: ['update:openKeys', 'openChange', 'select', 'deselect', 'update:selectedKeys', 'click', 'update:activeKey'],\n  slots: ['expandIcon', 'overflowedIndicator'],\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n        emit = _ref.emit;\n\n    var _useConfigInject = useConfigInject('menu', props),\n        prefixCls = _useConfigInject.prefixCls,\n        direction = _useConfigInject.direction;\n\n    var store = ref({});\n    var siderCollapsed = inject(SiderCollapsedKey, ref(undefined));\n    var inlineCollapsed = computed(function () {\n      if (siderCollapsed.value !== undefined) {\n        return siderCollapsed.value;\n      }\n\n      return props.inlineCollapsed;\n    });\n    var isMounted = ref(false);\n    onMounted(function () {\n      isMounted.value = true;\n    });\n    watchEffect(function () {\n      devWarning(!(props.inlineCollapsed === true && props.mode !== 'inline'), 'Menu', '`inlineCollapsed` should only be used when `mode` is inline.');\n      devWarning(!(siderCollapsed.value !== undefined && props.inlineCollapsed === true), 'Menu', '`inlineCollapsed` not control Menu under Sider. Should set `collapsed` on Sider instead.');\n    });\n    var activeKeys = ref([]);\n    var mergedSelectedKeys = ref([]);\n    var keyMapStore = ref({});\n    watch(store, function () {\n      var newKeyMapStore = {};\n\n      for (var _i = 0, _Object$values = Object.values(store.value); _i < _Object$values.length; _i++) {\n        var menuInfo = _Object$values[_i];\n        newKeyMapStore[menuInfo.key] = menuInfo;\n      }\n\n      keyMapStore.value = newKeyMapStore;\n    }, {\n      flush: 'post'\n    });\n    watchEffect(function () {\n      if (props.activeKey !== undefined) {\n        var keys = [];\n        var menuInfo = props.activeKey ? keyMapStore.value[props.activeKey] : undefined;\n\n        if (menuInfo && props.activeKey !== undefined) {\n          keys = [].concat(_toConsumableArray(menuInfo.parentKeys), [props.activeKey]);\n        } else {\n          keys = [];\n        }\n\n        if (!shallowEqual(activeKeys.value, keys)) {\n          activeKeys.value = keys;\n        }\n      }\n    });\n    watch(function () {\n      return props.selectedKeys;\n    }, function (selectedKeys) {\n      mergedSelectedKeys.value = selectedKeys || mergedSelectedKeys.value;\n    }, {\n      immediate: true\n    });\n    var selectedSubMenuEventKeys = ref([]);\n    watch([keyMapStore, mergedSelectedKeys], function () {\n      var subMenuParentEventKeys = [];\n      mergedSelectedKeys.value.forEach(function (key) {\n        var menuInfo = keyMapStore.value[key];\n\n        if (menuInfo) {\n          var _subMenuParentEventKe;\n\n          (_subMenuParentEventKe = subMenuParentEventKeys).push.apply(_subMenuParentEventKe, _toConsumableArray(unref(menuInfo.parentEventKeys)));\n        }\n      });\n      subMenuParentEventKeys = uniq(subMenuParentEventKeys);\n\n      if (!shallowEqual(selectedSubMenuEventKeys.value, subMenuParentEventKeys)) {\n        selectedSubMenuEventKeys.value = subMenuParentEventKeys;\n      }\n    }, {\n      immediate: true\n    }); // >>>>> Trigger select\n\n    var triggerSelection = function triggerSelection(info) {\n      if (!props.selectable) {\n        return;\n      } // Insert or Remove\n\n\n      var targetKey = info.key;\n      var exist = mergedSelectedKeys.value.includes(targetKey);\n      var newSelectedKeys;\n\n      if (props.multiple) {\n        if (exist) {\n          newSelectedKeys = mergedSelectedKeys.value.filter(function (key) {\n            return key !== targetKey;\n          });\n        } else {\n          newSelectedKeys = [].concat(_toConsumableArray(mergedSelectedKeys.value), [targetKey]);\n        }\n      } else {\n        newSelectedKeys = [targetKey];\n      } // Trigger event\n\n\n      var selectInfo = _extends(_extends({}, info), {\n        selectedKeys: newSelectedKeys\n      });\n\n      if (!shallowEqual(newSelectedKeys, mergedSelectedKeys.value)) {\n        if (props.selectedKeys === undefined) {\n          mergedSelectedKeys.value = newSelectedKeys;\n        }\n\n        emit('update:selectedKeys', newSelectedKeys);\n\n        if (exist && props.multiple) {\n          emit('deselect', selectInfo);\n        } else {\n          emit('select', selectInfo);\n        }\n      }\n\n      if (mergedMode.value !== 'inline' && !props.multiple && mergedOpenKeys.value.length) {\n        triggerOpenKeys(EMPTY_LIST);\n      }\n    };\n\n    var mergedOpenKeys = ref([]);\n    watch(function () {\n      return props.openKeys;\n    }, function () {\n      var openKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : mergedOpenKeys.value;\n\n      if (!shallowEqual(mergedOpenKeys.value, openKeys)) {\n        mergedOpenKeys.value = openKeys;\n      }\n    }, {\n      immediate: true\n    });\n    var timeout;\n\n    var changeActiveKeys = function changeActiveKeys(keys) {\n      window.clearTimeout(timeout);\n      timeout = window.setTimeout(function () {\n        if (props.activeKey === undefined) {\n          activeKeys.value = keys;\n        }\n\n        emit('update:activeKey', keys[keys.length - 1]);\n      });\n    };\n\n    var disabled = computed(function () {\n      return !!props.disabled;\n    });\n    var isRtl = computed(function () {\n      return direction.value === 'rtl';\n    });\n    var mergedMode = ref('vertical');\n    var mergedInlineCollapsed = ref(false);\n    watchEffect(function () {\n      if ((props.mode === 'inline' || props.mode === 'vertical') && inlineCollapsed.value) {\n        mergedMode.value = 'vertical';\n        mergedInlineCollapsed.value = inlineCollapsed.value;\n      } else {\n        mergedMode.value = props.mode;\n        mergedInlineCollapsed.value = false;\n      }\n    });\n    var isInlineMode = computed(function () {\n      return mergedMode.value === 'inline';\n    });\n\n    var triggerOpenKeys = function triggerOpenKeys(keys) {\n      mergedOpenKeys.value = keys;\n      emit('update:openKeys', keys);\n      emit('openChange', keys);\n    }; // >>>>> Cache & Reset open keys when inlineCollapsed changed\n\n\n    var inlineCacheOpenKeys = ref(mergedOpenKeys.value);\n    var mountRef = ref(false); // Cache\n\n    watch(mergedOpenKeys, function () {\n      if (isInlineMode.value) {\n        inlineCacheOpenKeys.value = mergedOpenKeys.value;\n      }\n    }, {\n      immediate: true\n    }); // Restore\n\n    watch(isInlineMode, function () {\n      if (!mountRef.value) {\n        mountRef.value = true;\n        return;\n      }\n\n      if (isInlineMode.value) {\n        mergedOpenKeys.value = inlineCacheOpenKeys.value;\n      } else {\n        // Trigger open event in case its in control\n        triggerOpenKeys(EMPTY_LIST);\n      }\n    }, {\n      immediate: true\n    });\n    var className = computed(function () {\n      var _ref2;\n\n      return _ref2 = {}, _defineProperty(_ref2, \"\".concat(prefixCls.value), true), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-root\"), true), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-\").concat(mergedMode.value), true), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-inline-collapsed\"), mergedInlineCollapsed.value), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-rtl\"), isRtl.value), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-\").concat(props.theme), true), _ref2;\n    });\n    var defaultMotions = {\n      horizontal: {\n        name: \"ant-slide-up\"\n      },\n      inline: collapseMotion,\n      other: {\n        name: \"ant-zoom-big\"\n      }\n    };\n    useProvideFirstLevel(true);\n\n    var getChildrenKeys = function getChildrenKeys() {\n      var eventKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var keys = [];\n      var storeValue = store.value;\n      eventKeys.forEach(function (eventKey) {\n        var _storeValue$eventKey = storeValue[eventKey],\n            key = _storeValue$eventKey.key,\n            childrenEventKeys = _storeValue$eventKey.childrenEventKeys;\n        keys.push.apply(keys, [key].concat(_toConsumableArray(getChildrenKeys(childrenEventKeys))));\n      });\n      return keys;\n    }; // ========================= Open =========================\n\n    /**\n     * Click for item. SubMenu do not have selection status\n     */\n\n\n    var onInternalClick = function onInternalClick(info) {\n      emit('click', info);\n      triggerSelection(info);\n    };\n\n    var onInternalOpenChange = function onInternalOpenChange(eventKey, open) {\n      var _store$value$eventKey = store.value[eventKey],\n          key = _store$value$eventKey.key,\n          childrenEventKeys = _store$value$eventKey.childrenEventKeys;\n      var newOpenKeys = mergedOpenKeys.value.filter(function (k) {\n        return k !== key;\n      });\n\n      if (open) {\n        newOpenKeys.push(key);\n      } else if (mergedMode.value !== 'inline') {\n        // We need find all related popup to close\n        var subPathKeys = getChildrenKeys(childrenEventKeys);\n        newOpenKeys = newOpenKeys.filter(function (k) {\n          return !subPathKeys.includes(k);\n        });\n      }\n\n      if (!shallowEqual(mergedOpenKeys, newOpenKeys)) {\n        triggerOpenKeys(newOpenKeys);\n      }\n    };\n\n    var registerMenuInfo = function registerMenuInfo(key, info) {\n      store.value = _extends(_extends({}, store.value), _defineProperty({}, key, info));\n    };\n\n    var unRegisterMenuInfo = function unRegisterMenuInfo(key) {\n      delete store.value[key];\n      store.value = _extends({}, store.value);\n    };\n\n    var lastVisibleIndex = ref(0);\n    useProvideMenu({\n      store: store,\n      prefixCls: prefixCls,\n      activeKeys: activeKeys,\n      openKeys: mergedOpenKeys,\n      selectedKeys: mergedSelectedKeys,\n      changeActiveKeys: changeActiveKeys,\n      disabled: disabled,\n      rtl: isRtl,\n      mode: mergedMode,\n      inlineIndent: computed(function () {\n        return props.inlineIndent;\n      }),\n      subMenuCloseDelay: computed(function () {\n        return props.subMenuCloseDelay;\n      }),\n      subMenuOpenDelay: computed(function () {\n        return props.subMenuOpenDelay;\n      }),\n      builtinPlacements: computed(function () {\n        return props.builtinPlacements;\n      }),\n      triggerSubMenuAction: computed(function () {\n        return props.triggerSubMenuAction;\n      }),\n      getPopupContainer: computed(function () {\n        return props.getPopupContainer;\n      }),\n      inlineCollapsed: mergedInlineCollapsed,\n      antdMenuTheme: computed(function () {\n        return props.theme;\n      }),\n      siderCollapsed: siderCollapsed,\n      defaultMotions: computed(function () {\n        return isMounted.value ? defaultMotions : null;\n      }),\n      motion: computed(function () {\n        return isMounted.value ? props.motion : null;\n      }),\n      overflowDisabled: ref(undefined),\n      onOpenChange: onInternalOpenChange,\n      onItemClick: onInternalClick,\n      registerMenuInfo: registerMenuInfo,\n      unRegisterMenuInfo: unRegisterMenuInfo,\n      selectedSubMenuEventKeys: selectedSubMenuEventKeys,\n      isRootMenu: ref(true),\n      expandIcon: props.expandIcon || slots.expandIcon\n    });\n    return function () {\n      var _a, _b;\n\n      var childList = flattenChildren((_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots));\n      var allVisible = lastVisibleIndex.value >= childList.length - 1 || mergedMode.value !== 'horizontal' || props.disabledOverflow; // >>>>> Children\n\n      var wrappedChildList = mergedMode.value !== 'horizontal' || props.disabledOverflow ? childList : // Need wrap for overflow dropdown that do not response for open\n      childList.map(function (child, index) {\n        return (// Always wrap provider to avoid sub node re-mount\n          _createVNode(MenuContextProvider, {\n            \"key\": child.key,\n            \"overflowDisabled\": index > lastVisibleIndex.value\n          }, {\n            default: function _default() {\n              return [child];\n            }\n          })\n        );\n      });\n\n      var overflowedIndicator = ((_b = slots.overflowedIndicator) === null || _b === void 0 ? void 0 : _b.call(slots)) || _createVNode(EllipsisOutlined, null, null);\n\n      return _createVNode(Overflow, {\n        \"prefixCls\": \"\".concat(prefixCls.value, \"-overflow\"),\n        \"component\": \"ul\",\n        \"itemComponent\": MenuItem,\n        \"class\": className.value,\n        \"role\": \"menu\",\n        \"data\": wrappedChildList,\n        \"renderRawItem\": function renderRawItem(node) {\n          return node;\n        },\n        \"renderRawRest\": function renderRawRest(omitItems) {\n          // We use origin list since wrapped list use context to prevent open\n          var len = omitItems.length;\n          var originOmitItems = len ? childList.slice(-len) : null;\n          return _createVNode(SubMenu, {\n            \"eventKey\": Overflow.OVERFLOW_KEY,\n            \"title\": overflowedIndicator,\n            \"disabled\": allVisible,\n            \"internalPopupClose\": len === 0\n          }, {\n            default: function _default() {\n              return [originOmitItems];\n            }\n          });\n        },\n        \"maxCount\": mergedMode.value !== 'horizontal' || props.disabledOverflow ? Overflow.INVALIDATE : Overflow.RESPONSIVE,\n        \"ssr\": \"full\",\n        \"data-menu-list\": true,\n        \"onVisibleChange\": function onVisibleChange(newLastIndex) {\n          lastVisibleIndex.value = newLastIndex;\n        }\n      }, null);\n    };\n  }\n});","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/node_modules/ant-design-vue/es/menu/src/Menu.js"],"names":["_defineProperty","_extends","_toConsumableArray","createVNode","_createVNode","computed","defineComponent","ref","inject","watchEffect","watch","onMounted","unref","shallowEqual","useProvideMenu","MenuContextProvider","useProvideFirstLevel","useConfigInject","devWarning","collapseMotion","uniq","SiderCollapsedKey","flattenChildren","Overflow","MenuItem","SubMenu","EllipsisOutlined","menuProps","prefixCls","String","disabled","Boolean","inlineCollapsed","disabledOverflow","openKeys","Array","selectedKeys","activeKey","selectable","type","default","multiple","motion","Object","theme","mode","inlineIndent","Number","subMenuOpenDelay","subMenuCloseDelay","builtinPlacements","triggerSubMenuAction","getPopupContainer","Function","expandIcon","EMPTY_LIST","name","props","emits","slots","setup","_ref","emit","_useConfigInject","direction","store","siderCollapsed","undefined","value","isMounted","activeKeys","mergedSelectedKeys","keyMapStore","newKeyMapStore","_i","_Object$values","values","length","menuInfo","key","flush","keys","concat","parentKeys","immediate","selectedSubMenuEventKeys","subMenuParentEventKeys","forEach","_subMenuParentEventKe","push","apply","parentEventKeys","triggerSelection","info","targetKey","exist","includes","newSelectedKeys","filter","selectInfo","mergedMode","mergedOpenKeys","triggerOpenKeys","arguments","timeout","changeActiveKeys","window","clearTimeout","setTimeout","isRtl","mergedInlineCollapsed","isInlineMode","inlineCacheOpenKeys","mountRef","className","_ref2","defaultMotions","horizontal","inline","other","getChildrenKeys","eventKeys","storeValue","eventKey","_storeValue$eventKey","childrenEventKeys","onInternalClick","onInternalOpenChange","open","_store$value$eventKey","newOpenKeys","k","subPathKeys","registerMenuInfo","unRegisterMenuInfo","lastVisibleIndex","rtl","antdMenuTheme","overflowDisabled","onOpenChange","onItemClick","isRootMenu","_a","_b","childList","call","allVisible","wrappedChildList","map","child","index","_default","overflowedIndicator","renderRawItem","node","renderRawRest","omitItems","len","originOmitItems","slice","OVERFLOW_KEY","INVALIDATE","RESPONSIVE","onVisibleChange","newLastIndex"],"mappings":"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","sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport { createVNode as _createVNode } from \"vue\";\nimport { computed, defineComponent, ref, inject, watchEffect, watch, onMounted, unref } from 'vue';\nimport shallowEqual from '../../_util/shallowequal';\nimport useProvideMenu, { MenuContextProvider, useProvideFirstLevel } from './hooks/useMenuContext';\nimport useConfigInject from '../../_util/hooks/useConfigInject';\nimport devWarning from '../../vc-util/devWarning';\nimport { collapseMotion } from '../../_util/transition';\nimport uniq from 'lodash-es/uniq';\nimport { SiderCollapsedKey } from '../../layout/injectionKey';\nimport { flattenChildren } from '../../_util/props-util';\nimport Overflow from '../../vc-overflow';\nimport MenuItem from './MenuItem';\nimport SubMenu from './SubMenu';\nimport EllipsisOutlined from '@ant-design/icons-vue/EllipsisOutlined';\nexport var menuProps = {\n  prefixCls: String,\n  disabled: Boolean,\n  inlineCollapsed: Boolean,\n  disabledOverflow: Boolean,\n  openKeys: Array,\n  selectedKeys: Array,\n  activeKey: String,\n  selectable: {\n    type: Boolean,\n    default: true\n  },\n  multiple: {\n    type: Boolean,\n    default: false\n  },\n  motion: Object,\n  theme: {\n    type: String,\n    default: 'light'\n  },\n  mode: {\n    type: String,\n    default: 'vertical'\n  },\n  inlineIndent: {\n    type: Number,\n    default: 24\n  },\n  subMenuOpenDelay: {\n    type: Number,\n    default: 0.1\n  },\n  subMenuCloseDelay: {\n    type: Number,\n    default: 0.1\n  },\n  builtinPlacements: {\n    type: Object\n  },\n  triggerSubMenuAction: {\n    type: String,\n    default: 'hover'\n  },\n  getPopupContainer: Function,\n  expandIcon: Function\n};\nvar EMPTY_LIST = [];\nexport default defineComponent({\n  name: 'AMenu',\n  props: menuProps,\n  emits: ['update:openKeys', 'openChange', 'select', 'deselect', 'update:selectedKeys', 'click', 'update:activeKey'],\n  slots: ['expandIcon', 'overflowedIndicator'],\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots,\n        emit = _ref.emit;\n\n    var _useConfigInject = useConfigInject('menu', props),\n        prefixCls = _useConfigInject.prefixCls,\n        direction = _useConfigInject.direction;\n\n    var store = ref({});\n    var siderCollapsed = inject(SiderCollapsedKey, ref(undefined));\n    var inlineCollapsed = computed(function () {\n      if (siderCollapsed.value !== undefined) {\n        return siderCollapsed.value;\n      }\n\n      return props.inlineCollapsed;\n    });\n    var isMounted = ref(false);\n    onMounted(function () {\n      isMounted.value = true;\n    });\n    watchEffect(function () {\n      devWarning(!(props.inlineCollapsed === true && props.mode !== 'inline'), 'Menu', '`inlineCollapsed` should only be used when `mode` is inline.');\n      devWarning(!(siderCollapsed.value !== undefined && props.inlineCollapsed === true), 'Menu', '`inlineCollapsed` not control Menu under Sider. Should set `collapsed` on Sider instead.');\n    });\n    var activeKeys = ref([]);\n    var mergedSelectedKeys = ref([]);\n    var keyMapStore = ref({});\n    watch(store, function () {\n      var newKeyMapStore = {};\n\n      for (var _i = 0, _Object$values = Object.values(store.value); _i < _Object$values.length; _i++) {\n        var menuInfo = _Object$values[_i];\n        newKeyMapStore[menuInfo.key] = menuInfo;\n      }\n\n      keyMapStore.value = newKeyMapStore;\n    }, {\n      flush: 'post'\n    });\n    watchEffect(function () {\n      if (props.activeKey !== undefined) {\n        var keys = [];\n        var menuInfo = props.activeKey ? keyMapStore.value[props.activeKey] : undefined;\n\n        if (menuInfo && props.activeKey !== undefined) {\n          keys = [].concat(_toConsumableArray(menuInfo.parentKeys), [props.activeKey]);\n        } else {\n          keys = [];\n        }\n\n        if (!shallowEqual(activeKeys.value, keys)) {\n          activeKeys.value = keys;\n        }\n      }\n    });\n    watch(function () {\n      return props.selectedKeys;\n    }, function (selectedKeys) {\n      mergedSelectedKeys.value = selectedKeys || mergedSelectedKeys.value;\n    }, {\n      immediate: true\n    });\n    var selectedSubMenuEventKeys = ref([]);\n    watch([keyMapStore, mergedSelectedKeys], function () {\n      var subMenuParentEventKeys = [];\n      mergedSelectedKeys.value.forEach(function (key) {\n        var menuInfo = keyMapStore.value[key];\n\n        if (menuInfo) {\n          var _subMenuParentEventKe;\n\n          (_subMenuParentEventKe = subMenuParentEventKeys).push.apply(_subMenuParentEventKe, _toConsumableArray(unref(menuInfo.parentEventKeys)));\n        }\n      });\n      subMenuParentEventKeys = uniq(subMenuParentEventKeys);\n\n      if (!shallowEqual(selectedSubMenuEventKeys.value, subMenuParentEventKeys)) {\n        selectedSubMenuEventKeys.value = subMenuParentEventKeys;\n      }\n    }, {\n      immediate: true\n    }); // >>>>> Trigger select\n\n    var triggerSelection = function triggerSelection(info) {\n      if (!props.selectable) {\n        return;\n      } // Insert or Remove\n\n\n      var targetKey = info.key;\n      var exist = mergedSelectedKeys.value.includes(targetKey);\n      var newSelectedKeys;\n\n      if (props.multiple) {\n        if (exist) {\n          newSelectedKeys = mergedSelectedKeys.value.filter(function (key) {\n            return key !== targetKey;\n          });\n        } else {\n          newSelectedKeys = [].concat(_toConsumableArray(mergedSelectedKeys.value), [targetKey]);\n        }\n      } else {\n        newSelectedKeys = [targetKey];\n      } // Trigger event\n\n\n      var selectInfo = _extends(_extends({}, info), {\n        selectedKeys: newSelectedKeys\n      });\n\n      if (!shallowEqual(newSelectedKeys, mergedSelectedKeys.value)) {\n        if (props.selectedKeys === undefined) {\n          mergedSelectedKeys.value = newSelectedKeys;\n        }\n\n        emit('update:selectedKeys', newSelectedKeys);\n\n        if (exist && props.multiple) {\n          emit('deselect', selectInfo);\n        } else {\n          emit('select', selectInfo);\n        }\n      }\n\n      if (mergedMode.value !== 'inline' && !props.multiple && mergedOpenKeys.value.length) {\n        triggerOpenKeys(EMPTY_LIST);\n      }\n    };\n\n    var mergedOpenKeys = ref([]);\n    watch(function () {\n      return props.openKeys;\n    }, function () {\n      var openKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : mergedOpenKeys.value;\n\n      if (!shallowEqual(mergedOpenKeys.value, openKeys)) {\n        mergedOpenKeys.value = openKeys;\n      }\n    }, {\n      immediate: true\n    });\n    var timeout;\n\n    var changeActiveKeys = function changeActiveKeys(keys) {\n      window.clearTimeout(timeout);\n      timeout = window.setTimeout(function () {\n        if (props.activeKey === undefined) {\n          activeKeys.value = keys;\n        }\n\n        emit('update:activeKey', keys[keys.length - 1]);\n      });\n    };\n\n    var disabled = computed(function () {\n      return !!props.disabled;\n    });\n    var isRtl = computed(function () {\n      return direction.value === 'rtl';\n    });\n    var mergedMode = ref('vertical');\n    var mergedInlineCollapsed = ref(false);\n    watchEffect(function () {\n      if ((props.mode === 'inline' || props.mode === 'vertical') && inlineCollapsed.value) {\n        mergedMode.value = 'vertical';\n        mergedInlineCollapsed.value = inlineCollapsed.value;\n      } else {\n        mergedMode.value = props.mode;\n        mergedInlineCollapsed.value = false;\n      }\n    });\n    var isInlineMode = computed(function () {\n      return mergedMode.value === 'inline';\n    });\n\n    var triggerOpenKeys = function triggerOpenKeys(keys) {\n      mergedOpenKeys.value = keys;\n      emit('update:openKeys', keys);\n      emit('openChange', keys);\n    }; // >>>>> Cache & Reset open keys when inlineCollapsed changed\n\n\n    var inlineCacheOpenKeys = ref(mergedOpenKeys.value);\n    var mountRef = ref(false); // Cache\n\n    watch(mergedOpenKeys, function () {\n      if (isInlineMode.value) {\n        inlineCacheOpenKeys.value = mergedOpenKeys.value;\n      }\n    }, {\n      immediate: true\n    }); // Restore\n\n    watch(isInlineMode, function () {\n      if (!mountRef.value) {\n        mountRef.value = true;\n        return;\n      }\n\n      if (isInlineMode.value) {\n        mergedOpenKeys.value = inlineCacheOpenKeys.value;\n      } else {\n        // Trigger open event in case its in control\n        triggerOpenKeys(EMPTY_LIST);\n      }\n    }, {\n      immediate: true\n    });\n    var className = computed(function () {\n      var _ref2;\n\n      return _ref2 = {}, _defineProperty(_ref2, \"\".concat(prefixCls.value), true), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-root\"), true), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-\").concat(mergedMode.value), true), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-inline-collapsed\"), mergedInlineCollapsed.value), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-rtl\"), isRtl.value), _defineProperty(_ref2, \"\".concat(prefixCls.value, \"-\").concat(props.theme), true), _ref2;\n    });\n    var defaultMotions = {\n      horizontal: {\n        name: \"ant-slide-up\"\n      },\n      inline: collapseMotion,\n      other: {\n        name: \"ant-zoom-big\"\n      }\n    };\n    useProvideFirstLevel(true);\n\n    var getChildrenKeys = function getChildrenKeys() {\n      var eventKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var keys = [];\n      var storeValue = store.value;\n      eventKeys.forEach(function (eventKey) {\n        var _storeValue$eventKey = storeValue[eventKey],\n            key = _storeValue$eventKey.key,\n            childrenEventKeys = _storeValue$eventKey.childrenEventKeys;\n        keys.push.apply(keys, [key].concat(_toConsumableArray(getChildrenKeys(childrenEventKeys))));\n      });\n      return keys;\n    }; // ========================= Open =========================\n\n    /**\n     * Click for item. SubMenu do not have selection status\n     */\n\n\n    var onInternalClick = function onInternalClick(info) {\n      emit('click', info);\n      triggerSelection(info);\n    };\n\n    var onInternalOpenChange = function onInternalOpenChange(eventKey, open) {\n      var _store$value$eventKey = store.value[eventKey],\n          key = _store$value$eventKey.key,\n          childrenEventKeys = _store$value$eventKey.childrenEventKeys;\n      var newOpenKeys = mergedOpenKeys.value.filter(function (k) {\n        return k !== key;\n      });\n\n      if (open) {\n        newOpenKeys.push(key);\n      } else if (mergedMode.value !== 'inline') {\n        // We need find all related popup to close\n        var subPathKeys = getChildrenKeys(childrenEventKeys);\n        newOpenKeys = newOpenKeys.filter(function (k) {\n          return !subPathKeys.includes(k);\n        });\n      }\n\n      if (!shallowEqual(mergedOpenKeys, newOpenKeys)) {\n        triggerOpenKeys(newOpenKeys);\n      }\n    };\n\n    var registerMenuInfo = function registerMenuInfo(key, info) {\n      store.value = _extends(_extends({}, store.value), _defineProperty({}, key, info));\n    };\n\n    var unRegisterMenuInfo = function unRegisterMenuInfo(key) {\n      delete store.value[key];\n      store.value = _extends({}, store.value);\n    };\n\n    var lastVisibleIndex = ref(0);\n    useProvideMenu({\n      store: store,\n      prefixCls: prefixCls,\n      activeKeys: activeKeys,\n      openKeys: mergedOpenKeys,\n      selectedKeys: mergedSelectedKeys,\n      changeActiveKeys: changeActiveKeys,\n      disabled: disabled,\n      rtl: isRtl,\n      mode: mergedMode,\n      inlineIndent: computed(function () {\n        return props.inlineIndent;\n      }),\n      subMenuCloseDelay: computed(function () {\n        return props.subMenuCloseDelay;\n      }),\n      subMenuOpenDelay: computed(function () {\n        return props.subMenuOpenDelay;\n      }),\n      builtinPlacements: computed(function () {\n        return props.builtinPlacements;\n      }),\n      triggerSubMenuAction: computed(function () {\n        return props.triggerSubMenuAction;\n      }),\n      getPopupContainer: computed(function () {\n        return props.getPopupContainer;\n      }),\n      inlineCollapsed: mergedInlineCollapsed,\n      antdMenuTheme: computed(function () {\n        return props.theme;\n      }),\n      siderCollapsed: siderCollapsed,\n      defaultMotions: computed(function () {\n        return isMounted.value ? defaultMotions : null;\n      }),\n      motion: computed(function () {\n        return isMounted.value ? props.motion : null;\n      }),\n      overflowDisabled: ref(undefined),\n      onOpenChange: onInternalOpenChange,\n      onItemClick: onInternalClick,\n      registerMenuInfo: registerMenuInfo,\n      unRegisterMenuInfo: unRegisterMenuInfo,\n      selectedSubMenuEventKeys: selectedSubMenuEventKeys,\n      isRootMenu: ref(true),\n      expandIcon: props.expandIcon || slots.expandIcon\n    });\n    return function () {\n      var _a, _b;\n\n      var childList = flattenChildren((_a = slots.default) === null || _a === void 0 ? void 0 : _a.call(slots));\n      var allVisible = lastVisibleIndex.value >= childList.length - 1 || mergedMode.value !== 'horizontal' || props.disabledOverflow; // >>>>> Children\n\n      var wrappedChildList = mergedMode.value !== 'horizontal' || props.disabledOverflow ? childList : // Need wrap for overflow dropdown that do not response for open\n      childList.map(function (child, index) {\n        return (// Always wrap provider to avoid sub node re-mount\n          _createVNode(MenuContextProvider, {\n            \"key\": child.key,\n            \"overflowDisabled\": index > lastVisibleIndex.value\n          }, {\n            default: function _default() {\n              return [child];\n            }\n          })\n        );\n      });\n\n      var overflowedIndicator = ((_b = slots.overflowedIndicator) === null || _b === void 0 ? void 0 : _b.call(slots)) || _createVNode(EllipsisOutlined, null, null);\n\n      return _createVNode(Overflow, {\n        \"prefixCls\": \"\".concat(prefixCls.value, \"-overflow\"),\n        \"component\": \"ul\",\n        \"itemComponent\": MenuItem,\n        \"class\": className.value,\n        \"role\": \"menu\",\n        \"data\": wrappedChildList,\n        \"renderRawItem\": function renderRawItem(node) {\n          return node;\n        },\n        \"renderRawRest\": function renderRawRest(omitItems) {\n          // We use origin list since wrapped list use context to prevent open\n          var len = omitItems.length;\n          var originOmitItems = len ? childList.slice(-len) : null;\n          return _createVNode(SubMenu, {\n            \"eventKey\": Overflow.OVERFLOW_KEY,\n            \"title\": overflowedIndicator,\n            \"disabled\": allVisible,\n            \"internalPopupClose\": len === 0\n          }, {\n            default: function _default() {\n              return [originOmitItems];\n            }\n          });\n        },\n        \"maxCount\": mergedMode.value !== 'horizontal' || props.disabledOverflow ? Overflow.INVALIDATE : Overflow.RESPONSIVE,\n        \"ssr\": \"full\",\n        \"data-menu-list\": true,\n        \"onVisibleChange\": function onVisibleChange(newLastIndex) {\n          lastVisibleIndex.value = newLastIndex;\n        }\n      }, null);\n    };\n  }\n});"]},"metadata":{},"sourceType":"module"}