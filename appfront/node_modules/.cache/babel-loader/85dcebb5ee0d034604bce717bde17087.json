{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport { ref, computed, defineComponent } from \"vue\";\nimport { pick, addUnit, numericProp, setScrollTop, createNamespace, makeRequiredProp } from \"../utils\";\nimport { getMonthEndDay } from \"../datetime-picker/utils\";\nimport { t, bem, compareDay, getPrevDay, getNextDay, formatMonthTitle } from \"./utils\";\nimport { useRect, useToggle } from \"@vant/use\";\nimport { useExpose } from \"../composables/use-expose\";\nimport { useHeight } from \"../composables/use-height\";\nimport CalendarDay from \"./CalendarDay\";\nconst [name] = createNamespace(\"calendar-month\");\nconst calendarMonthProps = {\n  date: makeRequiredProp(Date),\n  type: String,\n  color: String,\n  minDate: makeRequiredProp(Date),\n  maxDate: makeRequiredProp(Date),\n  showMark: Boolean,\n  rowHeight: numericProp,\n  formatter: Function,\n  lazyRender: Boolean,\n  currentDate: [Date, Array],\n  allowSameDay: Boolean,\n  showSubtitle: Boolean,\n  showMonthTitle: Boolean,\n  firstDayOfWeek: Number\n};\nvar stdin_default = defineComponent({\n  name,\n  props: calendarMonthProps,\n  emits: [\"click\", \"update-height\"],\n\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const [visible, setVisible] = useToggle();\n    const daysRef = ref();\n    const monthRef = ref();\n    const height = useHeight(monthRef);\n    const title = computed(() => formatMonthTitle(props.date));\n    const rowHeight = computed(() => addUnit(props.rowHeight));\n    const offset = computed(() => {\n      const realDay = props.date.getDay();\n\n      if (props.firstDayOfWeek) {\n        return (realDay + 7 - props.firstDayOfWeek) % 7;\n      }\n\n      return realDay;\n    });\n    const totalDay = computed(() => getMonthEndDay(props.date.getFullYear(), props.date.getMonth() + 1));\n    const shouldRender = computed(() => visible.value || !props.lazyRender);\n\n    const getTitle = () => title.value;\n\n    const getMultipleDayType = day => {\n      const isSelected = date => props.currentDate.some(item => compareDay(item, date) === 0);\n\n      if (isSelected(day)) {\n        const prevDay = getPrevDay(day);\n        const nextDay = getNextDay(day);\n        const prevSelected = isSelected(prevDay);\n        const nextSelected = isSelected(nextDay);\n\n        if (prevSelected && nextSelected) {\n          return \"multiple-middle\";\n        }\n\n        if (prevSelected) {\n          return \"end\";\n        }\n\n        if (nextSelected) {\n          return \"start\";\n        }\n\n        return \"multiple-selected\";\n      }\n\n      return \"\";\n    };\n\n    const getRangeDayType = day => {\n      const [startDay, endDay] = props.currentDate;\n\n      if (!startDay) {\n        return \"\";\n      }\n\n      const compareToStart = compareDay(day, startDay);\n\n      if (!endDay) {\n        return compareToStart === 0 ? \"start\" : \"\";\n      }\n\n      const compareToEnd = compareDay(day, endDay);\n\n      if (props.allowSameDay && compareToStart === 0 && compareToEnd === 0) {\n        return \"start-end\";\n      }\n\n      if (compareToStart === 0) {\n        return \"start\";\n      }\n\n      if (compareToEnd === 0) {\n        return \"end\";\n      }\n\n      if (compareToStart > 0 && compareToEnd < 0) {\n        return \"middle\";\n      }\n\n      return \"\";\n    };\n\n    const getDayType = day => {\n      const {\n        type,\n        minDate,\n        maxDate,\n        currentDate\n      } = props;\n\n      if (compareDay(day, minDate) < 0 || compareDay(day, maxDate) > 0) {\n        return \"disabled\";\n      }\n\n      if (currentDate === null) {\n        return \"\";\n      }\n\n      if (Array.isArray(currentDate)) {\n        if (type === \"multiple\") {\n          return getMultipleDayType(day);\n        }\n\n        if (type === \"range\") {\n          return getRangeDayType(day);\n        }\n      } else if (type === \"single\") {\n        return compareDay(day, currentDate) === 0 ? \"selected\" : \"\";\n      }\n\n      return \"\";\n    };\n\n    const getBottomInfo = dayType => {\n      if (props.type === \"range\") {\n        if (dayType === \"start\" || dayType === \"end\") {\n          return t(dayType);\n        }\n\n        if (dayType === \"start-end\") {\n          return `${t(\"start\")}/${t(\"end\")}`;\n        }\n      }\n    };\n\n    const renderTitle = () => {\n      if (props.showMonthTitle) {\n        return _createVNode(\"div\", {\n          \"class\": bem(\"month-title\")\n        }, [title.value]);\n      }\n    };\n\n    const renderMark = () => {\n      if (props.showMark && shouldRender.value) {\n        return _createVNode(\"div\", {\n          \"class\": bem(\"month-mark\")\n        }, [props.date.getMonth() + 1]);\n      }\n    };\n\n    const placeholders = computed(() => {\n      const count = Math.ceil((totalDay.value + offset.value) / 7);\n      return Array(count).fill({\n        type: \"placeholder\"\n      });\n    });\n    const days = computed(() => {\n      const days2 = [];\n      const year = props.date.getFullYear();\n      const month = props.date.getMonth();\n\n      for (let day = 1; day <= totalDay.value; day++) {\n        const date = new Date(year, month, day);\n        const type = getDayType(date);\n        let config = {\n          date,\n          type,\n          text: day,\n          bottomInfo: getBottomInfo(type)\n        };\n\n        if (props.formatter) {\n          config = props.formatter(config);\n        }\n\n        days2.push(config);\n      }\n\n      return days2;\n    });\n    const disabledDays = computed(() => days.value.filter(day => day.type === \"disabled\"));\n\n    const scrollToDate = (body, targetDate) => {\n      if (daysRef.value) {\n        const daysRect = useRect(daysRef.value);\n        const totalRows = placeholders.value.length;\n        const currentRow = Math.ceil((targetDate.getDate() + offset.value) / 7);\n        const rowOffset = (currentRow - 1) * daysRect.height / totalRows;\n        setScrollTop(body, daysRect.top + rowOffset + body.scrollTop - useRect(body).top);\n      }\n    };\n\n    const renderDay = (item, index) => _createVNode(CalendarDay, {\n      \"item\": item,\n      \"index\": index,\n      \"color\": props.color,\n      \"offset\": offset.value,\n      \"rowHeight\": rowHeight.value,\n      \"onClick\": item2 => emit(\"click\", item2)\n    }, pick(slots, [\"top-info\", \"bottom-info\"]));\n\n    const renderDays = () => _createVNode(\"div\", {\n      \"ref\": daysRef,\n      \"role\": \"grid\",\n      \"class\": bem(\"days\")\n    }, [renderMark(), (shouldRender.value ? days : placeholders).value.map(renderDay)]);\n\n    useExpose({\n      getTitle,\n      getHeight: () => height.value,\n      setVisible,\n      scrollToDate,\n      disabledDays\n    });\n    return () => _createVNode(\"div\", {\n      \"class\": bem(\"month\"),\n      \"ref\": monthRef\n    }, [renderTitle(), renderDays()]);\n  }\n\n});\nexport { stdin_default as default };","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/vant/es/calendar/CalendarMonth.js"],"names":["createVNode","_createVNode","ref","computed","defineComponent","pick","addUnit","numericProp","setScrollTop","createNamespace","makeRequiredProp","getMonthEndDay","t","bem","compareDay","getPrevDay","getNextDay","formatMonthTitle","useRect","useToggle","useExpose","useHeight","CalendarDay","name","calendarMonthProps","date","Date","type","String","color","minDate","maxDate","showMark","Boolean","rowHeight","formatter","Function","lazyRender","currentDate","Array","allowSameDay","showSubtitle","showMonthTitle","firstDayOfWeek","Number","stdin_default","props","emits","setup","emit","slots","visible","setVisible","daysRef","monthRef","height","title","offset","realDay","getDay","totalDay","getFullYear","getMonth","shouldRender","value","getTitle","getMultipleDayType","day","isSelected","some","item","prevDay","nextDay","prevSelected","nextSelected","getRangeDayType","startDay","endDay","compareToStart","compareToEnd","getDayType","isArray","getBottomInfo","dayType","renderTitle","renderMark","placeholders","count","Math","ceil","fill","days","days2","year","month","config","text","bottomInfo","push","disabledDays","filter","scrollToDate","body","targetDate","daysRect","totalRows","length","currentRow","getDate","rowOffset","top","scrollTop","renderDay","index","item2","renderDays","map","getHeight","default"],"mappings":"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","sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { ref, computed, defineComponent } from \"vue\";\nimport { pick, addUnit, numericProp, setScrollTop, createNamespace, makeRequiredProp } from \"../utils\";\nimport { getMonthEndDay } from \"../datetime-picker/utils\";\nimport { t, bem, compareDay, getPrevDay, getNextDay, formatMonthTitle } from \"./utils\";\nimport { useRect, useToggle } from \"@vant/use\";\nimport { useExpose } from \"../composables/use-expose\";\nimport { useHeight } from \"../composables/use-height\";\nimport CalendarDay from \"./CalendarDay\";\nconst [name] = createNamespace(\"calendar-month\");\nconst calendarMonthProps = {\n  date: makeRequiredProp(Date),\n  type: String,\n  color: String,\n  minDate: makeRequiredProp(Date),\n  maxDate: makeRequiredProp(Date),\n  showMark: Boolean,\n  rowHeight: numericProp,\n  formatter: Function,\n  lazyRender: Boolean,\n  currentDate: [Date, Array],\n  allowSameDay: Boolean,\n  showSubtitle: Boolean,\n  showMonthTitle: Boolean,\n  firstDayOfWeek: Number\n};\nvar stdin_default = defineComponent({\n  name,\n  props: calendarMonthProps,\n  emits: [\"click\", \"update-height\"],\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const [visible, setVisible] = useToggle();\n    const daysRef = ref();\n    const monthRef = ref();\n    const height = useHeight(monthRef);\n    const title = computed(() => formatMonthTitle(props.date));\n    const rowHeight = computed(() => addUnit(props.rowHeight));\n    const offset = computed(() => {\n      const realDay = props.date.getDay();\n      if (props.firstDayOfWeek) {\n        return (realDay + 7 - props.firstDayOfWeek) % 7;\n      }\n      return realDay;\n    });\n    const totalDay = computed(() => getMonthEndDay(props.date.getFullYear(), props.date.getMonth() + 1));\n    const shouldRender = computed(() => visible.value || !props.lazyRender);\n    const getTitle = () => title.value;\n    const getMultipleDayType = (day) => {\n      const isSelected = (date) => props.currentDate.some((item) => compareDay(item, date) === 0);\n      if (isSelected(day)) {\n        const prevDay = getPrevDay(day);\n        const nextDay = getNextDay(day);\n        const prevSelected = isSelected(prevDay);\n        const nextSelected = isSelected(nextDay);\n        if (prevSelected && nextSelected) {\n          return \"multiple-middle\";\n        }\n        if (prevSelected) {\n          return \"end\";\n        }\n        if (nextSelected) {\n          return \"start\";\n        }\n        return \"multiple-selected\";\n      }\n      return \"\";\n    };\n    const getRangeDayType = (day) => {\n      const [startDay, endDay] = props.currentDate;\n      if (!startDay) {\n        return \"\";\n      }\n      const compareToStart = compareDay(day, startDay);\n      if (!endDay) {\n        return compareToStart === 0 ? \"start\" : \"\";\n      }\n      const compareToEnd = compareDay(day, endDay);\n      if (props.allowSameDay && compareToStart === 0 && compareToEnd === 0) {\n        return \"start-end\";\n      }\n      if (compareToStart === 0) {\n        return \"start\";\n      }\n      if (compareToEnd === 0) {\n        return \"end\";\n      }\n      if (compareToStart > 0 && compareToEnd < 0) {\n        return \"middle\";\n      }\n      return \"\";\n    };\n    const getDayType = (day) => {\n      const {\n        type,\n        minDate,\n        maxDate,\n        currentDate\n      } = props;\n      if (compareDay(day, minDate) < 0 || compareDay(day, maxDate) > 0) {\n        return \"disabled\";\n      }\n      if (currentDate === null) {\n        return \"\";\n      }\n      if (Array.isArray(currentDate)) {\n        if (type === \"multiple\") {\n          return getMultipleDayType(day);\n        }\n        if (type === \"range\") {\n          return getRangeDayType(day);\n        }\n      } else if (type === \"single\") {\n        return compareDay(day, currentDate) === 0 ? \"selected\" : \"\";\n      }\n      return \"\";\n    };\n    const getBottomInfo = (dayType) => {\n      if (props.type === \"range\") {\n        if (dayType === \"start\" || dayType === \"end\") {\n          return t(dayType);\n        }\n        if (dayType === \"start-end\") {\n          return `${t(\"start\")}/${t(\"end\")}`;\n        }\n      }\n    };\n    const renderTitle = () => {\n      if (props.showMonthTitle) {\n        return _createVNode(\"div\", {\n          \"class\": bem(\"month-title\")\n        }, [title.value]);\n      }\n    };\n    const renderMark = () => {\n      if (props.showMark && shouldRender.value) {\n        return _createVNode(\"div\", {\n          \"class\": bem(\"month-mark\")\n        }, [props.date.getMonth() + 1]);\n      }\n    };\n    const placeholders = computed(() => {\n      const count = Math.ceil((totalDay.value + offset.value) / 7);\n      return Array(count).fill({\n        type: \"placeholder\"\n      });\n    });\n    const days = computed(() => {\n      const days2 = [];\n      const year = props.date.getFullYear();\n      const month = props.date.getMonth();\n      for (let day = 1; day <= totalDay.value; day++) {\n        const date = new Date(year, month, day);\n        const type = getDayType(date);\n        let config = {\n          date,\n          type,\n          text: day,\n          bottomInfo: getBottomInfo(type)\n        };\n        if (props.formatter) {\n          config = props.formatter(config);\n        }\n        days2.push(config);\n      }\n      return days2;\n    });\n    const disabledDays = computed(() => days.value.filter((day) => day.type === \"disabled\"));\n    const scrollToDate = (body, targetDate) => {\n      if (daysRef.value) {\n        const daysRect = useRect(daysRef.value);\n        const totalRows = placeholders.value.length;\n        const currentRow = Math.ceil((targetDate.getDate() + offset.value) / 7);\n        const rowOffset = (currentRow - 1) * daysRect.height / totalRows;\n        setScrollTop(body, daysRect.top + rowOffset + body.scrollTop - useRect(body).top);\n      }\n    };\n    const renderDay = (item, index) => _createVNode(CalendarDay, {\n      \"item\": item,\n      \"index\": index,\n      \"color\": props.color,\n      \"offset\": offset.value,\n      \"rowHeight\": rowHeight.value,\n      \"onClick\": (item2) => emit(\"click\", item2)\n    }, pick(slots, [\"top-info\", \"bottom-info\"]));\n    const renderDays = () => _createVNode(\"div\", {\n      \"ref\": daysRef,\n      \"role\": \"grid\",\n      \"class\": bem(\"days\")\n    }, [renderMark(), (shouldRender.value ? days : placeholders).value.map(renderDay)]);\n    useExpose({\n      getTitle,\n      getHeight: () => height.value,\n      setVisible,\n      scrollToDate,\n      disabledDays\n    });\n    return () => _createVNode(\"div\", {\n      \"class\": bem(\"month\"),\n      \"ref\": monthRef\n    }, [renderTitle(), renderDays()]);\n  }\n});\nexport {\n  stdin_default as default\n};\n"]},"metadata":{},"sourceType":"module"}