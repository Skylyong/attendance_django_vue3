{"ast":null,"code":"var setupDefaults = require('./setupDefaults');\n\nvar staticDocument = require('./staticDocument');\n\nvar staticDecodeURIComponent = require('./staticDecodeURIComponent');\n\nvar staticEncodeURIComponent = require('./staticEncodeURIComponent');\n\nvar isArray = require('./isArray');\n\nvar isObject = require('./isObject');\n\nvar isDate = require('./isDate');\n\nvar isUndefined = require('./isUndefined');\n\nvar includes = require('./includes');\n\nvar keys = require('./keys');\n\nvar assign = require('./assign');\n\nvar arrayEach = require('./arrayEach');\n\nvar helperNewDate = require('./helperNewDate');\n\nvar helperGetDateTime = require('./helperGetDateTime');\n\nvar getWhatYear = require('./getWhatYear');\n\nvar getWhatMonth = require('./getWhatMonth');\n\nvar getWhatDay = require('./getWhatDay');\n\nfunction toCookieUnitTime(unit, expires) {\n  var num = parseFloat(expires);\n  var nowdate = helperNewDate();\n  var time = helperGetDateTime(nowdate);\n\n  switch (unit) {\n    case 'y':\n      return helperGetDateTime(getWhatYear(nowdate, num));\n\n    case 'M':\n      return helperGetDateTime(getWhatMonth(nowdate, num));\n\n    case 'd':\n      return helperGetDateTime(getWhatDay(nowdate, num));\n\n    case 'h':\n    case 'H':\n      return time + num * 60 * 60 * 1000;\n\n    case 'm':\n      return time + num * 60 * 1000;\n\n    case 's':\n      return time + num * 1000;\n  }\n\n  return time;\n}\n\nfunction toCookieUTCString(date) {\n  return (isDate(date) ? date : new Date(date)).toUTCString();\n}\n/**\r\n  * cookie操作函数\r\n  * @param {String/Array/Object} name 键/数组/对象\r\n  * @param {String} value 值\r\n  * @param {Object} options 参数\r\n  *   @param {String} name: 键\r\n  *   @param {Object} value: 值\r\n  *   @param {String} path: 路径\r\n  *   @param {String} domain: 作用域\r\n  *   @param {Boolean} secure: 设置为安全的,只能用https协议\r\n  *   @param {Number} expires: 过期时间,可以指定日期或者字符串，默认天\r\n  */\n\n\nfunction cookie(name, value, options) {\n  if (staticDocument) {\n    var opts, expires, values, result, cookies, keyIndex;\n    var inserts = [];\n    var args = arguments;\n\n    if (isArray(name)) {\n      inserts = name;\n    } else if (args.length > 1) {\n      inserts = [assign({\n        name: name,\n        value: value\n      }, options)];\n    } else if (isObject(name)) {\n      inserts = [name];\n    }\n\n    if (inserts.length > 0) {\n      arrayEach(inserts, function (obj) {\n        opts = assign({}, setupDefaults.cookies, obj);\n        values = [];\n\n        if (opts.name) {\n          expires = opts.expires;\n          values.push(staticEncodeURIComponent(opts.name) + '=' + staticEncodeURIComponent(isObject(opts.value) ? JSON.stringify(opts.value) : opts.value));\n\n          if (expires) {\n            if (isNaN(expires)) {\n              // UTCString || Unit\n              expires = expires.replace(/^([0-9]+)(y|M|d|H|h|m|s)$/, function (text, num, unit) {\n                return toCookieUTCString(toCookieUnitTime(unit, num));\n              });\n            } else if (/^[0-9]{11,13}$/.test(expires) || isDate(expires)) {\n              // Date || now\n              expires = toCookieUTCString(expires);\n            } else {\n              // day\n              expires = toCookieUTCString(toCookieUnitTime('d', expires));\n            }\n\n            opts.expires = expires;\n          }\n\n          arrayEach(['expires', 'path', 'domain', 'secure'], function (key) {\n            if (!isUndefined(opts[key])) {\n              values.push(opts[key] && key === 'secure' ? key : key + '=' + opts[key]);\n            }\n          });\n        }\n\n        staticDocument.cookie = values.join('; ');\n      });\n      return true;\n    } else {\n      result = {};\n      cookies = staticDocument.cookie;\n\n      if (cookies) {\n        arrayEach(cookies.split('; '), function (val) {\n          keyIndex = val.indexOf('=');\n          result[staticDecodeURIComponent(val.substring(0, keyIndex))] = staticDecodeURIComponent(val.substring(keyIndex + 1) || '');\n        });\n      }\n\n      return args.length === 1 ? result[name] : result;\n    }\n  }\n\n  return false;\n}\n\nfunction hasCookieItem(value) {\n  return includes(cookieKeys(), value);\n}\n\nfunction getCookieItem(name) {\n  return cookie(name);\n}\n\nfunction setCookieItem(name, value, options) {\n  cookie(name, value, options);\n  return cookie;\n}\n\nfunction removeCookieItem(name, options) {\n  cookie(name, '', assign({\n    expires: -1\n  }, setupDefaults.cookies, options));\n}\n\nfunction cookieKeys() {\n  return keys(cookie());\n}\n\nfunction cookieJson() {\n  return cookie();\n}\n\nassign(cookie, {\n  has: hasCookieItem,\n  set: setCookieItem,\n  setItem: setCookieItem,\n  get: getCookieItem,\n  getItem: getCookieItem,\n  remove: removeCookieItem,\n  removeItem: removeCookieItem,\n  keys: cookieKeys,\n  getJSON: cookieJson\n});\nmodule.exports = cookie;","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/xe-utils/cookie.js"],"names":["setupDefaults","require","staticDocument","staticDecodeURIComponent","staticEncodeURIComponent","isArray","isObject","isDate","isUndefined","includes","keys","assign","arrayEach","helperNewDate","helperGetDateTime","getWhatYear","getWhatMonth","getWhatDay","toCookieUnitTime","unit","expires","num","parseFloat","nowdate","time","toCookieUTCString","date","Date","toUTCString","cookie","name","value","options","opts","values","result","cookies","keyIndex","inserts","args","arguments","length","obj","push","JSON","stringify","isNaN","replace","text","test","key","join","split","val","indexOf","substring","hasCookieItem","cookieKeys","getCookieItem","setCookieItem","removeCookieItem","cookieJson","has","set","setItem","get","getItem","remove","removeItem","getJSON","module","exports"],"mappings":"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","sourcesContent":["var setupDefaults = require('./setupDefaults')\r\nvar staticDocument = require('./staticDocument')\r\nvar staticDecodeURIComponent = require('./staticDecodeURIComponent')\r\nvar staticEncodeURIComponent = require('./staticEncodeURIComponent')\r\n\r\nvar isArray = require('./isArray')\r\nvar isObject = require('./isObject')\r\nvar isDate = require('./isDate')\r\nvar isUndefined = require('./isUndefined')\r\nvar includes = require('./includes')\r\nvar keys = require('./keys')\r\n\r\nvar assign = require('./assign')\r\n\r\nvar arrayEach = require('./arrayEach')\r\n\r\nvar helperNewDate = require('./helperNewDate')\r\nvar helperGetDateTime = require('./helperGetDateTime')\r\nvar getWhatYear = require('./getWhatYear')\r\nvar getWhatMonth = require('./getWhatMonth')\r\nvar getWhatDay = require('./getWhatDay')\r\n\r\nfunction toCookieUnitTime (unit, expires) {\r\n  var num = parseFloat(expires)\r\n  var nowdate = helperNewDate()\r\n  var time = helperGetDateTime(nowdate)\r\n  switch (unit) {\r\n    case 'y': return helperGetDateTime(getWhatYear(nowdate, num))\r\n    case 'M': return helperGetDateTime(getWhatMonth(nowdate, num))\r\n    case 'd': return helperGetDateTime(getWhatDay(nowdate, num))\r\n    case 'h':\r\n    case 'H': return time + num * 60 * 60 * 1000\r\n    case 'm': return time + num * 60 * 1000\r\n    case 's': return time + num * 1000\r\n  }\r\n  return time\r\n}\r\n\r\nfunction toCookieUTCString (date) {\r\n  return (isDate(date) ? date : new Date(date)).toUTCString()\r\n}\r\n\r\n/**\r\n  * cookie操作函数\r\n  * @param {String/Array/Object} name 键/数组/对象\r\n  * @param {String} value 值\r\n  * @param {Object} options 参数\r\n  *   @param {String} name: 键\r\n  *   @param {Object} value: 值\r\n  *   @param {String} path: 路径\r\n  *   @param {String} domain: 作用域\r\n  *   @param {Boolean} secure: 设置为安全的,只能用https协议\r\n  *   @param {Number} expires: 过期时间,可以指定日期或者字符串，默认天\r\n  */\r\nfunction cookie (name, value, options) {\r\n  if (staticDocument) {\r\n    var opts, expires, values, result, cookies, keyIndex\r\n    var inserts = []\r\n    var args = arguments\r\n    if (isArray(name)) {\r\n      inserts = name\r\n    } else if (args.length > 1) {\r\n      inserts = [assign({ name: name, value: value }, options)]\r\n    } else if (isObject(name)) {\r\n      inserts = [name]\r\n    }\r\n    if (inserts.length > 0) {\r\n      arrayEach(inserts, function (obj) {\r\n        opts = assign({}, setupDefaults.cookies, obj)\r\n        values = []\r\n        if (opts.name) {\r\n          expires = opts.expires\r\n          values.push(staticEncodeURIComponent(opts.name) + '=' + staticEncodeURIComponent(isObject(opts.value) ? JSON.stringify(opts.value) : opts.value))\r\n          if (expires) {\r\n            if (isNaN(expires)) {\r\n              // UTCString || Unit\r\n              expires = expires.replace(/^([0-9]+)(y|M|d|H|h|m|s)$/, function (text, num, unit) {\r\n                return toCookieUTCString(toCookieUnitTime(unit, num))\r\n              })\r\n            } else if (/^[0-9]{11,13}$/.test(expires) || isDate(expires)) {\r\n              // Date || now\r\n              expires = toCookieUTCString(expires)\r\n            } else {\r\n              // day\r\n              expires = toCookieUTCString(toCookieUnitTime('d', expires))\r\n            }\r\n            opts.expires = expires\r\n          }\r\n          arrayEach(['expires', 'path', 'domain', 'secure'], function (key) {\r\n            if (!isUndefined(opts[key])) {\r\n              values.push(opts[key] && key === 'secure' ? key : (key + '=' + opts[key]))\r\n            }\r\n          })\r\n        }\r\n        staticDocument.cookie = values.join('; ')\r\n      })\r\n      return true\r\n    } else {\r\n      result = {}\r\n      cookies = staticDocument.cookie\r\n      if (cookies) {\r\n        arrayEach(cookies.split('; '), function (val) {\r\n          keyIndex = val.indexOf('=')\r\n          result[staticDecodeURIComponent(val.substring(0, keyIndex))] = staticDecodeURIComponent(val.substring(keyIndex + 1) || '')\r\n        })\r\n      }\r\n      return args.length === 1 ? result[name] : result\r\n    }\r\n  }\r\n  return false\r\n}\r\n\r\nfunction hasCookieItem (value) {\r\n  return includes(cookieKeys(), value)\r\n}\r\n\r\nfunction getCookieItem (name) {\r\n  return cookie(name)\r\n}\r\n\r\nfunction setCookieItem (name, value, options) {\r\n  cookie(name, value, options)\r\n  return cookie\r\n}\r\n\r\nfunction removeCookieItem (name, options) {\r\n  cookie(name, '', assign({ expires: -1 }, setupDefaults.cookies, options))\r\n}\r\n\r\nfunction cookieKeys () {\r\n  return keys(cookie())\r\n}\r\n\r\nfunction cookieJson () {\r\n  return cookie()\r\n}\r\n\r\nassign(cookie, {\r\n  has: hasCookieItem,\r\n  set: setCookieItem,\r\n  setItem: setCookieItem,\r\n  get: getCookieItem,\r\n  getItem: getCookieItem,\r\n  remove: removeCookieItem,\r\n  removeItem: removeCookieItem,\r\n  keys: cookieKeys,\r\n  getJSON: cookieJson\r\n})\r\n\r\nmodule.exports = cookie\r\n"]},"metadata":{},"sourceType":"script"}