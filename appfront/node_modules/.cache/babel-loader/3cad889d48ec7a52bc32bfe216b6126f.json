{"ast":null,"code":"import { defineComponent, h, computed, inject } from 'vue';\nimport GlobalConfig from '../../v-x-e-table/src/conf';\nimport { VXETable } from '../../v-x-e-table';\nimport { formatText } from '../../tools/utils';\nexport default defineComponent({\n  name: 'VxeTableFilter',\n  props: {\n    filterStore: Object\n  },\n  setup: function (props) {\n    var $xetable = inject('$xetable', {});\n    var tableReactData = $xetable.reactData,\n        tableInternalData = $xetable.internalData;\n    var computeHasCheckOption = computed(function () {\n      var filterStore = props.filterStore;\n      return filterStore && filterStore.options.some(function (option) {\n        return option.checked;\n      });\n    }); // 全部筛选事件\n\n    var filterCheckAllEvent = function (evnt, value) {\n      var filterStore = props.filterStore;\n      filterStore.options.forEach(function (option) {\n        option._checked = value;\n        option.checked = value;\n      });\n      filterStore.isAllSelected = value;\n      filterStore.isIndeterminate = false;\n    };\n    /*************************\n     * Publish methods\n     *************************/\n    // 确认筛选\n\n\n    var confirmFilter = function (evnt) {\n      var filterStore = props.filterStore;\n      filterStore.options.forEach(function (option) {\n        option.checked = option._checked;\n      });\n      $xetable.confirmFilterEvent(evnt);\n    }; // （单选）筛选发生改变\n\n\n    var changeRadioOption = function (evnt, checked, item) {\n      var filterStore = props.filterStore;\n      filterStore.options.forEach(function (option) {\n        option._checked = false;\n      });\n      item._checked = checked;\n      $xetable.checkFilterOptions();\n      confirmFilter(evnt);\n    };\n    /**\n     * 重置筛选\n     * 当筛选面板中的重置按钮被按下时触发\n     * @param {Event} evnt 事件\n     */\n\n\n    var resetFilter = function (evnt) {\n      var filterStore = props.filterStore;\n      $xetable.handleClearFilter(filterStore.column);\n      $xetable.confirmFilterEvent(evnt);\n    }; // （多选）筛选发生改变\n\n\n    var changeMultipleOption = function (evnt, checked, item) {\n      item._checked = checked;\n      $xetable.checkFilterOptions();\n    }; // 筛选发生改变\n\n\n    var changeOption = function (evnt, checked, item) {\n      var filterStore = props.filterStore;\n\n      if (filterStore.multiple) {\n        changeMultipleOption(evnt, checked, item);\n      } else {\n        changeRadioOption(evnt, checked, item);\n      }\n    };\n\n    var changeAllOption = function (evnt, checked) {\n      var filterStore = props.filterStore;\n\n      if (filterStore.multiple) {\n        filterCheckAllEvent(evnt, checked);\n      } else {\n        resetFilter(evnt);\n      }\n    };\n    /*************************\n     * Publish methods\n     *************************/\n\n\n    var $panel = {\n      changeRadioOption: changeRadioOption,\n      changeMultipleOption: changeMultipleOption,\n      changeAllOption: changeAllOption,\n      changeOption: changeOption,\n      confirmFilter: confirmFilter,\n      resetFilter: resetFilter\n    };\n\n    var renderOptions = function (filterRender, compConf) {\n      var filterStore = props.filterStore;\n      var column = filterStore.column,\n          multiple = filterStore.multiple,\n          maxHeight = filterStore.maxHeight;\n      var slots = column.slots;\n      var filterSlot = slots ? slots.filter : null;\n      var params = Object.assign({}, tableInternalData._currFilterParams, {\n        $panel: $panel,\n        $table: $xetable\n      });\n\n      if (filterSlot) {\n        return [h('div', {\n          class: 'vxe-table--filter-template'\n        }, $xetable.callSlot(filterSlot, params))];\n      } else if (compConf && compConf.renderFilter) {\n        return [h('div', {\n          class: 'vxe-table--filter-template'\n        }, compConf.renderFilter(filterRender, params))];\n      }\n\n      return [h('ul', {\n        class: 'vxe-table--filter-header'\n      }, [h('li', {\n        class: ['vxe-table--filter-option', {\n          'is--checked': multiple ? filterStore.isAllSelected : !filterStore.options.some(function (item) {\n            return item._checked;\n          }),\n          'is--indeterminate': multiple && filterStore.isIndeterminate\n        }],\n        title: GlobalConfig.i18n(multiple ? 'vxe.table.allTitle' : 'vxe.table.allFilter'),\n        onClick: function (evnt) {\n          changeAllOption(evnt, !filterStore.isAllSelected);\n        }\n      }, (multiple ? [h('span', {\n        class: 'vxe-checkbox--icon vxe-checkbox--checked-icon'\n      }), h('span', {\n        class: 'vxe-checkbox--icon vxe-checkbox--unchecked-icon'\n      }), h('span', {\n        class: 'vxe-checkbox--icon vxe-checkbox--indeterminate-icon'\n      })] : []).concat([h('span', {\n        class: 'vxe-checkbox--label'\n      }, GlobalConfig.i18n('vxe.table.allFilter'))]))]), h('ul', {\n        class: 'vxe-table--filter-body',\n        style: maxHeight ? {\n          maxHeight: maxHeight + \"px\"\n        } : {}\n      }, filterStore.options.map(function (item) {\n        return h('li', {\n          class: ['vxe-table--filter-option', {\n            'is--checked': item._checked\n          }],\n          title: item.label,\n          onClick: function (evnt) {\n            changeOption(evnt, !item._checked, item);\n          }\n        }, (multiple ? [h('span', {\n          class: 'vxe-checkbox--icon vxe-checkbox--checked-icon'\n        }), h('span', {\n          class: 'vxe-checkbox--icon vxe-checkbox--unchecked-icon'\n        }), h('span', {\n          class: 'vxe-checkbox--icon vxe-checkbox--indeterminate-icon'\n        })] : []).concat([h('span', {\n          class: 'vxe-checkbox--label'\n        }, formatText(item.label, 1))]));\n      }))];\n    };\n\n    var renderFooters = function () {\n      var filterStore = props.filterStore;\n      var column = filterStore.column,\n          multiple = filterStore.multiple;\n      var hasCheckOption = computeHasCheckOption.value;\n      var filterRender = column.filterRender;\n      var compConf = filterRender ? VXETable.renderer.get(filterRender.name) : null;\n      var isDisabled = !hasCheckOption && !filterStore.isAllSelected && !filterStore.isIndeterminate;\n      return multiple && (!compConf || compConf.showFilterFooter !== false) ? [h('div', {\n        class: 'vxe-table--filter-footer'\n      }, [h('button', {\n        class: {\n          'is--disabled': isDisabled\n        },\n        disabled: isDisabled,\n        onClick: confirmFilter\n      }, GlobalConfig.i18n('vxe.table.confirmFilter')), h('button', {\n        onClick: resetFilter\n      }, GlobalConfig.i18n('vxe.table.resetFilter'))])] : [];\n    };\n\n    var renderVN = function () {\n      var filterStore = props.filterStore;\n      var initStore = tableReactData.initStore;\n      var column = filterStore.column;\n      var filterRender = column ? column.filterRender : null;\n      var compConf = filterRender ? VXETable.renderer.get(filterRender.name) : null;\n      return h('div', {\n        class: ['vxe-table--filter-wrapper', 'filter--prevent-default', compConf && compConf.className ? compConf.className : '', {\n          'is--animat': $xetable.props.animat,\n          'is--multiple': filterStore.multiple,\n          'is--active': filterStore.visible\n        }],\n        style: filterStore.style\n      }, initStore.filter && filterStore.visible ? renderOptions(filterRender, compConf).concat(renderFooters()) : []);\n    };\n\n    return renderVN;\n  }\n});","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/vxe-table/es/filter/src/panel.js"],"names":["defineComponent","h","computed","inject","GlobalConfig","VXETable","formatText","name","props","filterStore","Object","setup","$xetable","tableReactData","reactData","tableInternalData","internalData","computeHasCheckOption","options","some","option","checked","filterCheckAllEvent","evnt","value","forEach","_checked","isAllSelected","isIndeterminate","confirmFilter","confirmFilterEvent","changeRadioOption","item","checkFilterOptions","resetFilter","handleClearFilter","column","changeMultipleOption","changeOption","multiple","changeAllOption","$panel","renderOptions","filterRender","compConf","maxHeight","slots","filterSlot","filter","params","assign","_currFilterParams","$table","class","callSlot","renderFilter","title","i18n","onClick","concat","style","map","label","renderFooters","hasCheckOption","renderer","get","isDisabled","showFilterFooter","disabled","renderVN","initStore","className","animat","visible"],"mappings":"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","sourcesContent":["import { defineComponent, h, computed, inject } from 'vue';\nimport GlobalConfig from '../../v-x-e-table/src/conf';\nimport { VXETable } from '../../v-x-e-table';\nimport { formatText } from '../../tools/utils';\nexport default defineComponent({\n    name: 'VxeTableFilter',\n    props: {\n        filterStore: Object\n    },\n    setup: function (props) {\n        var $xetable = inject('$xetable', {});\n        var tableReactData = $xetable.reactData, tableInternalData = $xetable.internalData;\n        var computeHasCheckOption = computed(function () {\n            var filterStore = props.filterStore;\n            return filterStore && filterStore.options.some(function (option) { return option.checked; });\n        });\n        // 全部筛选事件\n        var filterCheckAllEvent = function (evnt, value) {\n            var filterStore = props.filterStore;\n            filterStore.options.forEach(function (option) {\n                option._checked = value;\n                option.checked = value;\n            });\n            filterStore.isAllSelected = value;\n            filterStore.isIndeterminate = false;\n        };\n        /*************************\n         * Publish methods\n         *************************/\n        // 确认筛选\n        var confirmFilter = function (evnt) {\n            var filterStore = props.filterStore;\n            filterStore.options.forEach(function (option) {\n                option.checked = option._checked;\n            });\n            $xetable.confirmFilterEvent(evnt);\n        };\n        // （单选）筛选发生改变\n        var changeRadioOption = function (evnt, checked, item) {\n            var filterStore = props.filterStore;\n            filterStore.options.forEach(function (option) {\n                option._checked = false;\n            });\n            item._checked = checked;\n            $xetable.checkFilterOptions();\n            confirmFilter(evnt);\n        };\n        /**\n         * 重置筛选\n         * 当筛选面板中的重置按钮被按下时触发\n         * @param {Event} evnt 事件\n         */\n        var resetFilter = function (evnt) {\n            var filterStore = props.filterStore;\n            $xetable.handleClearFilter(filterStore.column);\n            $xetable.confirmFilterEvent(evnt);\n        };\n        // （多选）筛选发生改变\n        var changeMultipleOption = function (evnt, checked, item) {\n            item._checked = checked;\n            $xetable.checkFilterOptions();\n        };\n        // 筛选发生改变\n        var changeOption = function (evnt, checked, item) {\n            var filterStore = props.filterStore;\n            if (filterStore.multiple) {\n                changeMultipleOption(evnt, checked, item);\n            }\n            else {\n                changeRadioOption(evnt, checked, item);\n            }\n        };\n        var changeAllOption = function (evnt, checked) {\n            var filterStore = props.filterStore;\n            if (filterStore.multiple) {\n                filterCheckAllEvent(evnt, checked);\n            }\n            else {\n                resetFilter(evnt);\n            }\n        };\n        /*************************\n         * Publish methods\n         *************************/\n        var $panel = {\n            changeRadioOption: changeRadioOption,\n            changeMultipleOption: changeMultipleOption,\n            changeAllOption: changeAllOption,\n            changeOption: changeOption,\n            confirmFilter: confirmFilter,\n            resetFilter: resetFilter\n        };\n        var renderOptions = function (filterRender, compConf) {\n            var filterStore = props.filterStore;\n            var column = filterStore.column, multiple = filterStore.multiple, maxHeight = filterStore.maxHeight;\n            var slots = column.slots;\n            var filterSlot = slots ? slots.filter : null;\n            var params = Object.assign({}, tableInternalData._currFilterParams, { $panel: $panel, $table: $xetable });\n            if (filterSlot) {\n                return [\n                    h('div', {\n                        class: 'vxe-table--filter-template'\n                    }, $xetable.callSlot(filterSlot, params))\n                ];\n            }\n            else if (compConf && compConf.renderFilter) {\n                return [\n                    h('div', {\n                        class: 'vxe-table--filter-template'\n                    }, compConf.renderFilter(filterRender, params))\n                ];\n            }\n            return [\n                h('ul', {\n                    class: 'vxe-table--filter-header'\n                }, [\n                    h('li', {\n                        class: ['vxe-table--filter-option', {\n                                'is--checked': multiple ? filterStore.isAllSelected : !filterStore.options.some(function (item) { return item._checked; }),\n                                'is--indeterminate': multiple && filterStore.isIndeterminate\n                            }],\n                        title: GlobalConfig.i18n(multiple ? 'vxe.table.allTitle' : 'vxe.table.allFilter'),\n                        onClick: function (evnt) {\n                            changeAllOption(evnt, !filterStore.isAllSelected);\n                        }\n                    }, (multiple ? [\n                        h('span', {\n                            class: 'vxe-checkbox--icon vxe-checkbox--checked-icon'\n                        }),\n                        h('span', {\n                            class: 'vxe-checkbox--icon vxe-checkbox--unchecked-icon'\n                        }),\n                        h('span', {\n                            class: 'vxe-checkbox--icon vxe-checkbox--indeterminate-icon'\n                        })\n                    ] : []).concat([\n                        h('span', {\n                            class: 'vxe-checkbox--label'\n                        }, GlobalConfig.i18n('vxe.table.allFilter'))\n                    ]))\n                ]),\n                h('ul', {\n                    class: 'vxe-table--filter-body',\n                    style: maxHeight ? {\n                        maxHeight: maxHeight + \"px\"\n                    } : {}\n                }, filterStore.options.map(function (item) {\n                    return h('li', {\n                        class: ['vxe-table--filter-option', {\n                                'is--checked': item._checked\n                            }],\n                        title: item.label,\n                        onClick: function (evnt) {\n                            changeOption(evnt, !item._checked, item);\n                        }\n                    }, (multiple ? [\n                        h('span', {\n                            class: 'vxe-checkbox--icon vxe-checkbox--checked-icon'\n                        }),\n                        h('span', {\n                            class: 'vxe-checkbox--icon vxe-checkbox--unchecked-icon'\n                        }),\n                        h('span', {\n                            class: 'vxe-checkbox--icon vxe-checkbox--indeterminate-icon'\n                        })\n                    ] : []).concat([\n                        h('span', {\n                            class: 'vxe-checkbox--label'\n                        }, formatText(item.label, 1))\n                    ]));\n                }))\n            ];\n        };\n        var renderFooters = function () {\n            var filterStore = props.filterStore;\n            var column = filterStore.column, multiple = filterStore.multiple;\n            var hasCheckOption = computeHasCheckOption.value;\n            var filterRender = column.filterRender;\n            var compConf = filterRender ? VXETable.renderer.get(filterRender.name) : null;\n            var isDisabled = !hasCheckOption && !filterStore.isAllSelected && !filterStore.isIndeterminate;\n            return multiple && (!compConf || compConf.showFilterFooter !== false) ? [\n                h('div', {\n                    class: 'vxe-table--filter-footer'\n                }, [\n                    h('button', {\n                        class: {\n                            'is--disabled': isDisabled\n                        },\n                        disabled: isDisabled,\n                        onClick: confirmFilter\n                    }, GlobalConfig.i18n('vxe.table.confirmFilter')),\n                    h('button', {\n                        onClick: resetFilter\n                    }, GlobalConfig.i18n('vxe.table.resetFilter'))\n                ])\n            ] : [];\n        };\n        var renderVN = function () {\n            var filterStore = props.filterStore;\n            var initStore = tableReactData.initStore;\n            var column = filterStore.column;\n            var filterRender = column ? column.filterRender : null;\n            var compConf = filterRender ? VXETable.renderer.get(filterRender.name) : null;\n            return h('div', {\n                class: ['vxe-table--filter-wrapper', 'filter--prevent-default', compConf && compConf.className ? compConf.className : '', {\n                        'is--animat': $xetable.props.animat,\n                        'is--multiple': filterStore.multiple,\n                        'is--active': filterStore.visible\n                    }],\n                style: filterStore.style\n            }, initStore.filter && filterStore.visible ? renderOptions(filterRender, compConf).concat(renderFooters()) : []);\n        };\n        return renderVN;\n    }\n});\n"]},"metadata":{},"sourceType":"module"}