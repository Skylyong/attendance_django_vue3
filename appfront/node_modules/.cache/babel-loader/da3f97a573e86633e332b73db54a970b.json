{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, withCtx as _withCtx, createBlock as _createBlock, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"editable-cell\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"editable-cell-input-wrapper\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"editable-cell-text-wrapper\"\n};\nconst _hoisted_4 = {\n  class: \"editable-cell\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"editable-cell-input-wrapper\"\n};\nconst _hoisted_6 = {\n  key: 1,\n  class: \"editable-cell-text-wrapper\"\n};\n\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"a\", null, \"Delete\", -1\n/* HOISTED */\n);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_a_input = _resolveComponent(\"a-input\");\n\n  const _component_edit_outlined = _resolveComponent(\"edit-outlined\");\n\n  const _component_a_select = _resolveComponent(\"a-select\");\n\n  const _component_check_outlined = _resolveComponent(\"check-outlined\");\n\n  const _component_a_popconfirm = _resolveComponent(\"a-popconfirm\");\n\n  const _component_a_table = _resolveComponent(\"a-table\");\n\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createCommentVNode(\" <a-button class=\\\"editable-add-btn\\\" @click=\\\"handleAdd\\\" style=\\\"margin-bottom: 8px\\\">Add</a-button> \"), _createVNode(_component_a_table, {\n    bordered: \"\",\n    \"data-source\": _ctx.dataSource,\n    columns: _ctx.columns\n  }, {\n    approveNote: _withCtx(({\n      text,\n      record\n    }) => [_createElementVNode(\"div\", _hoisted_1, [_ctx.editableData[record.id] ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_component_a_input, {\n      value: _ctx.editableData[record.id].approveNote,\n      \"onUpdate:value\": $event => _ctx.editableData[record.id].approveNote = $event,\n      onPressEnter: $event => _ctx.save(record.id)\n    }, null, 8\n    /* PROPS */\n    , [\"value\", \"onUpdate:value\", \"onPressEnter\"]), _createCommentVNode(\" <check-outlined class=\\\"editable-cell-icon-check\\\" @click=\\\"save(record.key)\\\" />    \")])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createTextVNode(_toDisplayString(text || ' ') + \" \", 1\n    /* TEXT */\n    ), _createVNode(_component_edit_outlined, {\n      class: \"editable-cell-icon\",\n      onClick: $event => _ctx.edit(record.id)\n    }, null, 8\n    /* PROPS */\n    , [\"onClick\"])]))])]),\n    approveState: _withCtx(({\n      record\n    }) => [_createElementVNode(\"div\", _hoisted_4, [_ctx.editableData[record.id] ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createVNode(_component_a_select, {\n      value: _ctx.editableData[record.id].approveState,\n      \"onUpdate:value\": $event => _ctx.editableData[record.id].approveState = $event,\n      \"label-in-value\": \"\",\n      style: {\n        \"width\": \"120px\"\n      },\n      options: _ctx.options,\n      onPressEnter: $event => _ctx.save(record.id)\n    }, null, 8\n    /* PROPS */\n    , [\"value\", \"onUpdate:value\", \"options\", \"onPressEnter\"]), _createVNode(_component_check_outlined, {\n      class: \"editable-cell-icon-check\",\n      onClick: $event => _ctx.save_server(record.id)\n    }, null, 8\n    /* PROPS */\n    , [\"onClick\"])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createTextVNode(_toDisplayString(record.approveState || ' ') + \" \", 1\n    /* TEXT */\n    ), _createVNode(_component_edit_outlined, {\n      class: \"editable-cell-icon\",\n      onClick: $event => _ctx.edit(record.id)\n    }, null, 8\n    /* PROPS */\n    , [\"onClick\"])]))])]),\n    operation: _withCtx(({\n      record\n    }) => [_ctx.dataSource.length ? (_openBlock(), _createBlock(_component_a_popconfirm, {\n      key: 0,\n      title: \"Sure to delete?\",\n      onConfirm: $event => _ctx.onDelete(record.key)\n    }, {\n      default: _withCtx(() => [_hoisted_7]),\n      _: 2\n      /* DYNAMIC */\n\n    }, 1032\n    /* PROPS, DYNAMIC_SLOTS */\n    , [\"onConfirm\"])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"data-source\", \"columns\"])], 2112\n  /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":";;AAIWA,OAAK,EAAC;;;;AAC2BA,OAAK,EAAC;;;;AAI9BA,OAAK,EAAC;;;AASfA,OAAK,EAAC;;;;AAC2BA,OAAK,EAAC;;;;AAY9BA,OAAK,EAAC;;;gCA6BlBC,oBAAa,GAAb,EAAa,IAAb,EAAG,QAAH,EAAS;AAAA;AAAT;;;;;;;;;;;;;;;6DA3DNC,gIACAC,aA6DUC,kBA7DV,EA6DU;AA7DDC,YAAQ,EAAR,EA6DC;AA7DS,mBAAaC,eA6DtB;AA7DmCC,WAAO,EAAED;AA6D5C,GA7DV;AACaE,eAAW,WACpB,CASM;AAVkBC,UAUlB;AAVwBC;AAUxB,KATN,KADoC,CACpCT,oBASM,KATN,cASM,CAROK,kBAAaI,MAAM,CAACC,EAApB,mBAAXC,oBAGI,KAHJ,cAGI,CAFFT,aAA8FU,kBAA9F,EAA8F;AAA5EC,WAAK,EAAER,kBAAaI,MAAM,CAACC,EAApB,EAAwBH,WAA6C;kCAArEF,kBAAaI,MAAM,CAACC,EAApB,EAAwBH,cAAWO,MAAkC;AAA/BC,kBAAU,YAAEV,UAAKI,MAAM,CAACC,EAAZ;AAAmB,KAA9F;;AAAA,kDAEE,EADFT,6GACE,CAHJ,oBAIAU,oBAGM,KAHN,cAGM,mCAFDH,IAAI,WAAU,KACjB;AAAA;KACI,EADJN,aAAqEc,wBAArE,EAAqE;AAAtDjB,WAAK,EAAC,oBAAgD;AAA1BkB,aAAK,YAAEZ,UAAKI,MAAM,CAACC,EAAZ;AAAmB,KAArE;;AAAA,kBACI,CAHN,EAII,CATN,CADoC,CAAhB;AAcZQ,gBAAY,WACpB,CAiBM;AAlBiBT;AAkBjB,KAjBN,KAD6B,CAC7BT,oBAiBM,KAjBN,cAiBM,CAhBOK,kBAAaI,MAAM,CAACC,EAApB,mBAAXC,oBAWI,KAXJ,cAWI,CAVJT,aAOaiB,mBAPb,EAOa;AANDN,WAAK,EAAER,kBAAaI,MAAM,CAACC,EAApB,EAAwBQ,YAM9B;kCANMb,kBAAaI,MAAM,CAACC,EAApB,EAAwBQ,eAAYJ,MAM1C;AALT,0BAKS;AAJTM,WAAoB,EAApB;AAAA;AAAA,OAIS;AAHRC,aAAO,EAAEhB,YAGD;AAFRU,kBAAU,YAAEV,UAAKI,MAAM,CAACC,EAAZ;AAEJ,KAPb;;AAAA,6DAUI,EAFFR,aAAmFoB,yBAAnF,EAAmF;AAAnEvB,WAAK,EAAC,0BAA6D;AAAjCkB,aAAK,YAAEZ,iBAAYI,MAAM,CAACC,EAAnB;AAA0B,KAAnF;;AAAA,kBAEE,CAXJ,oBAYAC,oBAGM,KAHN,cAGM,mCAFDF,MAAM,CAACS,YAAP,IAAmB,OAAU,KAChC;AAAA;KACI,EADJhB,aAAqEc,wBAArE,EAAqE;AAAtDjB,WAAK,EAAC,oBAAgD;AAA1BkB,aAAK,YAAEZ,UAAKI,MAAM,CAACC,EAAZ;AAAmB,KAArE;;AAAA,kBACI,CAHN,EAII,CAjBN,CAD6B,CAAT;AAqCXa,aAAS,WAClB,CAMe;AAPOd;AAOP,KANf,KAD4B,CAEpBJ,gBAAWmB,wBADnBC,aAMeC,uBANf,EAMe;YAAA;AAJbC,WAAK,EAAC,iBAIO;AAHZC,eAAO,YAAEvB,cAASI,MAAM,CAACoB,GAAhB;AAGG,KANf;wBAKE,MAAa,CAAbC,UAAa;;;;KALf;;AAAA,yDAD4B,CAAV;;;;GApDtB;;AAAA","names":["class","_createElementVNode","_createCommentVNode","_createVNode","_component_a_table","bordered","_ctx","columns","approveNote","text","record","id","_createElementBlock","_component_a_input","value","$event","onPressEnter","_component_edit_outlined","onClick","approveState","_component_a_select","style","options","_component_check_outlined","operation","length","_createBlock","_component_a_popconfirm","title","onConfirm","key","_hoisted_7"],"sourceRoot":"","sources":["/Users/lyong/Desktop/myproj/appfront/src/components/manager/managerApprove.vue"],"sourcesContent":["<template>\n  <!-- <a-button class=\"editable-add-btn\" @click=\"handleAdd\" style=\"margin-bottom: 8px\">Add</a-button> -->\n  <a-table bordered :data-source=\"dataSource\" :columns=\"columns\">\n    <template #approveNote=\"{ text, record }\">\n      <div class=\"editable-cell\">\n        <div v-if=\"editableData[record.id]\" class=\"editable-cell-input-wrapper\">\n          <a-input  v-model:value=\"editableData[record.id].approveNote\" @pressEnter=\"save(record.id)\" />\n          <!-- <check-outlined class=\"editable-cell-icon-check\" @click=\"save(record.key)\" />    -->\n      </div>\n        <div v-else class=\"editable-cell-text-wrapper\">\n          {{ text || ' ' }}\n          <edit-outlined class=\"editable-cell-icon\" @click=\"edit(record.id)\" />\n        </div>\n      </div>\n    </template>\n\n\n   <template #approveState=\"{record}\">\n      <div class=\"editable-cell\">\n        <div v-if=\"editableData[record.id]\" class=\"editable-cell-input-wrapper\">\n        <a-select\n            v-model:value=\"editableData[record.id].approveState\"\n            label-in-value\n            style=\"width: 120px\"\n            :options=\"options\"\n            @pressEnter=\"save(record.id)\"\n          >\n          </a-select>\n          <check-outlined class=\"editable-cell-icon-check\" @click=\"save_server(record.id)\" />  \n           \n      </div>\n        <div v-else class=\"editable-cell-text-wrapper\">\n          {{ record.approveState || ' ' }}\n          <edit-outlined class=\"editable-cell-icon\" @click=\"edit(record.id)\" />\n        </div> \n      </div> \n    </template>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    <template #operation=\"{ record }\">\n      <a-popconfirm\n        v-if=\"dataSource.length\"\n        title=\"Sure to delete?\"\n        @confirm=\"onDelete(record.key)\"\n      >\n        <a>Delete</a>\n      </a-popconfirm>\n    </template>\n  </a-table>\n</template>\n<script>\nimport{getworkerApplyHistory, submitApplication} from '../../api/api.js'\nimport { computed, defineComponent, reactive, ref } from 'vue';\nimport { CheckOutlined, EditOutlined } from '@ant-design/icons-vue';\nimport { cloneDeep } from 'lodash-es';\nimport { message } from 'ant-design-vue';\nexport default defineComponent({\n  components: {\n    CheckOutlined,\n    EditOutlined,\n  },\n\n  setup() {\n    const options = ref([\n      {\n        value: '1',\n        label: '通过',\n      },\n      {\n        value: '2',\n        label: '不通过',\n      },\n    ]);\n\nconst columns = [\n//     {\n//   title: '序号',\n//   dataIndex: 'id',\n//   width: '5%',\n//     // slots: {\n//     //       customRender: 'id',\n//     //     },\n// } ,\n  {\n  title: '工号',\n  dataIndex: 'userId',\n  width: '5%',\n  sorter: (a, b) => a.length - b.length,\n} ,\n  {\n  title: '姓名',\n  dataIndex: 'name',\n  width: '8%',\n  // sorter: (a, b) => a.length - b.length,\n} ,\n\n{\n  title: '开始时间',\n  dataIndex: 'applyStartTime',\n  // sorter: true,\n  width: '8%',\n  // sorter: (a, b) => a.applyStartTime - b.applyStartTime,\n} ,\n{\n  title: '结束时间',\n  dataIndex: 'applyEndTime',\n  // sorter: true,\n  width: '8%',\n  // sorter: (a, b) => a.applyEndTime - b.applyEndTime,\n} \n,\n{\n  title: '申请类型',\n  dataIndex: 'applyType',\n  // filters: [{\n  //   text: '公休',\n  //   value: '公休',\n  // }, {\n  //   text: '值班加班',\n  //   value: '值班加班',\n  // }\n  // ],\n  // onFilter: (value, record) => record.applyType.indexOf(value) === 0,\n  // sorter: (a, b) => a.applyType.length - b.applyType.length,\n  width: '8%',\n},\n{\n  title: '假期种类',\n  dataIndex: 'holidayType',\n  // filters: [{\n  //   text: '公休请假',\n  //   value: '公休请假',\n  // }, {\n  //   text: '加班换积休',\n  //   value: '加班换积休',\n  // },\n  // {\n  //   text: '值班换积休',\n  //   value: '值班换积休',\n  // }\n  // ],\n  // onFilter: (value, record) => record.holidayType.indexOf(value) === 0,\n  // sorter: (a, b) => a.holidayType.length - b.holidayType.length,\n  width: '8%',\n}\n,\n{\n  title: '申请原因',\n  dataIndex: 'applyReason',\n  width: '15%',\n  // sorter: (a, b) => a.applyReason.length - b.applyReason.length,\n},\n{\n  title: '填写批注',\n  dataIndex: 'approveNote',\n  // sorter: true,\n  width: '20%',\n  slots: {\n          customRender: 'approveNote',\n        },\n},\n{\n  title: '审批结果',\n  dataIndex: 'approveState',\n  // sorter: (a, b) => a.approveState.length - b.approveState.length,\n  // onFilter: (value, record) => record.approveState.indexOf(value) === 0,\n  width: '8%',\n  slots: {\n          customRender: 'approveState',\n        },\n  //   filters: [{\n  //   text: '通过',\n  //   value: '通过',\n  // }, {\n  //   text: '不通过',\n  //   value: '不通过',\n  // },{\n  //   text: '未审批',\n  // //   value: '未审批',\n  // },\n  \n  // ],\n}\n,\n\n// {\n//         title: '操作',\n//         dataIndex: 'operation',\n//         slots: {\n//           customRender: 'operation',\n//         },\n//       },\n];\n  \n\n    const dataSource = ref();\n    let getid = localStorage.getItem(\"Userid\");\n     \n     getworkerApplyHistory(getid).then (\n       response =>{\n          // message.success(getid+'aaaaa:'+response['code'])\n         if (response['code'] == 1){\n           \n            dataSource.value = response['data']\n            console.log(response['data'])\n         }})\n    const count = computed(() => dataSource.value.length + 1);\n    const editableData = reactive({});\n\n    const edit = key => {\n      console.log('key:',key)\n      editableData[key] = cloneDeep(dataSource.value.filter(item => key === item.id)[0]);\n      \n    };\n\n    const save = key => {\n      Object.assign(dataSource.value.filter(item => key === item.id)[0], editableData[key]);\n      delete editableData[key];\n    };\n    \n  const save_server = key => {\n      Object.assign(dataSource.value.filter(item => key === item.id)[0], editableData[key]);\n      \n      console.log(\"aaaaadfsdfsd:\", )\n      delete editableData[key];\n      console.log('key  fsdfsfsd:', key)\n      submitApplication(getid, key, 3).then(\n        response =>{\n          // message.success(getid+'aaaaa:'+response['code'])\n         if (response['code'] == 1){\n           message.success(\"提交成功！\")\n               getworkerApplyHistory(getid).then (\n       response =>{\n          // message.success(getid+'aaaaa:'+response['code'])\n         if (response['code'] == 1){\n           \n            dataSource.value = response['data']\n            console.log(response['data'])\n         }})\n\n         }\n         else{\n           message.error(\"提交失败！\")\n         }\n       \n       }\n      )\n\n    };\n\n\n    const onDelete = key => {\n      dataSource.value = dataSource.value.filter(item => item.key !== key);\n    };\n\n    const handleAdd = () => {\n      const newData = {\n        key: `${count.value}`,\n        name: `Edward King ${count.value}`,\n        age: 32,\n        address: `London, Park Lane no. ${count.value}`,\n      };\n      dataSource.value.push(newData);\n    };\n\n    return {\n      getworkerApplyHistory,\n      options,\n      columns,\n      onDelete,\n      handleAdd,\n      dataSource,\n      editableData,\n      count,\n      edit,\n      save,\n      save_server,\n    };\n  },\n});\n</script>\n<style lang=\"less\">\n.editable-cell {\n  position: relative;\n  .editable-cell-input-wrapper,\n  .editable-cell-text-wrapper {\n    padding-right: 24px;\n  }\n\n  .editable-cell-text-wrapper {\n    padding: 5px 24px 5px 5px;\n  }\n\n  .editable-cell-icon,\n  .editable-cell-icon-check {\n    position: absolute;\n    right: 0;\n    width: 20px;\n    cursor: pointer;\n  }\n\n  .editable-cell-icon {\n    margin-top: 4px;\n    display: none;\n  }\n\n  .editable-cell-icon-check {\n    line-height: 28px;\n  }\n\n  .editable-cell-icon:hover,\n  .editable-cell-icon-check:hover {\n    color: #108ee9;\n  }\n\n  .editable-add-btn {\n    margin-bottom: 8px;\n  }\n}\n.editable-cell:hover .editable-cell-icon {\n  display: inline-block;\n}\n</style>"]},"metadata":{},"sourceType":"module"}