{"ast":null,"code":"import { createVNode as _createVNode } from \"vue\";\nimport { ref, computed, defineComponent } from \"vue\";\nimport { isDef, truthProp, numericProp, windowHeight, makeStringProp, makeNumericProp, createNamespace, HAPTICS_FEEDBACK } from \"../utils\";\nimport { useId } from \"../composables/use-id\";\nimport { useRect, useChildren, useClickAway, useScrollParent, useEventListener } from \"@vant/use\";\nconst [name, bem] = createNamespace(\"dropdown-menu\");\nconst dropdownMenuProps = {\n  overlay: truthProp,\n  zIndex: numericProp,\n  duration: makeNumericProp(0.2),\n  direction: makeStringProp(\"down\"),\n  activeColor: String,\n  closeOnClickOutside: truthProp,\n  closeOnClickOverlay: truthProp\n};\nconst DROPDOWN_KEY = Symbol(name);\nvar stdin_default = defineComponent({\n  name,\n  props: dropdownMenuProps,\n\n  setup(props, {\n    slots\n  }) {\n    const id = useId();\n    const root = ref();\n    const barRef = ref();\n    const offset = ref(0);\n    const {\n      children,\n      linkChildren\n    } = useChildren(DROPDOWN_KEY);\n    const scrollParent = useScrollParent(root);\n    const opened = computed(() => children.some(item => item.state.showWrapper));\n    const barStyle = computed(() => {\n      if (opened.value && isDef(props.zIndex)) {\n        return {\n          zIndex: +props.zIndex + 1\n        };\n      }\n    });\n\n    const onClickAway = () => {\n      if (props.closeOnClickOutside) {\n        children.forEach(item => {\n          item.toggle(false);\n        });\n      }\n    };\n\n    const updateOffset = () => {\n      if (barRef.value) {\n        const rect = useRect(barRef);\n\n        if (props.direction === \"down\") {\n          offset.value = rect.bottom;\n        } else {\n          offset.value = windowHeight.value - rect.top;\n        }\n      }\n    };\n\n    const onScroll = () => {\n      if (opened.value) {\n        updateOffset();\n      }\n    };\n\n    const toggleItem = active => {\n      children.forEach((item, index) => {\n        if (index === active) {\n          updateOffset();\n          item.toggle();\n        } else if (item.state.showPopup) {\n          item.toggle(false, {\n            immediate: true\n          });\n        }\n      });\n    };\n\n    const renderTitle = (item, index) => {\n      const {\n        showPopup\n      } = item.state;\n      const {\n        disabled,\n        titleClass\n      } = item;\n      return _createVNode(\"div\", {\n        \"id\": `${id}-${index}`,\n        \"role\": \"button\",\n        \"tabindex\": disabled ? void 0 : 0,\n        \"class\": [bem(\"item\", {\n          disabled\n        }), {\n          [HAPTICS_FEEDBACK]: !disabled\n        }],\n        \"onClick\": () => {\n          if (!disabled) {\n            toggleItem(index);\n          }\n        }\n      }, [_createVNode(\"span\", {\n        \"class\": [bem(\"title\", {\n          down: showPopup === (props.direction === \"down\"),\n          active: showPopup\n        }), titleClass],\n        \"style\": {\n          color: showPopup ? props.activeColor : \"\"\n        }\n      }, [_createVNode(\"div\", {\n        \"class\": \"van-ellipsis\"\n      }, [item.renderTitle()])])]);\n    };\n\n    linkChildren({\n      id,\n      props,\n      offset\n    });\n    useClickAway(root, onClickAway);\n    useEventListener(\"scroll\", onScroll, {\n      target: scrollParent\n    });\n    return () => {\n      var _a;\n\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"class\": bem()\n      }, [_createVNode(\"div\", {\n        \"ref\": barRef,\n        \"style\": barStyle.value,\n        \"class\": bem(\"bar\", {\n          opened: opened.value\n        })\n      }, [children.map(renderTitle)]), (_a = slots.default) == null ? void 0 : _a.call(slots)]);\n    };\n  }\n\n});\nexport { DROPDOWN_KEY, stdin_default as default };","map":{"version":3,"sources":["/Users/lyong/Desktop/myproj/appfront/node_modules/vant/es/dropdown-menu/DropdownMenu.js"],"names":["createVNode","_createVNode","ref","computed","defineComponent","isDef","truthProp","numericProp","windowHeight","makeStringProp","makeNumericProp","createNamespace","HAPTICS_FEEDBACK","useId","useRect","useChildren","useClickAway","useScrollParent","useEventListener","name","bem","dropdownMenuProps","overlay","zIndex","duration","direction","activeColor","String","closeOnClickOutside","closeOnClickOverlay","DROPDOWN_KEY","Symbol","stdin_default","props","setup","slots","id","root","barRef","offset","children","linkChildren","scrollParent","opened","some","item","state","showWrapper","barStyle","value","onClickAway","forEach","toggle","updateOffset","rect","bottom","top","onScroll","toggleItem","active","index","showPopup","immediate","renderTitle","disabled","titleClass","down","color","target","_a","map","default","call"],"mappings":"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","sourcesContent":["import { createVNode as _createVNode } from \"vue\";\nimport { ref, computed, defineComponent } from \"vue\";\nimport { isDef, truthProp, numericProp, windowHeight, makeStringProp, makeNumericProp, createNamespace, HAPTICS_FEEDBACK } from \"../utils\";\nimport { useId } from \"../composables/use-id\";\nimport { useRect, useChildren, useClickAway, useScrollParent, useEventListener } from \"@vant/use\";\nconst [name, bem] = createNamespace(\"dropdown-menu\");\nconst dropdownMenuProps = {\n  overlay: truthProp,\n  zIndex: numericProp,\n  duration: makeNumericProp(0.2),\n  direction: makeStringProp(\"down\"),\n  activeColor: String,\n  closeOnClickOutside: truthProp,\n  closeOnClickOverlay: truthProp\n};\nconst DROPDOWN_KEY = Symbol(name);\nvar stdin_default = defineComponent({\n  name,\n  props: dropdownMenuProps,\n  setup(props, {\n    slots\n  }) {\n    const id = useId();\n    const root = ref();\n    const barRef = ref();\n    const offset = ref(0);\n    const {\n      children,\n      linkChildren\n    } = useChildren(DROPDOWN_KEY);\n    const scrollParent = useScrollParent(root);\n    const opened = computed(() => children.some((item) => item.state.showWrapper));\n    const barStyle = computed(() => {\n      if (opened.value && isDef(props.zIndex)) {\n        return {\n          zIndex: +props.zIndex + 1\n        };\n      }\n    });\n    const onClickAway = () => {\n      if (props.closeOnClickOutside) {\n        children.forEach((item) => {\n          item.toggle(false);\n        });\n      }\n    };\n    const updateOffset = () => {\n      if (barRef.value) {\n        const rect = useRect(barRef);\n        if (props.direction === \"down\") {\n          offset.value = rect.bottom;\n        } else {\n          offset.value = windowHeight.value - rect.top;\n        }\n      }\n    };\n    const onScroll = () => {\n      if (opened.value) {\n        updateOffset();\n      }\n    };\n    const toggleItem = (active) => {\n      children.forEach((item, index) => {\n        if (index === active) {\n          updateOffset();\n          item.toggle();\n        } else if (item.state.showPopup) {\n          item.toggle(false, {\n            immediate: true\n          });\n        }\n      });\n    };\n    const renderTitle = (item, index) => {\n      const {\n        showPopup\n      } = item.state;\n      const {\n        disabled,\n        titleClass\n      } = item;\n      return _createVNode(\"div\", {\n        \"id\": `${id}-${index}`,\n        \"role\": \"button\",\n        \"tabindex\": disabled ? void 0 : 0,\n        \"class\": [bem(\"item\", {\n          disabled\n        }), {\n          [HAPTICS_FEEDBACK]: !disabled\n        }],\n        \"onClick\": () => {\n          if (!disabled) {\n            toggleItem(index);\n          }\n        }\n      }, [_createVNode(\"span\", {\n        \"class\": [bem(\"title\", {\n          down: showPopup === (props.direction === \"down\"),\n          active: showPopup\n        }), titleClass],\n        \"style\": {\n          color: showPopup ? props.activeColor : \"\"\n        }\n      }, [_createVNode(\"div\", {\n        \"class\": \"van-ellipsis\"\n      }, [item.renderTitle()])])]);\n    };\n    linkChildren({\n      id,\n      props,\n      offset\n    });\n    useClickAway(root, onClickAway);\n    useEventListener(\"scroll\", onScroll, {\n      target: scrollParent\n    });\n    return () => {\n      var _a;\n      return _createVNode(\"div\", {\n        \"ref\": root,\n        \"class\": bem()\n      }, [_createVNode(\"div\", {\n        \"ref\": barRef,\n        \"style\": barStyle.value,\n        \"class\": bem(\"bar\", {\n          opened: opened.value\n        })\n      }, [children.map(renderTitle)]), (_a = slots.default) == null ? void 0 : _a.call(slots)]);\n    };\n  }\n});\nexport {\n  DROPDOWN_KEY,\n  stdin_default as default\n};\n"]},"metadata":{},"sourceType":"module"}