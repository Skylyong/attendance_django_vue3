"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.formItemProps=exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_vXETable=require("../../v-x-e-table"),_utils=require("../../tools/utils"),_util=require("./util"),_render=require("./render");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,i=1,l=arguments.length;i<l;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},formItemProps={title:String,field:String,span:[String,Number],align:String,titleAlign:String,titleWidth:[String,Number],className:[String,Function],titleOverflow:{type:[Boolean,String],default:null},titlePrefix:Object,titleSuffix:Object,resetValue:{default:null},visibleMethod:Function,visible:{type:Boolean,default:null},folding:Boolean,collapseNode:Boolean,itemRender:Object};exports.formItemProps=formItemProps;var _default=(0,_vue.defineComponent)({name:"VxeFormItem",props:formItemProps,setup:function(e,t){var t=t.slots,F=(0,_vue.ref)(),i=(0,_vue.inject)("$xeform",{}),l=(0,_vue.inject)("xeformgather",null),r=(0,_util.createItem)(i,e);r.slots=t,(0,_util.watchItem)(e,r),(0,_vue.onMounted)(function(){(0,_util.assemItem)(i,F.value,r,l)}),(0,_vue.onUnmounted)(function(){(0,_util.destroyItem)(i,r)});return function(){var e=i?i.props:null;return e&&e.customLayout?function(t,e){var i=t.props,l=t.reactData,r=i.data,n=i.rules,o=i.titleOverflow,u=l.collapseAll,s=t.getComputeMaps().computeValidOpts.value,a=e.slots,f=e.title,d=e.visible,v=e.folding,m=e.visibleMethod,c=e.field,_=e.collapseNode,p=e.itemRender,g=e.showError,x=e.errRule,h=e.className,b=e.titleOverflow,O=(0,_utils.isEnableConf)(p)?_vXETable.VXETable.renderer.get(p.name):null,I=a?a.default:null,M=a?a.title:null,q=e.span||i.span,N=e.align||i.align,y=e.titleAlign||i.titleAlign,l=e.titleWidth||i.titleWidth,a=_xeUtils.default.isUndefined(b)||_xeUtils.default.isNull(b)?o:b,i="title"===a,o=!0===a||"tooltip"===a,b=i||o||"ellipsis"===a,a=m,S={data:r,property:c,item:e,$form:t},m=!1;!n||(w=n[c])&&(m=w.some(function(e){return e.required})),!a&&O&&O.itemVisibleMethod&&(a=O.itemVisibleMethod);var w=[];I?w=t.callSlot(I,S):O&&O.renderItemContent?w=O.renderItemContent(p,S):c&&(w=[""+_xeUtils.default.get(r,c)]),_&&w.push((0,_vue.h)("div",{class:"vxe-form--item-trigger-node",onClick:t.toggleCollapseEvent},[(0,_vue.h)("span",{class:"vxe-form--item-trigger-text"},u?_conf.default.i18n("vxe.form.unfolding"):_conf.default.i18n("vxe.form.folding")),(0,_vue.h)("i",{class:["vxe-form--item-trigger-icon",u?_conf.default.icon.FORM_FOLDING:_conf.default.icon.FORM_UNFOLDING]})])),x&&s.showMessage&&w.push((0,_vue.h)("div",{class:"vxe-form--item-valid",style:x.maxWidth?{width:x.maxWidth+"px"}:null},x.message));o=o?{onMouseenter:function(e){t.triggerTitleTipEvent(e,S)},onMouseleave:t.handleTitleTipLeaveEvent}:{};return(0,_vue.h)("div",{ref:F,class:["vxe-form--item",e.id,q?"vxe-col--"+q+" is--span":"",h?_xeUtils.default.isFunction(h)?h(S):h:"",{"is--title":f,"is--required":m,"is--hidden":!1===d||v&&u,"is--active":!a||a(S),"is--error":g}]},[(0,_vue.h)("div",{class:"vxe-form--item-inner"},[f||M?(0,_vue.h)("div",__assign({class:["vxe-form--item-title",y?"align--"+y:null,{"is--ellipsis":b}],style:l?{width:isNaN(l)?l:l+"px"}:null,title:i?(0,_utils.getFuncText)(f):null},o),(0,_render.renderTitle)(t,e)):null,(0,_vue.h)("div",{class:["vxe-form--item-content",N?"align--"+N:null]},w)])])}(i,r):(0,_vue.h)("div",{ref:F})}}});exports.default=_default;